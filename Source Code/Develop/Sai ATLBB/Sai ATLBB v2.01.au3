GLOBAL Const $WS_TILED = 0
Global Const $WS_OVERLAPPED = 0
Global Const $WS_MAXIMIZEBOX = 65536
Global Const $WS_MINIMIZEBOX = 131072
Global Const $WS_TABSTOP = 65536
Global Const $WS_GROUP = 131072
Global Const $WS_SIZEBOX = 262144
Global Const $WS_THICKFRAME = 262144
Global Const $WS_SYSMENU = 524288
Global Const $WS_HSCROLL = 1048576
Global Const $WS_VSCROLL = 2097152
Global Const $WS_DLGFRAME = 4194304
Global Const $WS_BORDER = 8388608
Global Const $WS_CAPTION = 12582912
Global Const $WS_OVERLAPPEDWINDOW = 13565952
Global Const $WS_TILEDWINDOW = 13565952
Global Const $WS_MAXIMIZE = 16777216
Global Const $WS_CLIPCHILDREN = 33554432
Global Const $WS_CLIPSIBLINGS = 67108864
Global Const $WS_DISABLED = 134217728
Global Const $WS_VISIBLE = 268435456
Global Const $WS_MINIMIZE = 536870912
Global Const $WS_CHILD = 1073741824
Global Const $WS_POPUP = -2147483648
Global Const $WS_POPUPWINDOW = -2138570752
Global Const $DS_MODALFRAME = 128
Global Const $DS_SETFOREGROUND = 512
Global Const $DS_CONTEXTHELP = 8192
Global Const $WS_EX_ACCEPTFILES = 16
Global Const $WS_EX_MDICHILD = 64
Global Const $WS_EX_APPWINDOW = 262144
Global Const $WS_EX_CLIENTEDGE = 512
Global Const $WS_EX_CONTEXTHELP = 1024
Global Const $WS_EX_DLGMODALFRAME = 1
Global Const $WS_EX_LEFTSCROLLBAR = 16384
Global Const $WS_EX_OVERLAPPEDWINDOW = 768
Global Const $WS_EX_RIGHT = 4096
Global Const $WS_EX_STATICEDGE = 131072
Global Const $WS_EX_TOOLWINDOW = 128
Global Const $WS_EX_TOPMOST = 8
Global Const $WS_EX_TRANSPARENT = 32
Global Const $WS_EX_WINDOWEDGE = 256
Global Const $WS_EX_LAYERED = 524288
Global Const $WS_EX_CONTROLPARENT = 65536
Global Const $WS_EX_LAYOUTRTL = 4194304
Global Const $WS_EX_RTLREADING = 8192
Global Const $WM_GETTEXTLENGTH = 14
Global Const $WM_GETTEXT = 13
Global Const $WM_SIZE = 5
Global Const $WM_SIZING = 532
Global Const $WM_USER = 1024
Global Const $WM_CREATE = 1
Global Const $WM_DESTROY = 2
Global Const $WM_MOVE = 3
Global Const $WM_ACTIVATE = 6
Global Const $WM_SETFOCUS = 7
Global Const $WM_KILLFOCUS = 8
Global Const $WM_ENABLE = 10
Global Const $WM_SETREDRAW = 11
Global Const $WM_SETTEXT = 12
Global Const $WM_PAINT = 15
Global Const $WM_CLOSE = 16
Global Const $WM_QUIT = 18
Global Const $WM_ERASEBKGND = 20
Global Const $WM_SYSCOLORCHANGE = 21
Global Const $WM_SHOWWINDOW = 24
Global Const $WM_WININICHANGE = 26
Global Const $WM_DEVMODECHANGE = 27
Global Const $WM_ACTIVATEAPP = 28
Global Const $WM_FONTCHANGE = 29
Global Const $WM_TIMECHANGE = 30
Global Const $WM_CANCELMODE = 31
Global Const $WM_SETCURSOR = 32
Global Const $WM_MOUSEACTIVATE = 33
Global Const $WM_CHILDACTIVATE = 34
Global Const $WM_QUEUESYNC = 35
Global Const $WM_GETMINMAXINFO = 36
Global Const $WM_PAINTICON = 38
Global Const $WM_ICONERASEBKGND = 39
Global Const $WM_NEXTDLGCTL = 40
Global Const $WM_SPOOLERSTATUS = 42
Global Const $WM_DRAWITEM = 43
Global Const $WM_MEASUREITEM = 44
Global Const $WM_DELETEITEM = 45
Global Const $WM_VKEYTOITEM = 46
Global Const $WM_CHARTOITEM = 47
Global Const $WM_SETFONT = 48
Global Const $WM_GETFONT = 49
Global Const $WM_SETHOTKEY = 50
Global Const $WM_GETHOTKEY = 51
Global Const $WM_QUERYDRAGICON = 55
Global Const $WM_COMPAREITEM = 57
Global Const $WM_GETOBJECT = 61
Global Const $WM_COMPACTING = 65
Global Const $WM_COMMNOTIFY = 68
Global Const $WM_WINDOWPOSCHANGING = 70
Global Const $WM_WINDOWPOSCHANGED = 71
Global Const $WM_POWER = 72
Global Const $WM_NOTIFY = 78
Global Const $WM_COPYDATA = 74
Global Const $WM_CANCELJOURNAL = 75
Global Const $WM_INPUTLANGCHANGEREQUEST = 80
Global Const $WM_INPUTLANGCHANGE = 81
Global Const $WM_TCARD = 82
Global Const $WM_HELP = 83
Global Const $WM_USERCHANGED = 84
Global Const $WM_NOTIFYFORMAT = 85
Global Const $WM_CUT = 768
Global Const $WM_COPY = 769
Global Const $WM_PASTE = 770
Global Const $WM_CLEAR = 771
Global Const $WM_UNDO = 772
Global Const $WM_CONTEXTMENU = 123
Global Const $WM_STYLECHANGING = 124
Global Const $WM_STYLECHANGED = 125
Global Const $WM_DISPLAYCHANGE = 126
Global Const $WM_GETICON = 127
Global Const $WM_SETICON = 128
Global Const $WM_NCCREATE = 129
Global Const $WM_NCDESTROY = 130
Global Const $WM_NCCALCSIZE = 131
Global Const $WM_NCHITTEST = 132
Global Const $WM_NCPAINT = 133
Global Const $WM_NCACTIVATE = 134
Global Const $WM_GETDLGCODE = 135
Global Const $WM_SYNCPAINT = 136
Global Const $WM_NCMOUSEMOVE = 160
Global Const $WM_NCLBUTTONDOWN = 161
Global Const $WM_NCLBUTTONUP = 162
Global Const $WM_NCLBUTTONDBLCLK = 163
Global Const $WM_NCRBUTTONDOWN = 164
Global Const $WM_NCRBUTTONUP = 165
Global Const $WM_NCRBUTTONDBLCLK = 166
Global Const $WM_NCMBUTTONDOWN = 167
Global Const $WM_NCMBUTTONUP = 168
Global Const $WM_NCMBUTTONDBLCLK = 169
Global Const $WM_KEYDOWN = 256
Global Const $WM_KEYUP = 257
Global Const $WM_CHAR = 258
Global Const $WM_DEADCHAR = 259
Global Const $WM_SYSKEYDOWN = 260
Global Const $WM_SYSKEYUP = 261
Global Const $WM_SYSCHAR = 262
Global Const $WM_SYSDEADCHAR = 263
Global Const $WM_INITDIALOG = 272
Global Const $WM_COMMAND = 273
Global Const $WM_SYSCOMMAND = 274
Global Const $WM_TIMER = 275
Global Const $WM_HSCROLL = 276
Global Const $WM_VSCROLL = 277
Global Const $WM_INITMENU = 278
Global Const $WM_INITMENUPOPUP = 279
Global Const $WM_MENUSELECT = 287
Global Const $WM_MENUCHAR = 288
Global Const $WM_ENTERIDLE = 289
Global Const $WM_MENURBUTTONUP = 290
Global Const $WM_MENUDRAG = 291
Global Const $WM_MENUGETOBJECT = 292
Global Const $WM_UNINITMENUPOPUP = 293
Global Const $WM_MENUCOMMAND = 294
Global Const $WM_CHANGEUISTATE = 295
Global Const $WM_UPDATEUISTATE = 296
Global Const $WM_QUERYUISTATE = 297
Global Const $WM_CTLCOLORMSGBOX = 306
Global Const $WM_CTLCOLOREDIT = 307
Global Const $WM_CTLCOLORLISTBOX = 308
Global Const $WM_CTLCOLORBTN = 309
Global Const $WM_CTLCOLORDLG = 310
Global Const $WM_CTLCOLORSCROLLBAR = 311
Global Const $WM_CTLCOLORSTATIC = 312
Global Const $WM_CTLCOLOR = 25
Global Const $MN_GETHMENU = 481
Global Const $NM_FIRST = 0
Global Const $NM_OUTOFMEMORY = $NM_FIRST - 1
Global Const $NM_CLICK = $NM_FIRST - 2
Global Const $NM_DBLCLK = $NM_FIRST - 3
Global Const $NM_RETURN = $NM_FIRST - 4
Global Const $NM_RCLICK = $NM_FIRST - 5
Global Const $NM_RDBLCLK = $NM_FIRST - 6
Global Const $NM_SETFOCUS = $NM_FIRST - 7
Global Const $NM_KILLFOCUS = $NM_FIRST - 8
Global Const $NM_CUSTOMDRAW = $NM_FIRST - 12
Global Const $NM_HOVER = $NM_FIRST - 13
Global Const $NM_NCHITTEST = $NM_FIRST - 14
Global Const $NM_KEYDOWN = $NM_FIRST - 15
Global Const $NM_RELEASEDCAPTURE = $NM_FIRST - 16
Global Const $NM_SETCURSOR = $NM_FIRST - 17
Global Const $NM_CHAR = $NM_FIRST - 18
Global Const $NM_TOOLTIPSCREATED = $NM_FIRST - 19
Global Const $NM_LDOWN = $NM_FIRST - 20
Global Const $NM_RDOWN = $NM_FIRST - 21
Global Const $NM_THEMECHANGED = $NM_FIRST - 22
Global Const $WM_LBUTTONUP = 514
Global Const $WM_MOUSEMOVE = 512
Global Const $PS_SOLID = 0
Global Const $PS_DASH = 1
Global Const $PS_DOT = 2
Global Const $PS_DASHDOT = 3
Global Const $PS_DASHDOTDOT = 4
Global Const $PS_NULL = 5
Global Const $PS_INSIDEFRAME = 6
Global Const $RGN_AND = 1
Global Const $RGN_OR = 2
Global Const $RGN_XOR = 3
Global Const $RGN_DIFF = 4
Global Const $RGN_COPY = 5
Global Const $ERROR = 0
Global Const $NULLREGION = 1
Global Const $SIMPLEREGION = 2
Global Const $COMPLEXREGION = 3
Global Const $TRANSPARENT = 1
Global Const $OPAQUE = 2
Global Const $CCM_FIRST = 8192
Global Const $CCM_GETUNICODEFORMAT = ($CCM_FIRST + 6)
Global Const $CCM_SETUNICODEFORMAT = ($CCM_FIRST + 5)
Global Const $CCM_SETBKCOLOR = $CCM_FIRST + 1
Global Const $CCM_SETCOLORSCHEME = $CCM_FIRST + 2
Global Const $CCM_GETCOLORSCHEME = $CCM_FIRST + 3
Global Const $CCM_GETDROPTARGET = $CCM_FIRST + 4
Global Const $CCM_SETWINDOWTHEME = $CCM_FIRST + 11
Global Const $GA_PARENT = 1
Global Const $GA_ROOT = 2
Global Const $GA_ROOTOWNER = 3
Global Const $SM_CXSCREEN = 0
Global Const $SM_CYSCREEN = 1
Global Const $SM_CXVSCROLL = 2
Global Const $SM_CYHSCROLL = 3
Global Const $SM_CYCAPTION = 4
Global Const $SM_CXBORDER = 5
Global Const $SM_CYBORDER = 6
Global Const $SM_CXDLGFRAME = 7
Global Const $SM_CYDLGFRAME = 8
Global Const $SM_CYVTHUMB = 9
Global Const $SM_CXHTHUMB = 10
Global Const $SM_CXICON = 11
Global Const $SM_CYICON = 12
Global Const $SM_CXCURSOR = 13
Global Const $SM_CYCURSOR = 14
Global Const $SM_CYMENU = 15
Global Const $SM_CXFULLSCREEN = 16
Global Const $SM_CYFULLSCREEN = 17
Global Const $SM_CYKANJIWINDOW = 18
Global Const $SM_MOUSEPRESENT = 19
Global Const $SM_CYVSCROLL = 20
Global Const $SM_CXHSCROLL = 21
Global Const $SM_DEBUG = 22
Global Const $SM_SWAPBUTTON = 23
Global Const $SM_RESERVED1 = 24
Global Const $SM_RESERVED2 = 25
Global Const $SM_RESERVED3 = 26
Global Const $SM_RESERVED4 = 27
Global Const $SM_CXMIN = 28
Global Const $SM_CYMIN = 29
Global Const $SM_CXSIZE = 30
Global Const $SM_CYSIZE = 31
Global Const $SM_CXFRAME = 32
Global Const $SM_CYFRAME = 33
Global Const $SM_CXMINTRACK = 34
Global Const $SM_CYMINTRACK = 35
Global Const $SM_CXDOUBLECLK = 36
Global Const $SM_CYDOUBLECLK = 37
Global Const $SM_CXICONSPACING = 38
Global Const $SM_CYICONSPACING = 39
Global Const $SM_MENUDROPALIGNMENT = 40
Global Const $SM_PENWINDOWS = 41
Global Const $SM_DBCSENABLED = 42
Global Const $SM_CMOUSEBUTTONS = 43
Global Const $SM_SECURE = 44
Global Const $SM_CXEDGE = 45
Global Const $SM_CYEDGE = 46
Global Const $SM_CXMINSPACING = 47
Global Const $SM_CYMINSPACING = 48
Global Const $SM_CXSMICON = 49
Global Const $SM_CYSMICON = 50
Global Const $SM_CYSMCAPTION = 51
Global Const $SM_CXSMSIZE = 52
Global Const $SM_CYSMSIZE = 53
Global Const $SM_CXMENUSIZE = 54
Global Const $SM_CYMENUSIZE = 55
Global Const $SM_ARRANGE = 56
Global Const $SM_CXMINIMIZED = 57
Global Const $SM_CYMINIMIZED = 58
Global Const $SM_CXMAXTRACK = 59
Global Const $SM_CYMAXTRACK = 60
Global Const $SM_CXMAXIMIZED = 61
Global Const $SM_CYMAXIMIZED = 62
Global Const $SM_NETWORK = 63
Global Const $SM_CLEANBOOT = 67
Global Const $SM_CXDRAG = 68
Global Const $SM_CYDRAG = 69
Global Const $SM_SHOWSOUNDS = 70
Global Const $SM_CXMENUCHECK = 71
Global Const $SM_CYMENUCHECK = 72
Global Const $SM_SLOWMACHINE = 73
Global Const $SM_MIDEASTENABLED = 74
Global Const $SM_MOUSEWHEELPRESENT = 75
Global Const $SM_XVIRTUALSCREEN = 76
Global Const $SM_YVIRTUALSCREEN = 77
Global Const $SM_CXVIRTUALSCREEN = 78
Global Const $SM_CYVIRTUALSCREEN = 79
Global Const $SM_CMONITORS = 80
Global Const $SM_SAMEDISPLAYFORMAT = 81
Global Const $SM_IMMENABLED = 82
Global Const $SM_CXFOCUSBORDER = 83
Global Const $SM_CYFOCUSBORDER = 84
Global Const $SM_TABLETPC = 86
Global Const $SM_MEDIACENTER = 87
Global Const $SM_STARTER = 88
Global Const $SM_SERVERR2 = 89
Global Const $SM_CMETRICS = 90
Global Const $SM_REMOTESESSION = 4096
Global Const $SM_SHUTTINGDOWN = 8192
Global Const $SM_REMOTECONTROL = 8193
Global Const $SM_CARETBLINKINGENABLED = 8194
Global Const $BLACKNESS = 66
Global Const $CAPTUREBLT = 1073741824
Global Const $DSTINVERT = 5570569
Global Const $MERGECOPY = 12583114
Global Const $MERGEPAINT = 12255782
Global Const $NOMIRRORBITMAP = -2147483648
Global Const $NOTSRCCOPY = 3342344
Global Const $NOTSRCERASE = 1114278
Global Const $PATCOPY = 15728673
Global Const $PATINVERT = 5898313
Global Const $PATPAINT = 16452105
Global Const $SRCAND = 8913094
Global Const $SRCCOPY = 13369376
Global Const $SRCERASE = 4457256
Global Const $SRCINVERT = 6684742
Global Const $SRCPAINT = 15597702
Global Const $WHITENESS = 16711778
Global Const $DT_BOTTOM = 8
Global Const $DT_CALCRECT = 1024
Global Const $DT_CENTER = 1
Global Const $DT_EDITCONTROL = 8192
Global Const $DT_END_ELLIPSIS = 32768
Global Const $DT_EXPANDTABS = 64
Global Const $DT_EXTERNALLEADING = 512
Global Const $DT_HIDEPREFIX = 1048576
Global Const $DT_INTERNAL = 4096
Global Const $DT_LEFT = 0
Global Const $DT_MODIFYSTRING = 65536
Global Const $DT_NOCLIP = 256
Global Const $DT_NOFULLWIDTHCHARBREAK = 524288
Global Const $DT_NOPREFIX = 2048
Global Const $DT_PATH_ELLIPSIS = 16384
Global Const $DT_PREFIXONLY = 2097152
Global Const $DT_RIGHT = 2
Global Const $DT_RTLREADING = 131072
Global Const $DT_SINGLELINE = 32
Global Const $DT_TABSTOP = 128
Global Const $DT_TOP = 0
Global Const $DT_VCENTER = 4
Global Const $DT_WORDBREAK = 16
Global Const $DT_WORD_ELLIPSIS = 262144
Global Const $RDW_ERASE = 4
Global Const $RDW_FRAME = 1024
Global Const $RDW_INTERNALPAINT = 2
Global Const $RDW_INVALIDATE = 1
Global Const $RDW_NOERASE = 32
Global Const $RDW_NOFRAME = 2048
Global Const $RDW_NOINTERNALPAINT = 16
Global Const $RDW_VALIDATE = 8
Global Const $RDW_ERASENOW = 512
Global Const $RDW_UPDATENOW = 256
Global Const $RDW_ALLCHILDREN = 128
Global Const $RDW_NOCHILDREN = 64
Global Const $WM_RENDERFORMAT = 773
Global Const $WM_RENDERALLFORMATS = 774
Global Const $WM_DESTROYCLIPBOARD = 775
Global Const $WM_DRAWCLIPBOARD = 776
Global Const $WM_PAINTCLIPBOARD = 777
Global Const $WM_VSCROLLCLIPBOARD = 778
Global Const $WM_SIZECLIPBOARD = 779
Global Const $WM_ASKCBFORMATNAME = 780
Global Const $WM_CHANGECBCHAIN = 781
Global Const $WM_HSCROLLCLIPBOARD = 782
Global Const $HTERROR = -2
Global Const $HTTRANSPARENT = -1
Global Const $HTNOWHERE = 0
Global Const $HTCLIENT = 1
Global Const $HTCAPTION = 2
Global Const $HTSYSMENU = 3
Global Const $HTGROWBOX = 4
Global Const $HTSIZE = $HTGROWBOX
Global Const $HTMENU = 5
Global Const $HTHSCROLL = 6
Global Const $HTVSCROLL = 7
Global Const $HTMINBUTTON = 8
Global Const $HTMAXBUTTON = 9
Global Const $HTLEFT = 10
Global Const $HTRIGHT = 11
Global Const $HTTOP = 12
Global Const $HTTOPLEFT = 13
Global Const $HTTOPRIGHT = 14
Global Const $HTBOTTOM = 15
Global Const $HTBOTTOMLEFT = 16
Global Const $HTBOTTOMRIGHT = 17
Global Const $HTBORDER = 18
Global Const $HTREDUCE = $HTMINBUTTON
Global Const $HTZOOM = $HTMAXBUTTON
Global Const $HTSIZEFIRST = $HTLEFT
Global Const $HTSIZELAST = $HTBOTTOMRIGHT
Global Const $HTOBJECT = 19
Global Const $HTCLOSE = 20
Global Const $HTHELP = 21
Global Const $COLOR_SCROLLBAR = 0
Global Const $COLOR_BACKGROUND = 1
Global Const $COLOR_ACTIVECAPTION = 2
Global Const $COLOR_INACTIVECAPTION = 3
Global Const $COLOR_MENU = 4
Global Const $COLOR_WINDOW = 5
Global Const $COLOR_WINDOWFRAME = 6
Global Const $COLOR_MENUTEXT = 7
Global Const $COLOR_WINDOWTEXT = 8
Global Const $COLOR_CAPTIONTEXT = 9
Global Const $COLOR_ACTIVEBORDER = 10
Global Const $COLOR_INACTIVEBORDER = 11
Global Const $COLOR_APPWORKSPACE = 12
Global Const $COLOR_HIGHLIGHT = 13
Global Const $COLOR_HIGHLIGHTTEXT = 14
Global Const $COLOR_BTNFACE = 15
Global Const $COLOR_BTNSHADOW = 16
Global Const $COLOR_GRAYTEXT = 17
Global Const $COLOR_BTNTEXT = 18
Global Const $COLOR_INACTIVECAPTIONTEXT = 19
Global Const $COLOR_BTNHIGHLIGHT = 20
Global Const $COLOR_3DDKSHADOW = 21
Global Const $COLOR_3DLIGHT = 22
Global Const $COLOR_INFOTEXT = 23
Global Const $COLOR_INFOBK = 24
Global Const $COLOR_HOTLIGHT = 26
Global Const $COLOR_GRADIENTACTIVECAPTION = 27
Global Const $COLOR_GRADIENTINACTIVECAPTION = 28
Global Const $COLOR_MENUHILIGHT = 29
Global Const $COLOR_MENUBAR = 30
Global Const $COLOR_DESKTOP = 1
Global Const $COLOR_3DFACE = 15
Global Const $COLOR_3DSHADOW = 16
Global Const $COLOR_3DHIGHLIGHT = 20
Global Const $COLOR_3DHILIGHT = 20
Global Const $COLOR_BTNHILIGHT = 20
Global Const $HINST_COMMCTRL = -1
Global Const $IDB_STD_SMALL_COLOR = 0
Global Const $IDB_STD_LARGE_COLOR = 1
Global Const $IDB_VIEW_SMALL_COLOR = 4
Global Const $IDB_VIEW_LARGE_COLOR = 5
Global Const $IDB_HIST_SMALL_COLOR = 8
Global Const $IDB_HIST_LARGE_COLOR = 9
Global Const $STARTF_FORCEOFFFEEDBACK = 128
Global Const $STARTF_FORCEONFEEDBACK = 64
Global Const $STARTF_RUNFULLSCREEN = 32
Global Const $STARTF_USECOUNTCHARS = 8
Global Const $STARTF_USEFILLATTRIBUTE = 16
Global Const $STARTF_USEHOTKEY = 512
Global Const $STARTF_USEPOSITION = 4
Global Const $STARTF_USESHOWWINDOW = 1
Global Const $STARTF_USESIZE = 2
Global Const $STARTF_USESTDHANDLES = 256
Global Const $CDDS_PREPAINT = 1
Global Const $CDDS_POSTPAINT = 2
Global Const $CDDS_PREERASE = 3
Global Const $CDDS_POSTERASE = 4
Global Const $CDDS_ITEM = 65536
Global Const $CDDS_ITEMPREPAINT = 65537
Global Const $CDDS_ITEMPOSTPAINT = 65538
Global Const $CDDS_ITEMPREERASE = 65539
Global Const $CDDS_ITEMPOSTERASE = 65540
Global Const $CDDS_SUBITEM = 131072
Global Const $CDIS_SELECTED = 1
Global Const $CDIS_GRAYED = 2
Global Const $CDIS_DISABLED = 4
Global Const $CDIS_CHECKED = 8
Global Const $CDIS_FOCUS = 16
Global Const $CDIS_DEFAULT = 32
Global Const $CDIS_HOT = 64
Global Const $CDIS_MARKED = 128
Global Const $CDIS_INDETERMINATE = 256
Global Const $CDIS_SHOWKEYBOARDCUES = 512
Global Const $CDIS_NEARHOT = 1024
Global Const $CDIS_OTHERSIDEHOT = 2048
Global Const $CDIS_DROPHILITED = 4096
Global Const $CDRF_DODEFAULT = 0
Global Const $CDRF_NEWFONT = 2
Global Const $CDRF_SKIPDEFAULT = 4
Global Const $CDRF_NOTIFYPOSTPAINT = 16
Global Const $CDRF_NOTIFYITEMDRAW = 32
Global Const $CDRF_NOTIFYSUBITEMDRAW = 32
Global Const $CDRF_NOTIFYPOSTERASE = 64
Global Const $CDRF_DOERASE = 8
Global Const $CDRF_SKIPPOSTPAINT = 256
Global Const $GUI_SS_DEFAULT_GUI = BitOR($WS_MINIMIZEBOX, $WS_CAPTION, $WS_POPUP, $WS_SYSMENU)
Global Const $GUI_EVENT_CLOSE = -3
Global Const $GUI_EVENT_MINIMIZE = -4
Global Const $GUI_EVENT_RESTORE = -5
Global Const $GUI_EVENT_MAXIMIZE = -6
Global Const $GUI_EVENT_PRIMARYDOWN = -7
Global Const $GUI_EVENT_PRIMARYUP = -8
Global Const $GUI_EVENT_SECONDARYDOWN = -9
Global Const $GUI_EVENT_SECONDARYUP = -10
Global Const $GUI_EVENT_MOUSEMOVE = -11
Global Const $GUI_EVENT_RESIZED = -12
Global Const $GUI_EVENT_DROPPED = -13
Global Const $GUI_RUNDEFMSG = "GUI_RUNDEFMSG"
Global Const $GUI_AVISTOP = 0
Global Const $GUI_AVISTART = 1
Global Const $GUI_AVICLOSE = 2
Global Const $GUI_CHECKED = 1
Global Const $GUI_INDETERMINATE = 2
Global Const $GUI_UNCHECKED = 4
Global Const $GUI_DROPACCEPTED = 8
Global Const $GUI_NODROPACCEPTED = 4096
Global Const $GUI_ACCEPTFILES = $GUI_DROPACCEPTED
Global Const $GUI_SHOW = 16
Global Const $GUI_HIDE = 32
Global Const $GUI_ENABLE = 64
Global Const $GUI_DISABLE = 128
Global Const $GUI_FOCUS = 256
Global Const $GUI_NOFOCUS = 8192
Global Const $GUI_DEFBUTTON = 512
Global Const $GUI_EXPAND = 1024
Global Const $GUI_ONTOP = 2048
Global Const $GUI_FONTITALIC = 2
Global Const $GUI_FONTUNDER = 4
Global Const $GUI_FONTSTRIKE = 8
Global Const $GUI_DOCKAUTO = 1
Global Const $GUI_DOCKLEFT = 2
Global Const $GUI_DOCKRIGHT = 4
Global Const $GUI_DOCKHCENTER = 8
Global Const $GUI_DOCKTOP = 32
Global Const $GUI_DOCKBOTTOM = 64
Global Const $GUI_DOCKVCENTER = 128
Global Const $GUI_DOCKWIDTH = 256
Global Const $GUI_DOCKHEIGHT = 512
Global Const $GUI_DOCKSIZE = 768
Global Const $GUI_DOCKMENUBAR = 544
Global Const $GUI_DOCKSTATEBAR = 576
Global Const $GUI_DOCKALL = 802
Global Const $GUI_DOCKBORDERS = 102
Global Const $GUI_GR_CLOSE = 1
Global Const $GUI_GR_LINE = 2
Global Const $GUI_GR_BEZIER = 4
Global Const $GUI_GR_MOVE = 6
Global Const $GUI_GR_COLOR = 8
Global Const $GUI_GR_RECT = 10
Global Const $GUI_GR_ELLIPSE = 12
Global Const $GUI_GR_PIE = 14
Global Const $GUI_GR_DOT = 16
Global Const $GUI_GR_PIXEL = 18
Global Const $GUI_GR_HINT = 20
Global Const $GUI_GR_REFRESH = 22
Global Const $GUI_GR_PENSIZE = 24
Global Const $GUI_GR_NOBKCOLOR = -2
Global Const $GUI_BKCOLOR_DEFAULT = -1
Global Const $GUI_BKCOLOR_TRANSPARENT = -2
Global Const $GUI_BKCOLOR_LV_ALTERNATE = -33554432
Global Const $GUI_WS_EX_PARENTDRAG = 1048576
Global Const $SS_LEFT = 0
Global Const $SS_CENTER = 1
Global Const $SS_RIGHT = 2
Global Const $SS_ICON = 3
Global Const $SS_BLACKRECT = 4
Global Const $SS_GRAYRECT = 5
Global Const $SS_WHITERECT = 6
Global Const $SS_BLACKFRAME = 7
Global Const $SS_GRAYFRAME = 8
Global Const $SS_WHITEFRAME = 9
Global Const $SS_SIMPLE = 11
Global Const $SS_LEFTNOWORDWRAP = 12
Global Const $SS_BITMAP = 15
Global Const $SS_ETCHEDHORZ = 16
Global Const $SS_ETCHEDVERT = 17
Global Const $SS_ETCHEDFRAME = 18
Global Const $SS_NOPREFIX = 128
Global Const $SS_NOTIFY = 256
Global Const $SS_CENTERIMAGE = 512
Global Const $SS_RIGHTJUST = 1024
Global Const $SS_SUNKEN = 4096
Global Const $GUI_SS_DEFAULT_LABEL = 0
Global Const $GUI_SS_DEFAULT_GRAPHIC = 0
Global Const $GUI_SS_DEFAULT_ICON = $SS_NOTIFY
Global Const $GUI_SS_DEFAULT_PIC = $SS_NOTIFY
Global Const $TCS_BOTTOM = 2
Global Const $TCS_BUTTONS = 256
Global Const $TCS_FIXEDWIDTH = 1024
Global Const $TCS_FLATBUTTONS = 8
Global Const $TCS_FOCUSNEVER = 32768
Global Const $TCS_FOCUSONBUTTONDOWN = 4096
Global Const $TCS_FORCEICONLEFT = 16
Global Const $TCS_FORCELABELLEFT = 32
Global Const $TCS_HOTTRACK = 64
Global Const $TCS_MULTILINE = 512
Global Const $TCS_MULTISELECT = 4
Global Const $TCS_OWNERDRAWFIXED = 8192
Global Const $TCS_RAGGEDRIGHT = 2048
Global Const $TCS_RIGHT = 2
Global Const $TCS_RIGHTJUSTIFY = 0
Global Const $TCS_SCROLLOPPOSITE = 1
Global Const $TCS_SINGLELINE = 0
Global Const $TCS_TABS = 0
Global Const $TCS_TOOLTIPS = 16384
Global Const $TCS_VERTICAL = 128
Global Const $TCS_EX_FLATSEPARATORS = 1
Global Const $TCS_EX_REGISTERDROP = 2
Global Const $TC_ERR = -1
Global Const $TCHT_NOWHERE = 1
Global Const $TCHT_ONITEMICON = 2
Global Const $TCHT_ONITEMLABEL = 4
Global Const $TCHT_ONITEM = 6
Global Const $TCIF_TEXT = 1
Global Const $TCIF_IMAGE = 2
Global Const $TCIF_RTLREADING = 4
Global Const $TCIF_PARAM = 8
Global Const $TCIF_STATE = 16
Global Const $TCIF_ALLDATA = 27
Global Const $TCIS_BUTTONPRESSED = 1
Global Const $TCIS_HIGHLIGHTED = 2
Global Const $TCM_FIRST = 4864
Global Const $TCCM_FIRST = 8192
Global Const $TCM_ADJUSTRECT = ($TCM_FIRST + 40)
Global Const $TCM_DELETEALLITEMS = ($TCM_FIRST + 9)
Global Const $TCM_DELETEITEM = ($TCM_FIRST + 8)
Global Const $TCM_DESELECTALL = ($TCM_FIRST + 50)
Global Const $TCM_GETCURFOCUS = ($TCM_FIRST + 47)
Global Const $TCM_GETCURSEL = ($TCM_FIRST + 11)
Global Const $TCM_GETEXTENDEDSTYLE = ($TCM_FIRST + 53)
Global Const $TCM_GETIMAGELIST = ($TCM_FIRST + 2)
Global Const $TCM_GETITEMA = ($TCM_FIRST + 5)
Global Const $TCM_GETITEMW = ($TCM_FIRST + 60)
Global Const $TCM_GETITEM = $TCM_GETITEMA
Global Const $TCM_GETITEMCOUNT = ($TCM_FIRST + 4)
Global Const $TCM_GETITEMRECT = ($TCM_FIRST + 10)
Global Const $TCM_GETROWCOUNT = ($TCM_FIRST + 44)
Global Const $TCM_GETTOOLTIPS = ($TCM_FIRST + 45)
Global Const $TCCM_GETUNICODEFORMAT = ($TCCM_FIRST + 6)
Global Const $TCM_GETUNICODEFORMAT = $TCCM_GETUNICODEFORMAT
Global Const $TCM_HIGHLIGHTITEM = ($TCM_FIRST + 51)
Global Const $TCM_HITTEST = ($TCM_FIRST + 13)
Global Const $TCM_INSERTITEMA = ($TCM_FIRST + 7)
Global Const $TCM_INSERTITEMW = ($TCM_FIRST + 62)
Global Const $TCM_INSERTITEM = $TCM_INSERTITEMA
Global Const $TCM_REMOVEIMAGE = ($TCM_FIRST + 42)
Global Const $TCM_SETITEMA = ($TCM_FIRST + 6)
Global Const $TCM_SETITEMW = ($TCM_FIRST + 61)
Global Const $TCM_SETITEM = $TCM_SETITEMA
Global Const $TCM_SETITEMEXTRA = ($TCM_FIRST + 14)
Global Const $TCM_SETITEMSIZE = $TCM_FIRST + 41
Global Const $TCM_SETCURFOCUS = ($TCM_FIRST + 48)
Global Const $TCM_SETCURSEL = ($TCM_FIRST + 12)
Global Const $TCM_SETEXTENDEDSTYLE = ($TCM_FIRST + 52)
Global Const $TCM_SETIMAGELIST = $TCM_FIRST + 3
Global Const $TCM_SETMINTABWIDTH = ($TCM_FIRST + 49)
Global Const $TCM_SETPADDING = ($TCM_FIRST + 43)
Global Const $TCM_SETTOOLTIPS = ($TCM_FIRST + 46)
Global Const $TCCM_SETUNICODEFORMAT = ($TCCM_FIRST + 5)
Global Const $TCM_SETUNICODEFORMAT = $TCCM_SETUNICODEFORMAT
Global Const $TCN_FIRST = -550
Global Const $TCN_FOCUSCHANGE = ($TCN_FIRST - 4)
Global Const $TCN_GETOBJECT = ($TCN_FIRST - 3)
Global Const $TCN_KEYDOWN = ($TCN_FIRST - 0)
Global Const $TCN_SELCHANGE = ($TCN_FIRST - 1)
Global Const $TCN_SELCHANGING = ($TCN_FIRST - 2)
Global Const $GUI_SS_DEFAULT_TAB = 0
Global Const $CB_ERR = -1
Global Const $CB_ERRATTRIBUTE = -3
Global Const $CB_ERRREQUIRED = -4
Global Const $CB_ERRSPACE = -2
Global Const $CB_OKAY = 0
Global Const $STATE_SYSTEM_INVISIBLE = 32768
Global Const $STATE_SYSTEM_PRESSED = 8
Global Const $CB_DDL_ARCHIVE = 32
Global Const $CB_DDL_DIRECTORY = 16
Global Const $CB_DDL_DRIVES = 16384
Global Const $CB_DDL_EXCLUSIVE = 32768
Global Const $CB_DDL_HIDDEN = 2
Global Const $CB_DDL_READONLY = 1
Global Const $CB_DDL_READWRITE = 0
Global Const $CB_DDL_SYSTEM = 4
Global Const $CBS_AUTOHSCROLL = 64
Global Const $CBS_DISABLENOSCROLL = 2048
Global Const $CBS_DROPDOWN = 2
Global Const $CBS_DROPDOWNLIST = 3
Global Const $CBS_HASSTRINGS = 512
Global Const $CBS_LOWERCASE = 16384
Global Const $CBS_NOINTEGRALHEIGHT = 1024
Global Const $CBS_OEMCONVERT = 128
Global Const $CBS_OWNERDRAWFIXED = 16
Global Const $CBS_OWNERDRAWVARIABLE = 32
Global Const $CBS_SIMPLE = 1
Global Const $CBS_SORT = 256
Global Const $CBS_UPPERCASE = 8192
Global Const $CBM_FIRST = 5888
Global Const $CB_ADDSTRING = 323
Global Const $CB_DELETESTRING = 324
Global Const $CB_DIR = 325
Global Const $CB_FINDSTRING = 332
Global Const $CB_FINDSTRINGEXACT = 344
Global Const $CB_GETCOMBOBOXINFO = 356
Global Const $CB_GETCOUNT = 326
Global Const $CB_GETCUEBANNER = ($CBM_FIRST + 4)
Global Const $CB_GETCURSEL = 327
Global Const $CB_GETDROPPEDCONTROLRECT = 338
Global Const $CB_GETDROPPEDSTATE = 343
Global Const $CB_GETDROPPEDWIDTH = 351
Global Const $CB_GETEDITSEL = 320
Global Const $CB_GETEXTENDEDUI = 342
Global Const $CB_GETHORIZONTALEXTENT = 349
Global Const $CB_GETITEMDATA = 336
Global Const $CB_GETITEMHEIGHT = 340
Global Const $CB_GETLBTEXT = 328
Global Const $CB_GETLBTEXTLEN = 329
Global Const $CB_GETLOCALE = 346
Global Const $CB_GETMINVISIBLE = 5890
Global Const $CB_GETTOPINDEX = 347
Global Const $CB_INITSTORAGE = 353
Global Const $CB_LIMITTEXT = 321
Global Const $CB_RESETCONTENT = 331
Global Const $CB_INSERTSTRING = 330
Global Const $CB_SELECTSTRING = 333
Global Const $CB_SETCUEBANNER = ($CBM_FIRST + 3)
Global Const $CB_SETCURSEL = 334
Global Const $CB_SETDROPPEDWIDTH = 352
Global Const $CB_SETEDITSEL = 322
Global Const $CB_SETEXTENDEDUI = 341
Global Const $CB_SETHORIZONTALEXTENT = 350
Global Const $CB_SETITEMDATA = 337
Global Const $CB_SETITEMHEIGHT = 339
Global Const $CB_SETLOCALE = 21
Global Const $CB_SETMINVISIBLE = 5889
Global Const $CB_SETTOPINDEX = 348
Global Const $CB_SHOWDROPDOWN = 335
Global Const $CBN_CLOSEUP = 8
Global Const $CBN_DBLCLK = 2
Global Const $CBN_DROPDOWN = 7
Global Const $CBN_EDITCHANGE = 5
Global Const $CBN_EDITUPDATE = 6
Global Const $CBN_ERRSPACE = (-1)
Global Const $CBN_KILLFOCUS = 4
Global Const $CBN_SELCHANGE = 1
Global Const $CBN_SELENDCANCEL = 10
Global Const $CBN_SELENDOK = 9
Global Const $CBN_SETFOCUS = 3
Global Const $CBES_EX_CASESENSITIVE = 16
Global Const $CBES_EX_NOEDITIMAGE = 1
Global Const $CBES_EX_NOEDITIMAGEINDENT = 2
Global Const $CBES_EX_NOSIZELIMIT = 8
Global Const $CBES_EX_PATHWORDBREAKPROC = 4
Global Const $__COMBOBOXCONSTANT_WM_USER = 1024
Global Const $CBEM_DELETEITEM = $CB_DELETESTRING
Global Const $CBEM_GETCOMBOCONTROL = ($__COMBOBOXCONSTANT_WM_USER + 6)
Global Const $CBEM_GETEDITCONTROL = ($__COMBOBOXCONSTANT_WM_USER + 7)
Global Const $CBEM_GETEXSTYLE = ($__COMBOBOXCONSTANT_WM_USER + 9)
Global Const $CBEM_GETEXTENDEDSTYLE = ($__COMBOBOXCONSTANT_WM_USER + 9)
Global Const $CBEM_GETIMAGELIST = ($__COMBOBOXCONSTANT_WM_USER + 3)
Global Const $CBEM_GETITEMA = ($__COMBOBOXCONSTANT_WM_USER + 4)
Global Const $CBEM_GETITEMW = ($__COMBOBOXCONSTANT_WM_USER + 13)
Global Const $CBEM_GETUNICODEFORMAT = 8192 + 6
Global Const $CBEM_HASEDITCHANGED = ($__COMBOBOXCONSTANT_WM_USER + 10)
Global Const $CBEM_INSERTITEMA = ($__COMBOBOXCONSTANT_WM_USER + 1)
Global Const $CBEM_INSERTITEMW = ($__COMBOBOXCONSTANT_WM_USER + 11)
Global Const $CBEM_SETEXSTYLE = ($__COMBOBOXCONSTANT_WM_USER + 8)
Global Const $CBEM_SETEXTENDEDSTYLE = ($__COMBOBOXCONSTANT_WM_USER + 14)
Global Const $CBEM_SETIMAGELIST = ($__COMBOBOXCONSTANT_WM_USER + 2)
Global Const $CBEM_SETITEMA = ($__COMBOBOXCONSTANT_WM_USER + 5)
Global Const $CBEM_SETITEMW = ($__COMBOBOXCONSTANT_WM_USER + 12)
Global Const $CBEM_SETUNICODEFORMAT = 8192 + 5
Global Const $CBEM_SETWINDOWTHEME = 8192 + 11
Global Const $CBEN_FIRST = (-800)
Global Const $CBEN_LAST = (-830)
Global Const $CBEN_BEGINEDIT = ($CBEN_FIRST - 4)
Global Const $CBEN_DELETEITEM = ($CBEN_FIRST - 2)
Global Const $CBEN_DRAGBEGINA = ($CBEN_FIRST - 8)
Global Const $CBEN_DRAGBEGINW = ($CBEN_FIRST - 9)
Global Const $CBEN_ENDEDITA = ($CBEN_FIRST - 5)
Global Const $CBEN_ENDEDITW = ($CBEN_FIRST - 6)
Global Const $CBEN_GETDISPINFO = ($CBEN_FIRST - 0)
Global Const $CBEN_GETDISPINFOA = ($CBEN_FIRST - 0)
Global Const $CBEN_GETDISPINFOW = ($CBEN_FIRST - 7)
Global Const $CBEN_INSERTITEM = ($CBEN_FIRST - 1)
Global Const $CBEIF_DI_SETITEM = 268435456
Global Const $CBEIF_IMAGE = 2
Global Const $CBEIF_INDENT = 16
Global Const $CBEIF_LPARAM = 32
Global Const $CBEIF_OVERLAY = 8
Global Const $CBEIF_SELECTEDIMAGE = 4
Global Const $CBEIF_TEXT = 1
Global Const $__COMBOBOXCONSTANT_WS_VSCROLL = 2097152
Global Const $GUI_SS_DEFAULT_COMBO = BitOR($CBS_DROPDOWN, $CBS_AUTOHSCROLL, $__COMBOBOXCONSTANT_WS_VSCROLL)
#region Header
#endregion Header
#region Global Variables and Constants
Global Const $IEAU3VERSIONINFO[6] = ["V", 2, 4, 0, "20071231", "V2.4-0"]
Global Const $LSFW_LOCK = 1, $LSFW_UNLOCK = 2
Global $__IELOADWAITTIMEOUT = 300000
Global $__IEAU3DEBUG = False
Global $__IEAU3V1COMPATIBILITY
Global $__IEAU3DEBUG_USEOLDDLLCALL = False
Global $_IEERRORNOTIFY = True
Global $OIEERRORHANDLER, $SIEUSERERRORHANDLER
Global $IECOMERRORNUMBER, $IECOMERRORNUMBERHEX, $IECOMERRORDESCRIPTION, $IECOMERRORSCRIPTLINE, $IECOMERRORWINDESCRIPTION, $IECOMERRORSOURCE, $IECOMERRORHELPFILE, $IECOMERRORHELPCONTEXT, $IECOMERRORLASTDLLERROR, $IECOMERRORCOMOBJ, $IECOMERROROUTPUT
Global Enum $_IESTATUS_SUCCESS = 0, $_IESTATUS_GENERALERROR, $_IESTATUS_COMERROR, $_IESTATUS_INVALIDDATATYPE, $_IESTATUS_INVALIDOBJECTTYPE, $_IESTATUS_INVALIDVALUE, $_IESTATUS_LOADWAITTIMEOUT, $_IESTATUS_NOMATCH, $_IESTATUS_ACCESSISDENIED, $_IESTATUS_CLIENTDISCONNECTED
Global Enum Step * 2 $_IENOTIFYLEVEL_NONE = 0, $_IENOTIFYNOTIFYLEVEL_WARNING = 1, $_IENOTIFYNOTIFYLEVEL_ERROR, $_IENOTIFYNOTIFYLEVEL_COMERROR
Global Enum Step * 2 $_IENOTIFYMETHOD_SILENT = 0, $_IENOTIFYMETHOD_CONSOLE = 1, $_IENOTIFYMETHOD_TOOLTIP, $_IENOTIFYMETHOD_MSGBOX
#endregion Global Variables and Constants
#region Core functions

Func _IECREATE($S_URL = "about:blank", $F_TRYATTACH = 0, $F_VISIBLE = 1, $F_WAIT = 1, $F_TAKEFOCUS = 1)
	Local $RESULT, $F_MUSTUNLOCK = 0
	If $__IEAU3V1COMPATIBILITY Then
		Switch String($S_URL)
			Case "0"
				$S_URL = "about:blank"
				$F_VISIBLE = 0
				__IEERRORNOTIFY("Warning", "_IECreate", "", "Using deprecated behavior - $f_visible is now parameter 3 instead of parameter 1")
			Case "1"
				$S_URL = "about:blank"
				$F_VISIBLE = 1
				__IEERRORNOTIFY("Warning", "_IECreate", "", "Using deprecated behavior - $f_visible is now parameter 3 instead of parameter 1")
		EndSwitch
	EndIf
	If Not $F_VISIBLE Then $F_TAKEFOCUS = 0
	If $F_TRYATTACH Then
		Local $ORESULT = _IEATTACH($S_URL, "url")
		If IsObj($ORESULT) Then
			If $F_TAKEFOCUS Then WinActivate(HWnd($ORESULT.HWND))
			SetError($_IESTATUS_SUCCESS)
			SetExtended(1)
			Return $ORESULT
		EndIf
	EndIf
	If Not $F_VISIBLE Then
		$RESULT = __IELOCKSETFOREGROUNDWINDOW($LSFW_LOCK)
		If $RESULT Then $F_MUSTUNLOCK = 1
	EndIf
	Local $O_OBJECT = ObjCreate("InternetExplorer.Application")
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IECreate", "", "Browser Object Creation Failed")
		SetError($_IESTATUS_GENERALERROR)
		Return 0
	EndIf
	$O_OBJECT.visible = $F_VISIBLE
	If $F_MUSTUNLOCK Then
		$RESULT = __IELOCKSETFOREGROUNDWINDOW($LSFW_UNLOCK)
		If Not $RESULT Then __IEERRORNOTIFY("Warning", "_IECreate", "", "Foreground Window Unlock Failed!")
	EndIf
	_IENAVIGATE($O_OBJECT, $S_URL, $F_WAIT)
	SetError(@error)
	Return $O_OBJECT
EndFunc


Func _IECREATEEMBEDDED()
	Local $O_OBJECT = ObjCreate("Shell.Explorer.2")
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IECreateEmbedded", "", "WebBrowser Object Creation Failed")
		SetError($_IESTATUS_GENERALERROR)
		Return 0
	EndIf
	SetError($_IESTATUS_SUCCESS)
	Return $O_OBJECT
EndFunc


Func _IENAVIGATE(ByRef $O_OBJECT, $S_URL, $F_WAIT = 1)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IENavigate", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "documentContainer") Then
		__IEERRORNOTIFY("Error", "_IENavigate", "$_IEStatus_InvalidObjectType")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	$O_OBJECT.navigate($S_URL)
	If $F_WAIT Then
		_IELOADWAIT($O_OBJECT)
		SetError(@error)
		Return -1
	EndIf
	SetError($_IESTATUS_SUCCESS)
	Return -1
EndFunc


Func _IEATTACH($S_STRING, $S_MODE = "Title", $I_INSTANCE = 1)
	$S_MODE = StringLower($S_MODE)
	Local $H_CONTROL, $ORESULT, $F_ISBROWSER, $S_TMP, $I_TMP
	$I_INSTANCE = Int($I_INSTANCE)
	If $I_INSTANCE < 1 Then
		__IEERRORNOTIFY("Error", "_IEAttach", "$_IEStatus_InvalidValue", "$i_instance < 1")
		SetError($_IESTATUS_INVALIDVALUE, 3)
		Return 0
	EndIf
	If $S_MODE = "embedded" Or $S_MODE = "dialogbox" Then
		Local $IWINTITLEMATCHMODE = Opt("WinTitleMatchMode")
		Opt("WinTitleMatchMode", 2)
		If $S_MODE = "dialogbox" And $I_INSTANCE > 1 Then
			If IsHWnd($S_STRING) Then
				$I_INSTANCE = 1
				__IEERRORNOTIFY("Warning", "_IEAttach", "$_IEStatus_GeneralError", "$i_instance > 1 invalid with HWnd and DialogBox.  Setting to 1.")
			Else
				Local $A_WINLIST = WinList($S_STRING, "")
				If $I_INSTANCE <= $A_WINLIST[0][0] Then
					$S_STRING = $A_WINLIST[$I_INSTANCE][1]
					$I_INSTANCE = 1
				Else
					__IEERRORNOTIFY("Warning", "_IEAttach", "$_IEStatus_NoMatch")
					SetError($_IESTATUS_NOMATCH, 1)
					Return 0
				EndIf
			EndIf
		EndIf
		$H_CONTROL = ControlGetHandle($S_STRING, "", "[CLASS:Internet Explorer_Server; INSTANCE:" & $I_INSTANCE & "]")
		$ORESULT = __IECONTROLGETOBJFROMHWND($H_CONTROL)
		Opt("WinTitleMatchMode", $IWINTITLEMATCHMODE)
		If IsObj($ORESULT) Then
			SetError($_IESTATUS_SUCCESS)
			Return $ORESULT
		Else
			__IEERRORNOTIFY("Warning", "_IEAttach", "$_IEStatus_NoMatch")
			SetError($_IESTATUS_NOMATCH, 1)
			Return 0
		EndIf
	EndIf
	Local $O_SHELL = ObjCreate("Shell.Application")
	Local $O_SHELLWINDOWS = $O_SHELL.Windows()
	$I_TMP = 1
	For $O_WINDOW In $O_SHELLWINDOWS
		$F_ISBROWSER = True
		Local $STATUS = __IEINTERNALERRORHANDLERREGISTER()
		If Not $STATUS Then __IEERRORNOTIFY("Warning", "_IEAttach", "Cannot register internal error handler, cannot trap COM errors", "Use _IEErrorHandlerRegister() to register a user error handler")
		Local $F_NOTIFYSTATUS = _IEERRORNOTIFY()
		_IEERRORNOTIFY(False)
		If $F_ISBROWSER Then
			$S_TMP = $O_WINDOW.type
			If @error Then $F_ISBROWSER = False
		EndIf
		If $F_ISBROWSER Then
			$S_TMP = $O_WINDOW.document.title
			If @error Then $F_ISBROWSER = False
		EndIf
		_IEERRORNOTIFY($F_NOTIFYSTATUS)
		__IEINTERNALERRORHANDLERDEREGISTER()
		If $F_ISBROWSER Then
			Switch $S_MODE
				Case "title"
					If StringInStr($O_WINDOW.document.title, $S_STRING) > 0 Then
						If $I_INSTANCE = $I_TMP Then
							SetError($_IESTATUS_SUCCESS)
							Return $O_WINDOW
						Else
							$I_TMP += 1
						EndIf
					EndIf
				Case "instance"
					If $I_INSTANCE = $I_TMP Then
						SetError($_IESTATUS_SUCCESS)
						Return $O_WINDOW
					Else
						$I_TMP += 1
					EndIf
				Case "windowtitle"
					Local $F_FOUND = False
					$S_TMP = RegRead("HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Main\", "Window Title")
					If Not @error Then
						If StringInStr($O_WINDOW.document.title & " - " & $S_TMP, $S_STRING) Then $F_FOUND = True
					Else
						If StringInStr($O_WINDOW.document.title & " - Microsoft Internet Explorer", $S_STRING) Then $F_FOUND = True
						If StringInStr($O_WINDOW.document.title & " - Windows Internet Explorer", $S_STRING) Then $F_FOUND = True
					EndIf
					If $F_FOUND Then
						If $I_INSTANCE = $I_TMP Then
							SetError($_IESTATUS_SUCCESS)
							Return $O_WINDOW
						Else
							$I_TMP += 1
						EndIf
					EndIf
				Case "url"
					If StringInStr($O_WINDOW.LocationURL, $S_STRING) > 0 Then
						If $I_INSTANCE = $I_TMP Then
							SetError($_IESTATUS_SUCCESS)
							Return $O_WINDOW
						Else
							$I_TMP += 1
						EndIf
					EndIf
				Case "text"
					If StringInStr($O_WINDOW.document.body.innerText, $S_STRING) > 0 Then
						If $I_INSTANCE = $I_TMP Then
							SetError($_IESTATUS_SUCCESS)
							Return $O_WINDOW
						Else
							$I_TMP += 1
						EndIf
					EndIf
				Case "html"
					If StringInStr($O_WINDOW.document.body.innerHTML, $S_STRING) > 0 Then
						If $I_INSTANCE = $I_TMP Then
							SetError($_IESTATUS_SUCCESS)
							Return $O_WINDOW
						Else
							$I_TMP += 1
						EndIf
					EndIf
				Case "hwnd"
					If $I_INSTANCE > 1 Then
						$I_INSTANCE = 1
						__IEERRORNOTIFY("Warning", "_IEAttach", "$_IEStatus_GeneralError", "$i_instance > 1 invalid with HWnd.  Setting to 1.")
					EndIf
					If _IEPROPERTYGET($O_WINDOW, "hwnd") = $S_STRING Then
						SetError($_IESTATUS_SUCCESS)
						Return $O_WINDOW
					EndIf
				Case Else
					__IEERRORNOTIFY("Error", "_IEAttach", "$_IEStatus_InvalidValue", "Invalid Mode Specified")
					SetError($_IESTATUS_INVALIDVALUE, 2)
					Return 0
			EndSwitch
		EndIf
	Next
	__IEERRORNOTIFY("Warning", "_IEAttach", "$_IEStatus_NoMatch")
	SetError($_IESTATUS_NOMATCH, 1)
	Return 0
EndFunc


Func _IELOADWAIT(ByRef $O_OBJECT, $I_DELAY = 0, $I_TIMEOUT = -1)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IELoadWait", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "browserdom") Then
		__IEERRORNOTIFY("Error", "_IELoadWait", "$_IEStatus_InvalidObjectType", ObjName($O_OBJECT))
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	Local $OTEMP, $F_ABORT = False, $I_ERRORSTATUSCODE = $_IESTATUS_SUCCESS
	Local $STATUS = __IEINTERNALERRORHANDLERREGISTER()
	If Not $STATUS Then __IEERRORNOTIFY("Warning", "_IELoadWait", "Cannot register internal error handler, cannot trap COM errors", "Use _IEErrorHandlerRegister() to register a user error handler")
	Local $F_NOTIFYSTATUS = _IEERRORNOTIFY()
	_IEERRORNOTIFY(False)
	Sleep($I_DELAY)
	Local $IELOADWAITTIMER = TimerInit()
	If $I_TIMEOUT = -1 Then $I_TIMEOUT = $__IELOADWAITTIMEOUT
	Switch ObjName($O_OBJECT)
		Case "IWebBrowser2"
			While Not (String($O_OBJECT.readyState) = "complete" Or $O_OBJECT.readyState = 4 Or $F_ABORT)
				If (TimerDiff($IELOADWAITTIMER) > $I_TIMEOUT) Then
					$I_ERRORSTATUSCODE = $_IESTATUS_LOADWAITTIMEOUT
					$F_ABORT = True
				EndIf
				If @error = $_IESTATUS_COMERROR And __IECOMERRORUNRECOVERABLE() Then
					$I_ERRORSTATUSCODE = __IECOMERRORUNRECOVERABLE()
					$F_ABORT = True
				EndIf
				Sleep(100)
			WEnd
			While Not (String($O_OBJECT.document.readyState) = "complete" Or $O_OBJECT.document.readyState = 4 Or $F_ABORT)
				If (TimerDiff($IELOADWAITTIMER) > $I_TIMEOUT) Then
					$I_ERRORSTATUSCODE = $_IESTATUS_LOADWAITTIMEOUT
					$F_ABORT = True
				EndIf
				If @error = $_IESTATUS_COMERROR And __IECOMERRORUNRECOVERABLE() Then
					$I_ERRORSTATUSCODE = __IECOMERRORUNRECOVERABLE()
					$F_ABORT = True
				EndIf
				Sleep(100)
			WEnd
		Case "DispHTMLWindow2"
			While Not (String($O_OBJECT.document.readyState) = "complete" Or $O_OBJECT.document.readyState = 4 Or $F_ABORT)
				If (TimerDiff($IELOADWAITTIMER) > $I_TIMEOUT) Then
					$I_ERRORSTATUSCODE = $_IESTATUS_LOADWAITTIMEOUT
					$F_ABORT = True
				EndIf
				If @error = $_IESTATUS_COMERROR And __IECOMERRORUNRECOVERABLE() Then
					$I_ERRORSTATUSCODE = __IECOMERRORUNRECOVERABLE()
					$F_ABORT = True
				EndIf
				Sleep(100)
			WEnd
			While Not (String($O_OBJECT.top.document.readyState) = "complete" Or $O_OBJECT.top.document.readyState = 4 Or $F_ABORT)
				If (TimerDiff($IELOADWAITTIMER) > $I_TIMEOUT) Then
					$I_ERRORSTATUSCODE = $_IESTATUS_LOADWAITTIMEOUT
					$F_ABORT = True
				EndIf
				If @error = $_IESTATUS_COMERROR And __IECOMERRORUNRECOVERABLE() Then
					$I_ERRORSTATUSCODE = __IECOMERRORUNRECOVERABLE()
					$F_ABORT = True
				EndIf
				Sleep(100)
			WEnd
		Case "DispHTMLDocument"
			$OTEMP = $O_OBJECT.parentWindow
			While Not (String($OTEMP.document.readyState) = "complete" Or $OTEMP.document.readyState = 4 Or $F_ABORT)
				If (TimerDiff($IELOADWAITTIMER) > $I_TIMEOUT) Then
					$I_ERRORSTATUSCODE = $_IESTATUS_LOADWAITTIMEOUT
					$F_ABORT = True
				EndIf
				If @error = $_IESTATUS_COMERROR And __IECOMERRORUNRECOVERABLE() Then
					$I_ERRORSTATUSCODE = __IECOMERRORUNRECOVERABLE()
					$F_ABORT = True
				EndIf
				Sleep(100)
			WEnd
			While Not (String($OTEMP.top.document.readyState) = "complete" Or $OTEMP.top.document.readyState = 4 Or $F_ABORT)
				If (TimerDiff($IELOADWAITTIMER) > $I_TIMEOUT) Then
					$I_ERRORSTATUSCODE = $_IESTATUS_LOADWAITTIMEOUT
					$F_ABORT = True
				EndIf
				If @error = $_IESTATUS_COMERROR And __IECOMERRORUNRECOVERABLE() Then
					$I_ERRORSTATUSCODE = __IECOMERRORUNRECOVERABLE()
					$F_ABORT = True
				EndIf
				Sleep(100)
			WEnd
		Case Else
			$OTEMP = $O_OBJECT.document.parentWindow
			While Not (String($OTEMP.document.readyState) = "complete" Or $OTEMP.document.readyState = 4 Or $F_ABORT)
				If (TimerDiff($IELOADWAITTIMER) > $I_TIMEOUT) Then
					$I_ERRORSTATUSCODE = $_IESTATUS_LOADWAITTIMEOUT
					$F_ABORT = True
				EndIf
				If @error = $_IESTATUS_COMERROR And __IECOMERRORUNRECOVERABLE() Then
					$I_ERRORSTATUSCODE = __IECOMERRORUNRECOVERABLE()
					$F_ABORT = True
				EndIf
				Sleep(100)
			WEnd
			While Not (String($OTEMP.top.document.readyState) = "complete" Or $O_OBJECT.top.document.readyState = 4 Or $F_ABORT)
				If (TimerDiff($IELOADWAITTIMER) > $I_TIMEOUT) Then
					$I_ERRORSTATUSCODE = $_IESTATUS_LOADWAITTIMEOUT
					$F_ABORT = True
				EndIf
				If @error = $_IESTATUS_COMERROR And __IECOMERRORUNRECOVERABLE() Then
					$I_ERRORSTATUSCODE = __IECOMERRORUNRECOVERABLE()
					$F_ABORT = True
				EndIf
				Sleep(100)
			WEnd
	EndSwitch
	_IEERRORNOTIFY($F_NOTIFYSTATUS)
	__IEINTERNALERRORHANDLERDEREGISTER()
	Switch $I_ERRORSTATUSCODE
		Case $_IESTATUS_SUCCESS
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $_IESTATUS_LOADWAITTIMEOUT
			__IEERRORNOTIFY("Warning", "_IELoadWait", "$_IEStatus_LoadWaitTimeout")
			SetError($_IESTATUS_LOADWAITTIMEOUT, 3)
			Return 0
		Case $_IESTATUS_ACCESSISDENIED
			__IEERRORNOTIFY("Warning", "_IELoadWait", "$_IEStatus_AccessIsDenied", "Cannot verify readyState.  Likely casue: cross-site scripting security restriction.")
			SetError($_IESTATUS_ACCESSISDENIED)
			Return 0
		Case $_IESTATUS_CLIENTDISCONNECTED
			__IEERRORNOTIFY("Error", "_IELoadWait", "$_IEStatus_ClientDisconnected", "Browser has been deleted prior to operation.")
			SetError($_IESTATUS_CLIENTDISCONNECTED)
			Return 0
		Case Else
			__IEERRORNOTIFY("Error", "_IELoadWait", "$_IEStatus_GeneralError", "Invalid Error Status - Notify IE.au3 developer")
			SetError($_IESTATUS_GENERALERROR)
			Return 0
	EndSwitch
EndFunc


Func _IELOADWAITTIMEOUT($I_TIMEOUT = -1)
	If $I_TIMEOUT = -1 Then
		SetError($_IESTATUS_SUCCESS)
		Return $__IELOADWAITTIMEOUT
	Else
		$__IELOADWAITTIMEOUT = $I_TIMEOUT
		SetError($_IESTATUS_SUCCESS)
		Return 1
	EndIf
EndFunc

#endregion Core functions
#region Frame Functions

Func _IEISFRAMESET(ByRef $O_OBJECT)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEIsFrameSet", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If String($O_OBJECT.document.body.tagName) = "FRAMESET" Then
		SetError($_IESTATUS_SUCCESS)
		Return 1
	Else
		SetError($_IESTATUS_SUCCESS)
		Return 0
	EndIf
EndFunc


Func _IEFRAMEGETCOLLECTION(ByRef $O_OBJECT, $I_INDEX = -1)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEFrameGetCollection", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	$I_INDEX = Number($I_INDEX)
	Select
		Case $I_INDEX = -1
			SetError($_IESTATUS_SUCCESS)
			SetExtended($O_OBJECT.document.parentwindow.frames.length)
			Return $O_OBJECT.document.parentwindow.frames
		Case $I_INDEX > -1 And $I_INDEX < $O_OBJECT.document.parentwindow.frames.length
			SetError($_IESTATUS_SUCCESS)
			SetExtended($O_OBJECT.document.parentwindow.frames.length)
			Return $O_OBJECT.document.parentwindow.frames.item($I_INDEX)
		Case $I_INDEX < -1
			__IEERRORNOTIFY("Error", "_IEFrameGetCollection", "$_IEStatus_InvalidValue", "$i_index < -1")
			SetError($_IESTATUS_INVALIDVALUE, 2)
			Return 0
		Case Else
			__IEERRORNOTIFY("Warning", "_IEFrameGetCollection", "$_IEStatus_NoMatch")
			SetError($_IESTATUS_NOMATCH, 2)
			Return 0
	EndSelect
EndFunc


Func _IEFRAMEGETOBJBYNAME(ByRef $O_OBJECT, $S_NAME)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEFrameGetObjByName", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	Local $OTEMP, $OFRAMES, $OFRAME
	If Not __IEISOBJTYPE($O_OBJECT, "browserdom") Then
		__IEERRORNOTIFY("Error", "_IEFrameGetObjByName", "$_IEStatus_InvalidObjectType")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	If __IEISOBJTYPE($O_OBJECT, "document") Then
		$OTEMP = $O_OBJECT.parentWindow
	Else
		$OTEMP = $O_OBJECT.document.parentWindow
	EndIf
	If _IEISFRAMESET($OTEMP) Then
		$OFRAMES = _IETAGNAMEGETCOLLECTION($OTEMP, "frame")
	Else
		$OFRAMES = _IETAGNAMEGETCOLLECTION($OTEMP, "iframe")
	EndIf
	If $OFRAMES.length Then
		For $OFRAME In $OFRAMES
			If $OFRAME.name = $S_NAME Then
				SetError($_IESTATUS_SUCCESS)
				Return $OTEMP.frames($S_NAME)
			EndIf
		Next
		__IEERRORNOTIFY("Warning", "_IEFrameGetObjByName", "$_IEStatus_NoMatch", "No frames matching name")
		SetError($_IESTATUS_NOMATCH, 2)
		Return 0
	Else
		__IEERRORNOTIFY("Warning", "_IEFrameGetObjByName", "$_IEStatus_NoMatch", "No Frames found")
		SetError($_IESTATUS_NOMATCH, 2)
		Return 0
	EndIf
EndFunc

#endregion Frame Functions
#region Link functions

Func _IELINKCLICKBYTEXT(ByRef $O_OBJECT, $S_LINKTEXT, $I_INDEX = 0, $F_WAIT = 1)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IELinkClickByText", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	Local $FOUND = 0, $LINK, $LINKTEXT, $LINKS = $O_OBJECT.document.links
	$I_INDEX = Number($I_INDEX)
	For $LINK In $LINKS
		$LINKTEXT = $LINK.outerText & ""
		If $LINKTEXT = $S_LINKTEXT Then
			If ($FOUND = $I_INDEX) Then
				$LINK.click
				If $F_WAIT Then
					_IELOADWAIT($O_OBJECT)
					SetError(@error)
					Return -1
				EndIf
				SetError($_IESTATUS_SUCCESS)
				Return -1
			EndIf
			$FOUND = $FOUND + 1
		EndIf
	Next
	__IEERRORNOTIFY("Warning", "_IELinkClickByText", "$_IEStatus_NoMatch")
	SetError($_IESTATUS_NOMATCH)
	Return 0
EndFunc


Func _IELINKCLICKBYINDEX(ByRef $O_OBJECT, $I_INDEX, $F_WAIT = 1)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IELinkClickByIndex", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	Local $OLINKS = $O_OBJECT.document.links, $OLINK
	$I_INDEX = Number($I_INDEX)
	If ($I_INDEX >= 0) And ($I_INDEX <= $OLINKS.length - 1) Then
		$OLINK = $OLINKS($I_INDEX)
		$OLINK.click
		If $F_WAIT Then
			_IELOADWAIT($O_OBJECT)
			SetError(@error)
			Return -1
		EndIf
		SetError($_IESTATUS_SUCCESS)
		Return -1
	Else
		__IEERRORNOTIFY("Warning", "_IELinkClickByIndex", "$_IEStatus_NoMatch")
		SetError($_IESTATUS_NOMATCH, 2)
		Return 0
	EndIf
EndFunc


Func _IELINKGETCOLLECTION(ByRef $O_OBJECT, $I_INDEX = -1)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IELinkGetCollection", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	$I_INDEX = Number($I_INDEX)
	Select
		Case $I_INDEX = -1
			SetError($_IESTATUS_SUCCESS)
			SetExtended($O_OBJECT.document.links.length)
			Return $O_OBJECT.document.links
		Case $I_INDEX > -1 And $I_INDEX < $O_OBJECT.document.links.length
			SetError($_IESTATUS_SUCCESS)
			SetExtended($O_OBJECT.document.links.length)
			Return $O_OBJECT.document.links.item($I_INDEX)
		Case $I_INDEX < -1
			__IEERRORNOTIFY("Error", "_IELinkGetCollection", "$_IEStatus_InvalidValue")
			SetError($_IESTATUS_INVALIDVALUE, 2)
			Return 0
		Case Else
			__IEERRORNOTIFY("Warning", "_IELinkGetCollection", "$_IEStatus_NoMatch")
			SetError($_IESTATUS_NOMATCH, 2)
			Return 0
	EndSelect
EndFunc

#endregion Link functions
#region Image functions

Func _IEIMGCLICK(ByRef $O_OBJECT, $S_LINKTEXT, $S_MODE = "src", $I_INDEX = 0, $F_WAIT = 1)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEImgClick", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	Local $LINKTEXT, $FOUND = 0, $IMG, $IMGS = $O_OBJECT.document.images
	$S_MODE = StringLower($S_MODE)
	$I_INDEX = Number($I_INDEX)
	For $IMG In $IMGS
		Select
			Case $S_MODE = "alt"
				$LINKTEXT = $IMG.alt
			Case $S_MODE = "name"
				$LINKTEXT = $IMG.name
			Case $S_MODE = "src"
				$LINKTEXT = $IMG.src
			Case Else
				__IEERRORNOTIFY("Error", "_IEImgClick", "$_IEStatus_InvalidValue", "Invalid mode: " & $S_MODE)
				SetError($_IESTATUS_INVALIDVALUE, 3)
				Return 0
		EndSelect
		If StringInStr($LINKTEXT, $S_LINKTEXT) Then
			If ($FOUND = $I_INDEX) Then
				$IMG.click
				If $F_WAIT Then
					_IELOADWAIT($O_OBJECT)
					SetError(@error)
					Return -1
				EndIf
				SetError($_IESTATUS_SUCCESS)
				Return -1
			EndIf
			$FOUND = $FOUND + 1
		EndIf
	Next
	__IEERRORNOTIFY("Warning", "_IEImgClick", "$_IEStatus_NoMatch")
	SetError($_IESTATUS_NOMATCH)
	Return 0
EndFunc


Func _IEIMGGETCOLLECTION(ByRef $O_OBJECT, $I_INDEX = -1)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEImgGetCollection", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	Local $OTEMP = _IEDOCGETOBJ($O_OBJECT)
	$I_INDEX = Number($I_INDEX)
	Select
		Case $I_INDEX = -1
			SetError($_IESTATUS_SUCCESS)
			SetExtended($OTEMP.images.length)
			Return $OTEMP.images
		Case $I_INDEX > -1 And $I_INDEX < $OTEMP.images.length
			SetError($_IESTATUS_SUCCESS)
			SetExtended($OTEMP.images.length)
			Return $OTEMP.images.item($I_INDEX)
		Case $I_INDEX < -1
			__IEERRORNOTIFY("Error", "_IEImgGetCollection", "$_IEStatus_InvalidValue", "$i_index < -1")
			SetError($_IESTATUS_INVALIDVALUE, 2)
			Return 0
		Case Else
			__IEERRORNOTIFY("Warning", "_IEImgGetCollection", "$_IEStatus_NoMatch")
			SetError($_IESTATUS_NOMATCH, 1)
			Return 0
	EndSelect
EndFunc

#endregion Image functions
#region Form functions

Func _IEFORMGETCOLLECTION(ByRef $O_OBJECT, $I_INDEX = -1)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEFormGetCollection", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	Local $OTEMP = _IEDOCGETOBJ($O_OBJECT)
	$I_INDEX = Number($I_INDEX)
	Select
		Case $I_INDEX = -1
			SetError($_IESTATUS_SUCCESS)
			SetExtended($OTEMP.forms.length)
			Return $OTEMP.forms
		Case $I_INDEX > -1 And $I_INDEX < $OTEMP.forms.length
			SetError($_IESTATUS_SUCCESS)
			SetExtended($OTEMP.forms.length)
			Return $OTEMP.forms.item($I_INDEX)
		Case $I_INDEX < -1
			__IEERRORNOTIFY("Error", "_IEFormGetCollection", "$_IEStatus_InvalidValue", "$i_index < -1")
			SetError($_IESTATUS_INVALIDVALUE, 2)
			Return 0
		Case Else
			__IEERRORNOTIFY("Warning", "_IEFormGetCollection", "$_IEStatus_NoMatch")
			SetError($_IESTATUS_NOMATCH, 1)
			Return 0
	EndSelect
EndFunc


Func _IEFORMGETOBJBYNAME(ByRef $O_OBJECT, $S_NAME, $I_INDEX = 0)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEFormGetObjByName", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	Local $O_COL, $I_LENGTH = 0
	$O_COL = $O_OBJECT.document.forms.item($S_NAME)
	If IsObj($O_COL) Then
		If __IEISOBJTYPE($O_COL, "elementcollection") Then
			$I_LENGTH = $O_COL.length
		Else
			$I_LENGTH = 1
		EndIf
	EndIf
	$I_INDEX = Number($I_INDEX)
	If $I_INDEX = -1 Then
		SetError($_IESTATUS_SUCCESS)
		SetExtended($I_LENGTH)
		Return $O_OBJECT.document.forms.item($S_NAME)
	Else
		If IsObj($O_OBJECT.document.forms.item($S_NAME, $I_INDEX)) Then
			SetError($_IESTATUS_SUCCESS)
			SetExtended($I_LENGTH)
			Return $O_OBJECT.document.forms.item($S_NAME, $I_INDEX)
		Else
			__IEERRORNOTIFY("Warning", "_IEFormGetObjByName", "$_IEStatus_NoMatch")
			SetError($_IESTATUS_NOMATCH)
			Return 0
		EndIf
	EndIf
EndFunc


Func _IEFORMELEMENTGETCOLLECTION(ByRef $O_OBJECT, $I_INDEX = -1)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEFormElementGetCollection", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "form") Then
		__IEERRORNOTIFY("Error", "_IEFormElementGetCollection", "$_IEStatus_InvalidObjectType")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	$I_INDEX = Number($I_INDEX)
	Select
		Case $I_INDEX = -1
			SetError($_IESTATUS_SUCCESS)
			SetExtended($O_OBJECT.elements.length)
			Return $O_OBJECT.elements
		Case $I_INDEX > -1 And $I_INDEX < $O_OBJECT.elements.length
			SetError($_IESTATUS_SUCCESS)
			SetExtended($O_OBJECT.elements.length)
			Return $O_OBJECT.elements.item($I_INDEX)
		Case $I_INDEX < -1
			__IEERRORNOTIFY("Error", "_IEFormElementGetCollection", "$_IEStatus_InvalidValue", "$i_index < -1")
			SetError($_IESTATUS_INVALIDVALUE, 2)
			Return 0
		Case Else
			SetError($_IESTATUS_NOMATCH, 1)
			Return 0
	EndSelect
EndFunc


Func _IEFORMELEMENTGETOBJBYNAME(ByRef $O_OBJECT, $S_NAME, $I_INDEX = 0)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEFormElementGetObjByName", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "form") Then
		__IEERRORNOTIFY("Error", "_IEFormElementGetObjByName", "$_IEStatus_InvalidObjectType")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	Local $O_COL, $I_LENGTH = 0
	$O_COL = $O_OBJECT.elements.item($S_NAME)
	If IsObj($O_COL) Then
		If __IEISOBJTYPE($O_COL, "elementcollection") Then
			$I_LENGTH = $O_COL.length
		Else
			$I_LENGTH = 1
		EndIf
	EndIf
	$I_INDEX = Number($I_INDEX)
	If $I_INDEX = -1 Then
		SetError($_IESTATUS_SUCCESS)
		SetExtended($I_LENGTH)
		Return $O_OBJECT.elements.item($S_NAME)
	Else
		If IsObj($O_OBJECT.elements.item($S_NAME, $I_INDEX)) Then
			SetError($_IESTATUS_SUCCESS)
			SetExtended($I_LENGTH)
			Return $O_OBJECT.elements.item($S_NAME, $I_INDEX)
		Else
			__IEERRORNOTIFY("Warning", "_IEFormElementGetObjByName", "$_IEStatus_NoMatch")
			SetError($_IESTATUS_NOMATCH)
			Return 0
		EndIf
	EndIf
EndFunc


Func _IEFORMELEMENTGETVALUE(ByRef $O_OBJECT)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEFormElementGetValue", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "forminputelement") Then
		__IEERRORNOTIFY("Error", "_IEFormElementGetValue", "$_IEStatus_InvalidObjectType")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	SetError($_IESTATUS_SUCCESS)
	If $O_OBJECT.value Then
		Return $O_OBJECT.value
	Else
		Return ""
	EndIf
EndFunc


Func _IEFORMELEMENTSETVALUE(ByRef $O_OBJECT, $S_NEWVALUE, $F_FIREEVENT = 1)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEFormElementSetValue", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "forminputelement") Then
		__IEERRORNOTIFY("Error", "_IEFormElementSetValue", "$_IEStatus_InvalidObjectType")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	If String($O_OBJECT.type) = "file" Then
		__IEERRORNOTIFY("Error", "_IEFormElementSetValue", "$_IEStatus_InvalidObjectType", "Browser securuty prevents SetValue of TYPE=FILE")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	$O_OBJECT.value = $S_NEWVALUE
	If $F_FIREEVENT Then
		$O_OBJECT.fireEvent("OnChange")
		$O_OBJECT.fireEvent("OnClick")
	EndIf
	SetError($_IESTATUS_SUCCESS)
	Return 1
EndFunc


Func _IEFORMELEMENTOPTIONSELECT(ByRef $O_OBJECT, $S_STRING, $F_SELECT = 1, $S_MODE = "byValue", $F_FIREEVENT = 1)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEFormElementOptionSelect", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "formselectelement") Then
		__IEERRORNOTIFY("Error", "_IEFormElementOptionSelect", "$_IEStatus_InvalidObjectType")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	Local $OITEM, $OITEMS = $O_OBJECT.options, $INUMITEMS = $O_OBJECT.options.length, $F_ISMULTIPLE = $O_OBJECT.multiple
	Switch $S_MODE
		Case "byValue"
			For $OITEM In $OITEMS
				If $OITEM.value = $S_STRING Then
					Switch $F_SELECT
						Case (-1)
							SetError($_IESTATUS_SUCCESS)
							Return $OITEM.selected
						Case 0
							If Not $F_ISMULTIPLE Then
								__IEERRORNOTIFY("Error", "_IEFormElementOptionSelect", "$_IEStatus_InvalidValue", "$f_select=0 only valid for type=select multiple")
								SetError($_IESTATUS_INVALIDVALUE, 3)
							EndIf
							If $OITEM.selected Then
								$OITEM.selected = False
								If $F_FIREEVENT Then
									$O_OBJECT.fireEvent("onChange")
									$O_OBJECT.fireEvent("OnClick")
								EndIf
							EndIf
							SetError($_IESTATUS_SUCCESS)
							Return 1
						Case 1
							If Not $OITEM.selected Then
								$OITEM.selected = True
								If $F_FIREEVENT Then
									$O_OBJECT.fireEvent("onChange")
									$O_OBJECT.fireEvent("OnClick")
								EndIf
							EndIf
							SetError($_IESTATUS_SUCCESS)
							Return 1
						Case Else
							__IEERRORNOTIFY("Error", "_IEFormElementOptionSelect", "$_IEStatus_InvalidValue", "Invalid $f_select value")
							SetError($_IESTATUS_INVALIDVALUE, 3)
							Return 0
					EndSwitch
					__IEERRORNOTIFY("Warning", "_IEFormElementOptionSelect", "$_IEStatus_NoMatch", "Value not matched")
					SetError($_IESTATUS_NOMATCH, 2)
					Return 0
				EndIf
			Next
		Case "byText"
			For $OITEM In $OITEMS
				If String($OITEM.text) = $S_STRING Then
					Switch $F_SELECT
						Case (-1)
							SetError($_IESTATUS_SUCCESS)
							Return $OITEM.selected
						Case 0
							If Not $F_ISMULTIPLE Then
								__IEERRORNOTIFY("Error", "_IEFormElementOptionSelect", "$_IEStatus_InvalidValue", "$f_select=0 only valid for type=select multiple")
								SetError($_IESTATUS_INVALIDVALUE, 3)
							EndIf
							If $OITEM.selected Then
								$OITEM.selected = False
								If $F_FIREEVENT Then
									$O_OBJECT.fireEvent("onChange")
									$O_OBJECT.fireEvent("OnClick")
								EndIf
							EndIf
							SetError($_IESTATUS_SUCCESS)
							Return 1
						Case 1
							If Not $OITEM.selected Then
								$OITEM.selected = True
								If $F_FIREEVENT Then
									$O_OBJECT.fireEvent("onChange")
									$O_OBJECT.fireEvent("OnClick")
								EndIf
							EndIf
							SetError($_IESTATUS_SUCCESS)
							Return 1
						Case Else
							__IEERRORNOTIFY("Error", "_IEFormElementOptionSelect", "$_IEStatus_InvalidValue", "Invalid $f_select value")
							SetError($_IESTATUS_INVALIDVALUE, 3)
							Return 0
					EndSwitch
					__IEERRORNOTIFY("Warning", "_IEFormElementOptionSelect", "$_IEStatus_NoMatch", "Text not matched")
					SetError($_IESTATUS_NOMATCH, 2)
					Return 0
				EndIf
			Next
		Case "byIndex"
			Local $I_INDEX = Number($S_STRING)
			If $I_INDEX < 0 Or $I_INDEX >= $INUMITEMS Then
				__IEERRORNOTIFY("Error", "_IEFormElementOptionSelect", "$_IEStatus_InvalidValue", "Invalid index value, " & $I_INDEX)
				SetError($_IESTATUS_INVALIDVALUE, 2)
				Return 0
			EndIf
			$OITEM = $OITEMS.item($I_INDEX)
			Switch $F_SELECT
				Case (-1)
					SetError($_IESTATUS_SUCCESS)
					Return $OITEMS.item($I_INDEX).selected
				Case 0
					If Not $F_ISMULTIPLE Then
						__IEERRORNOTIFY("Error", "_IEFormElementOptionSelect", "$_IEStatus_InvalidValue", "$f_select=0 only valid for type=select multiple")
						SetError($_IESTATUS_INVALIDVALUE, 3)
					EndIf
					If $OITEM.selected Then
						$OITEMS.item($I_INDEX).selected = False
						If $F_FIREEVENT Then
							$O_OBJECT.fireEvent("onChange")
							$O_OBJECT.fireEvent("OnClick")
						EndIf
					EndIf
					SetError($_IESTATUS_SUCCESS)
					Return 1
				Case 1
					If Not $OITEM.selected Then
						$OITEMS.item($I_INDEX).selected = True
						If $F_FIREEVENT Then
							$O_OBJECT.fireEvent("onChange")
							$O_OBJECT.fireEvent("OnClick")
						EndIf
					EndIf
					SetError($_IESTATUS_SUCCESS)
					Return 1
				Case Else
					__IEERRORNOTIFY("Error", "_IEFormElementOptionSelect", "$_IEStatus_InvalidValue", "Invalid $f_select value")
					SetError($_IESTATUS_INVALIDVALUE, 3)
					Return 0
			EndSwitch
		Case Else
			__IEERRORNOTIFY("Error", "_IEFormElementOptionSelect", "$_IEStatus_InvalidValue", "Invalid Mode")
			SetError($_IESTATUS_INVALIDVALUE, 4)
			Return 0
	EndSwitch
EndFunc


Func _IEFORMELEMENTCHECKBOXSELECT(ByRef $O_OBJECT, $S_STRING, $S_NAME = "", $F_SELECT = 1, $S_MODE = "byValue", $F_FIREEVENT = 1)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEFormElementCheckboxSelect", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "form") Then
		__IEERRORNOTIFY("Error", "_IEFormElementCheckboxSelect", "$_IEStatus_InvalidObjectType")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	Local $ICOUNT, $OITEM, $OITEMS, $F_FOUND = False
	$S_STRING = String($S_STRING)
	$S_NAME = String($S_NAME)
	If $S_NAME = "" Then
		$OITEMS = _IETAGNAMEGETCOLLECTION($O_OBJECT, "input")
	Else
		$OITEMS = Execute("$o_object.elements('" & $S_NAME & "')")
	EndIf
	If Not IsObj($OITEMS) Then
		__IEERRORNOTIFY("Warning", "_IEFormElementCheckboxSelect", "$_IEStatus_NoMatch")
		SetError($_IESTATUS_NOMATCH, 3)
		Return 0
	EndIf
	Switch $S_MODE
		Case "byValue"
			If __IEISOBJTYPE($OITEMS, "forminputelement") Then
				$OITEM = $OITEMS
				If String($OITEM.type) = "checkbox" And String($OITEM.value) = $S_STRING Then $F_FOUND = True
			Else
				For $OITEM In $OITEMS
					If String($OITEM.type) = "checkbox" And String($OITEM.value) = $S_STRING Then
						$F_FOUND = True
						ExitLoop
					EndIf
				Next
			EndIf
		Case "byIndex"
			If __IEISOBJTYPE($OITEMS, "forminputelement") Then
				$OITEM = $OITEMS
				If String($OITEM.type) = "checkbox" And Number($S_STRING) = 0 Then $F_FOUND = True
			Else
				$ICOUNT = 0
				For $OITEM In $OITEMS
					If String($OITEM.type) = "checkbox" And Number($S_STRING) = $ICOUNT Then
						$F_FOUND = True
						ExitLoop
					Else
						If String($OITEM.type) = "checkbox" Then $ICOUNT += 1
					EndIf
				Next
			EndIf
		Case Else
			__IEERRORNOTIFY("Error", "_IEFormElementCheckboxSelect", "$_IEStatus_InvalidValue", "Invalid Mode")
			SetError($_IESTATUS_INVALIDVALUE, 5)
			Return 0
	EndSwitch
	If Not $F_FOUND Then
		__IEERRORNOTIFY("Warning", "_IEFormElementCheckboxSelect", "$_IEStatus_NoMatch")
		SetError($_IESTATUS_NOMATCH, 2)
		Return 0
	EndIf
	Switch $F_SELECT
		Case (-1)
			SetError($_IESTATUS_SUCCESS)
			Return $OITEM.checked
		Case 0
			If $OITEM.checked Then
				$OITEM.checked = False
				If $F_FIREEVENT Then
					$OITEM.fireEvent("onChange")
					$OITEM.fireEvent("OnClick")
				EndIf
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case 1
			If Not $OITEM.checked Then
				$OITEM.checked = True
				If $F_FIREEVENT Then
					$OITEM.fireEvent("onChange")
					$OITEM.fireEvent("OnClick")
				EndIf
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case Else
			__IEERRORNOTIFY("Error", "_IEFormElementCheckboxSelect", "$_IEStatus_InvalidValue", "Invalid $f_select value")
			SetError($_IESTATUS_INVALIDVALUE, 3)
			Return 0
	EndSwitch
EndFunc


Func _IEFORMELEMENTRADIOSELECT(ByRef $O_OBJECT, $S_STRING, $S_NAME, $F_SELECT = 1, $S_MODE = "byValue", $F_FIREEVENT = 1)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEFormElementRadioSelect", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "form") Then
		__IEERRORNOTIFY("Error", "_IEFormElementRadioSelect", "$_IEStatus_InvalidObjectType")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	Local $ICOUNT = 0, $OITEM, $OITEMS, $F_FOUND = False
	$S_STRING = String($S_STRING)
	$S_NAME = String($S_NAME)
	$OITEMS = Execute("$o_object.elements('" & $S_NAME & "')")
	If Not IsObj($OITEMS) Then
		__IEERRORNOTIFY("Warning", "_IEFormElementRadioSelect", "$_IEStatus_NoMatch")
		SetError($_IESTATUS_NOMATCH, 3)
		Return 0
	EndIf
	Switch $S_MODE
		Case "byValue"
			If __IEISOBJTYPE($OITEMS, "forminputelement") Then
				$OITEM = $OITEMS
				If String($OITEM.type) = "radio" And String($OITEM.value) = $S_STRING Then $F_FOUND = True
			Else
				For $OITEM In $OITEMS
					If String($OITEM.type) = "radio" And String($OITEM.value) = $S_STRING Then
						$F_FOUND = True
						ExitLoop
					EndIf
				Next
			EndIf
		Case "byIndex"
			If __IEISOBJTYPE($OITEMS, "forminputelement") Then
				$OITEM = $OITEMS
				If String($OITEM.type) = "radio" And Number($S_STRING) = 0 Then $F_FOUND = True
			Else
				$ICOUNT = 0
				For $OITEM In $OITEMS
					If String($OITEM.type) = "radio" And Number($S_STRING) = $ICOUNT Then
						$F_FOUND = True
						ExitLoop
					Else
						$ICOUNT += 1
					EndIf
				Next
			EndIf
		Case Else
			__IEERRORNOTIFY("Error", "_IEFormElementRadioSelect", "$_IEStatus_InvalidValue", "Invalid Mode")
			SetError($_IESTATUS_INVALIDVALUE, 5)
			Return 0
	EndSwitch
	If Not $F_FOUND Then
		__IEERRORNOTIFY("Warning", "_IEFormElementRadioSelect", "$_IEStatus_NoMatch")
		SetError($_IESTATUS_NOMATCH, 2)
		Return 0
	EndIf
	Switch $F_SELECT
		Case (-1)
			SetError($_IESTATUS_SUCCESS)
			Return $OITEM.checked
		Case 0
			If $OITEM.checked Then
				$OITEM.checked = False
				If $F_FIREEVENT Then
					$OITEM.fireEvent("onChange")
					$OITEM.fireEvent("OnClick")
				EndIf
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case 1
			If Not $OITEM.checked Then
				$OITEM.checked = True
				If $F_FIREEVENT Then
					$OITEM.fireEvent("onChange")
					$OITEM.fireEvent("OnClick")
				EndIf
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case Else
			__IEERRORNOTIFY("Error", "_IEFormElementRadioSelect", "$_IEStatus_InvalidValue", "$f_select value invalid")
			SetError($_IESTATUS_INVALIDVALUE, 4)
			Return 0
	EndSwitch
EndFunc


Func _IEFORMIMAGECLICK(ByRef $O_OBJECT, $S_LINKTEXT, $S_MODE = "src", $I_INDEX = 0, $F_WAIT = 1)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEFormImageClick", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	Local $LINKTEXT, $FOUND = 0, $IMG, $IMGS
	Local $OTEMP = _IEDOCGETOBJ($O_OBJECT)
	$IMGS = _IETAGNAMEGETCOLLECTION($OTEMP, "input")
	$S_MODE = StringLower($S_MODE)
	$I_INDEX = Number($I_INDEX)
	For $IMG In $IMGS
		If String($IMG.type) = "image" Then
			Select
				Case $S_MODE = "alt"
					$LINKTEXT = $IMG.alt
				Case $S_MODE = "name"
					$LINKTEXT = $IMG.name
				Case $S_MODE = "src"
					$LINKTEXT = $IMG.src
				Case Else
					__IEERRORNOTIFY("Error", "_IEFormImageClick", "$_IEStatus_InvalidValue", "Invalid mode: " & $S_MODE)
					SetError($_IESTATUS_INVALIDVALUE, 3)
					Return 0
			EndSelect
			If StringInStr($LINKTEXT, $S_LINKTEXT) Then
				If ($FOUND = $I_INDEX) Then
					$IMG.click
					If $F_WAIT Then
						_IELOADWAIT($O_OBJECT)
						SetError(@error)
						Return -1
					EndIf
					SetError($_IESTATUS_SUCCESS)
					Return -1
				EndIf
				$FOUND = $FOUND + 1
			EndIf
		EndIf
	Next
	__IEERRORNOTIFY("Warning", "_IEFormImageClick", "$_IEStatus_NoMatch")
	SetError($_IESTATUS_NOMATCH, 2)
	Return 0
EndFunc


Func _IEFORMSUBMIT(ByRef $O_OBJECT, $F_WAIT = 1)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEFormSubmit", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "form") Then
		__IEERRORNOTIFY("Error", "_IEFormSubmit", "$_IEStatus_InvalidObjectType")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	SetError($_IESTATUS_SUCCESS)
	Local $O_WINDOW = $O_OBJECT.document.parentWindow
	$O_OBJECT.submit
	If $F_WAIT Then
		_IELOADWAIT($O_WINDOW)
		SetError(@error)
		Return -1
	EndIf
	Return -1
EndFunc


Func _IEFORMRESET(ByRef $O_OBJECT)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEFormReset", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "form") Then
		__IEERRORNOTIFY("Error", "_IEFormReset", "$_IEStatus_InvalidObjectType")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	SetError($_IESTATUS_SUCCESS)
	$O_OBJECT.reset
	Return 1
EndFunc

#endregion Form functions
#region Table functions

Func _IETABLEGETCOLLECTION(ByRef $O_OBJECT, $I_INDEX = -1)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IETableGetCollection", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	$I_INDEX = Number($I_INDEX)
	Select
		Case $I_INDEX = -1
			SetError($_IESTATUS_SUCCESS)
			SetExtended($O_OBJECT.document.GetElementsByTagName("table" ).length)
			Return $O_OBJECT.document.GetElementsByTagName("table")
		Case $I_INDEX > -1 And $I_INDEX < $O_OBJECT.document.GetElementsByTagName("table" ).length
			SetError($_IESTATUS_SUCCESS)
			SetExtended($O_OBJECT.document.GetElementsByTagName("table" ).length)
			Return $O_OBJECT.document.GetElementsByTagName("table" ).item($I_INDEX)
		Case $I_INDEX < -1
			__IEERRORNOTIFY("Error", "_IETableGetCollection", "$_IEStatus_InvalidValue", "$i_index < -1")
			SetError($_IESTATUS_INVALIDVALUE, 2)
			Return 0
		Case Else
			__IEERRORNOTIFY("Warning", "_IETableGetCollection", "$_IEStatus_NoMatch")
			SetError($_IESTATUS_NOMATCH, 1)
			Return 0
	EndSelect
EndFunc


Func _IETABLEWRITETOARRAY(ByRef $O_OBJECT, $F_TRANSPOSE = False)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IETableWriteToArray", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "table") Then
		__IEERRORNOTIFY("Error", "_IETableWriteToArray", "$_IEStatus_InvalidObjectType")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	Local $I_COLS = 0, $TRS, $TR, $TDS, $I_COL, $I_ROWS, $COL, $ROW
	$TRS = $O_OBJECT.rows
	For $TR In $TRS
		$TDS = $TR.cells
		$I_COL = 0
		For $TD In $TDS
			$I_COL = $I_COL + $TD.colSpan
		Next
		If $I_COL > $I_COLS Then $I_COLS = $I_COL
	Next
	$I_ROWS = $TRS.length
	Local $A_TABLECELLS[$I_COLS][$I_ROWS]
	$ROW = 0
	For $TR In $TRS
		$TDS = $TR.cells
		$COL = 0
		For $TD In $TDS
			$A_TABLECELLS[$COL][$ROW] = $TD.innerText
			$COL = $COL + $TD.colSpan
		Next
		$ROW = $ROW + 1
	Next
	If $F_TRANSPOSE Then
		Local $I_D1 = UBound($A_TABLECELLS, 1), $I_D2 = UBound($A_TABLECELLS, 2), $ATMP[$I_D2][$I_D1]
		For $I = 0 To $I_D2 - 1
			For $J = 0 To $I_D1 - 1
				$ATMP[$I][$J] = $A_TABLECELLS[$J][$I]
			Next
		Next
		$A_TABLECELLS = $ATMP
	EndIf
	SetError($_IESTATUS_SUCCESS)
	Return $A_TABLECELLS
EndFunc

#endregion Table functions
#region Read/Write functions

Func _IEBODYREADHTML(ByRef $O_OBJECT)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEBodyReadHTML", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	SetError($_IESTATUS_SUCCESS)
	Return $O_OBJECT.document.body.innerHTML
EndFunc


Func _IEBODYREADTEXT(ByRef $O_OBJECT)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEBodyReadText", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "browserdom") Then
		__IEERRORNOTIFY("Error", "_IEBodyReadText", "$_IEStatus_InvalidObjectType", "Expected document element")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	SetError($_IESTATUS_SUCCESS)
	Return $O_OBJECT.document.body.innerText
EndFunc


Func _IEBODYWRITEHTML(ByRef $O_OBJECT, $S_HTML)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEBodyWriteHTML", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "browserdom") Then
		__IEERRORNOTIFY("Error", "_IEBodyWriteHTML", "$_IEStatus_InvalidObjectType", "Expected document element")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	$O_OBJECT.document.body.innerHTML = $S_HTML
	Local $OTEMP = $O_OBJECT.document
	_IELOADWAIT($OTEMP)
	SetError(@error)
	Return -1
EndFunc


Func _IEDOCREADHTML(ByRef $O_OBJECT)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEDocReadHTML", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "browserdom") Then
		__IEERRORNOTIFY("Error", "_IEDocReadHTML", "$_IEStatus_InvalidObjectType", "Expected document element")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	SetError($_IESTATUS_SUCCESS)
	Return $O_OBJECT.document.documentElement.outerHTML
EndFunc


Func _IEDOCWRITEHTML(ByRef $O_OBJECT, $S_HTML)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEDocWriteHTML", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "browserdom") Then
		__IEERRORNOTIFY("Error", "_IEDocWriteHTML", "$_IEStatus_InvalidObjectType", "Expected document element")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	$O_OBJECT.document.Write($S_HTML)
	$O_OBJECT.document.close()
	Local $OTEMP = $O_OBJECT.document
	_IELOADWAIT($OTEMP)
	SetError(@error)
	Return -1
EndFunc


Func _IEDOCINSERTTEXT(ByRef $O_OBJECT, $S_STRING, $S_WHERE = "beforeend")
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEDocInsertText", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "browserdom") Or __IEISOBJTYPE($O_OBJECT, "documentcontainer") Or __IEISOBJTYPE($O_OBJECT, "document") Then
		__IEERRORNOTIFY("Error", "_IEDocInsertText", "$_IEStatus_InvalidObjectType", "Expected document element")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	$S_WHERE = StringLower($S_WHERE)
	Select
		Case $S_WHERE = "beforebegin"
			$O_OBJECT.insertAdjacentText($S_WHERE, $S_STRING)
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_WHERE = "afterbegin"
			$O_OBJECT.insertAdjacentText($S_WHERE, $S_STRING)
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_WHERE = "beforeend"
			$O_OBJECT.insertAdjacentText($S_WHERE, $S_STRING)
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_WHERE = "afterend"
			$O_OBJECT.insertAdjacentText($S_WHERE, $S_STRING)
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case Else
			__IEERRORNOTIFY("Error", "_IEDocInsertText", "$_IEStatus_InvalidValue", "Invalid where value")
			SetError($_IESTATUS_INVALIDVALUE, 3)
			Return 0
	EndSelect
EndFunc


Func _IEDOCINSERTHTML(ByRef $O_OBJECT, $S_STRING, $S_WHERE = "beforeend")
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEDocInsertHTML", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "browserdom") Or __IEISOBJTYPE($O_OBJECT, "documentcontainer") Or __IEISOBJTYPE($O_OBJECT, "document") Then
		__IEERRORNOTIFY("Error", "_IEDocInsertHTML", "$_IEStatus_InvalidObjectType", "Expected document element")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	$S_WHERE = StringLower($S_WHERE)
	Select
		Case $S_WHERE = "beforebegin"
			$O_OBJECT.insertAdjacentHTML($S_WHERE, $S_STRING)
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_WHERE = "afterbegin"
			$O_OBJECT.insertAdjacentHTML($S_WHERE, $S_STRING)
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_WHERE = "beforeend"
			$O_OBJECT.insertAdjacentHTML($S_WHERE, $S_STRING)
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_WHERE = "afterend"
			$O_OBJECT.insertAdjacentHTML($S_WHERE, $S_STRING)
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case Else
			__IEERRORNOTIFY("Error", "_IEDocInsertHTML", "$_IEStatus_InvalidValue", "Invalid where value")
			SetError($_IESTATUS_INVALIDVALUE, 3)
			Return 0
	EndSelect
EndFunc


Func _IEHEADINSERTEVENTSCRIPT(ByRef $O_OBJECT, $S_HTMLFOR, $S_EVENT, $S_SCRIPT)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEHeadInsertEventScript", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	Local $O_HEAD = $O_OBJECT.document.all.tags("HEAD" ).Item(0)
	Local $O_SCRIPT = $O_OBJECT.document.createElement("script")
	With $O_SCRIPT
		.defer = True
		.language = "jscript"
		.type = "text/javascript"
		.htmlFor = $S_HTMLFOR
		.event = $S_EVENT
		.text = $S_SCRIPT
	EndWith
	$O_HEAD.appendChild($O_SCRIPT)
	SetError($_IESTATUS_SUCCESS)
	Return 1
EndFunc

#endregion Read/Write functions
#region Utility functions

Func _IEDOCGETOBJ(ByRef $O_OBJECT)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEDocGetObj", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	Switch __IEISOBJTYPE($O_OBJECT, "document")
		Case True
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT
		Case False
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.document
	EndSwitch
EndFunc


Func _IETAGNAMEGETCOLLECTION(ByRef $O_OBJECT, $S_TAGNAME, $I_INDEX = -1)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IETagNameGetCollection", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "browserdom") Then
		__IEERRORNOTIFY("Error", "_IETagNameGetCollection", "$_IEStatus_InvalidObjectType")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	Local $OTEMP
	If __IEISOBJTYPE($O_OBJECT, "documentcontainer") Then
		$OTEMP = _IEDOCGETOBJ($O_OBJECT)
	Else
		$OTEMP = $O_OBJECT
	EndIf
	$I_INDEX = Number($I_INDEX)
	Select
		Case $I_INDEX = -1
			SetError($_IESTATUS_SUCCESS)
			SetExtended($OTEMP.GetElementsByTagName($S_TAGNAME).length)
			Return $OTEMP.GetElementsByTagName($S_TAGNAME)
		Case $I_INDEX > -1 And $I_INDEX < $OTEMP.GetElementsByTagName($S_TAGNAME).length
			SetError($_IESTATUS_SUCCESS)
			SetExtended($OTEMP.GetElementsByTagName($S_TAGNAME).length)
			Return $OTEMP.GetElementsByTagName($S_TAGNAME).item($I_INDEX)
		Case $I_INDEX < -1
			__IEERRORNOTIFY("Error", "_IETagNameGetCollection", "$_IEStatus_InvalidValue", "$i_index < -1")
			SetError($_IESTATUS_INVALIDVALUE, 3)
			Return 0
		Case Else
			__IEERRORNOTIFY("Error", "_IETagNameGetCollection", "$_IEStatus_NoMatch")
			SetError($_IESTATUS_NOMATCH)
			Return 0
	EndSelect
EndFunc


Func _IETAGNAMEALLGETCOLLECTION(ByRef $O_OBJECT, $I_INDEX = -1)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IETagNameAllGetCollection", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "browserdom") Then
		__IEERRORNOTIFY("Error", "_IETagNameAllGetCollection", "$_IEStatus_InvalidObjectType")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	Local $OTEMP
	If __IEISOBJTYPE($O_OBJECT, "documentcontainer") Then
		$OTEMP = _IEDOCGETOBJ($O_OBJECT)
	Else
		$OTEMP = $O_OBJECT
	EndIf
	$I_INDEX = Number($I_INDEX)
	Select
		Case $I_INDEX = -1
			SetError($_IESTATUS_SUCCESS)
			SetExtended($OTEMP.all.length)
			Return $OTEMP.all
		Case $I_INDEX > -1 And $I_INDEX < $OTEMP.all.length
			SetError($_IESTATUS_SUCCESS)
			SetExtended($OTEMP.all.length)
			Return $OTEMP.all.item($I_INDEX)
		Case $I_INDEX < -1
			__IEERRORNOTIFY("Error", "_IETagNameAllGetCollection", "$_IEStatus_InvalidValue", "$i_index < -1")
			SetError($_IESTATUS_INVALIDVALUE, 2)
			Return 0
		Case Else
			__IEERRORNOTIFY("Error", "_IETagNameAllGetCollection", "$_IEStatus_NoMatch")
			SetError($_IESTATUS_NOMATCH, 1)
			Return 0
	EndSelect
EndFunc


Func _IEGETOBJBYNAME(ByRef $O_OBJECT, $S_ID, $I_INDEX = 0)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEGetObjByName", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	$I_INDEX = Number($I_INDEX)
	If $I_INDEX = -1 Then
		SetError($_IESTATUS_SUCCESS)
		SetExtended($O_OBJECT.document.GetElementsByName($S_ID).length)
		Return $O_OBJECT.document.GetElementsByName($S_ID)
	Else
		If IsObj($O_OBJECT.document.GetElementsByName($S_ID).item($I_INDEX)) Then
			SetError($_IESTATUS_SUCCESS)
			SetExtended($O_OBJECT.document.GetElementsByName($S_ID).length)
			Return $O_OBJECT.document.GetElementsByName($S_ID).item($I_INDEX)
		Else
			__IEERRORNOTIFY("Warning", "_IEGetObjByName", "$_IEStatus_NoMatch", "Name: " & $S_ID & ", Index: " & $I_INDEX)
			SetError($_IESTATUS_NOMATCH)
			Return 0
		EndIf
	EndIf
EndFunc


Func _IEGETOBJBYID(ByRef $O_OBJECT, $S_ID)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEGetObjById", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "browserdom") Then
		__IEERRORNOTIFY("Error", "_IEGetObById", "$_IEStatus_InvalidObjectType")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	If IsObj($O_OBJECT.document.getElementById($S_ID)) Then
		SetError($_IESTATUS_SUCCESS)
		Return $O_OBJECT.document.getElementById($S_ID)
	Else
		__IEERRORNOTIFY("Warning", "_IEGetObjById", "$_IEStatus_NoMatch", $S_ID)
		SetError($_IESTATUS_NOMATCH, 2)
		Return 0
	EndIf
EndFunc


Func _IEACTION(ByRef $O_OBJECT, $S_ACTION)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEAction", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	$S_ACTION = StringLower($S_ACTION)
	Select
		Case $S_ACTION = "click"
			If __IEISOBJTYPE($O_OBJECT, "documentContainer") Then
				__IEERRORNOTIFY("Error", "_IEAction", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.Click()
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_ACTION = "disable"
			If __IEISOBJTYPE($O_OBJECT, "documentContainer") Then
				__IEERRORNOTIFY("Error", "_IEAction", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.disabled = True
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_ACTION = "enable"
			If __IEISOBJTYPE($O_OBJECT, "documentContainer") Then
				__IEERRORNOTIFY("Error", "_IEAction", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.disabled = False
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_ACTION = "focus"
			If __IEISOBJTYPE($O_OBJECT, "documentContainer") Then
				__IEERRORNOTIFY("Error", "_IEAction", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.Focus()
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_ACTION = "copy"
			$O_OBJECT.document.execCommand("Copy")
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_ACTION = "cut"
			$O_OBJECT.document.execCommand("Cut")
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_ACTION = "paste"
			$O_OBJECT.document.execCommand("Paste")
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_ACTION = "delete"
			$O_OBJECT.document.execCommand("Delete")
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_ACTION = "saveas"
			$O_OBJECT.document.execCommand("SaveAs")
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_ACTION = "refresh"
			$O_OBJECT.document.execCommand("Refresh")
			_IELOADWAIT($O_OBJECT)
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_ACTION = "selectall"
			$O_OBJECT.document.execCommand("SelectAll")
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_ACTION = "unselect"
			$O_OBJECT.document.execCommand("Unselect")
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_ACTION = "print"
			$O_OBJECT.document.parentwindow.Print()
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_ACTION = "printdefault"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEAction", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.execWB(6, 2)
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_ACTION = "back"
			If Not __IEISOBJTYPE($O_OBJECT, "documentContainer") Then
				__IEERRORNOTIFY("Error", "_IEAction", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.GoBack()
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_ACTION = "blur"
			$O_OBJECT.Blur()
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_ACTION = "forward"
			If Not __IEISOBJTYPE($O_OBJECT, "documentContainer") Then
				__IEERRORNOTIFY("Error", "_IEAction", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.GoForward()
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_ACTION = "home"
			If Not __IEISOBJTYPE($O_OBJECT, "documentContainer") Then
				__IEERRORNOTIFY("Error", "_IEAction", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.GoHome()
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_ACTION = "invisible"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEAction", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.visible = 0
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_ACTION = "visible"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEAction", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.visible = 1
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_ACTION = "search"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEAction", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.GoSearch()
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_ACTION = "stop"
			If Not __IEISOBJTYPE($O_OBJECT, "documentContainer") Then
				__IEERRORNOTIFY("Error", "_IEAction", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.Stop()
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_ACTION = "quit"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEAction", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.Quit()
			$O_OBJECT = 0
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case Else
			__IEERRORNOTIFY("Error", "_IEAction", "$_IEStatus_InvalidValue", "Invalid Action")
			SetError($_IESTATUS_INVALIDVALUE, 2)
			Return 0
	EndSelect
EndFunc


Func _IEPROPERTYGET(ByRef $O_OBJECT, $S_PROPERTY)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "browserdom") Then
		__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	Local $OTEMP, $ITEMP
	$S_PROPERTY = StringLower($S_PROPERTY)
	Select
		Case $S_PROPERTY = "browserx"
			If __IEISOBJTYPE($O_OBJECT, "browsercontainer") Or __IEISOBJTYPE($O_OBJECT, "document") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$OTEMP = $O_OBJECT
			$ITEMP = 0
			While IsObj($OTEMP)
				$ITEMP += $OTEMP.offsetLeft
				$OTEMP = $OTEMP.offsetParent
			WEnd
			SetError($_IESTATUS_SUCCESS)
			Return $ITEMP
		Case $S_PROPERTY = "browsery"
			If __IEISOBJTYPE($O_OBJECT, "browsercontainer") Or __IEISOBJTYPE($O_OBJECT, "document") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$OTEMP = $O_OBJECT
			$ITEMP = 0
			While IsObj($OTEMP)
				$ITEMP += $OTEMP.offsetTop
				$OTEMP = $OTEMP.offsetParent
			WEnd
			SetError($_IESTATUS_SUCCESS)
			Return $ITEMP
		Case $S_PROPERTY = "screenx"
			If __IEISOBJTYPE($O_OBJECT, "window") Or __IEISOBJTYPE($O_OBJECT, "document") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			If __IEISOBJTYPE($O_OBJECT, "browser") Then
				SetError($_IESTATUS_SUCCESS)
				Return $O_OBJECT.left()
			Else
				$OTEMP = $O_OBJECT
				$ITEMP = 0
				While IsObj($OTEMP)
					$ITEMP += $OTEMP.offsetLeft
					$OTEMP = $OTEMP.offsetParent
				WEnd
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $ITEMP + $O_OBJECT.document.parentWindow.screenLeft
		Case $S_PROPERTY = "screeny"
			If __IEISOBJTYPE($O_OBJECT, "window") Or __IEISOBJTYPE($O_OBJECT, "document") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			If __IEISOBJTYPE($O_OBJECT, "browser") Then
				SetError($_IESTATUS_SUCCESS)
				Return $O_OBJECT.top()
			Else
				$OTEMP = $O_OBJECT
				$ITEMP = 0
				While IsObj($OTEMP)
					$ITEMP += $OTEMP.offsetTop
					$OTEMP = $OTEMP.offsetParent
				WEnd
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $ITEMP + $O_OBJECT.document.parentWindow.screenTop
		Case $S_PROPERTY = "height"
			If __IEISOBJTYPE($O_OBJECT, "window") Or __IEISOBJTYPE($O_OBJECT, "document") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			If __IEISOBJTYPE($O_OBJECT, "browser") Then
				SetError($_IESTATUS_SUCCESS)
				Return $O_OBJECT.Height()
			Else
				SetError($_IESTATUS_SUCCESS)
				Return $O_OBJECT.offsetHeight
			EndIf
		Case $S_PROPERTY = "width"
			If __IEISOBJTYPE($O_OBJECT, "window") Or __IEISOBJTYPE($O_OBJECT, "document") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			If __IEISOBJTYPE($O_OBJECT, "browser") Then
				SetError($_IESTATUS_SUCCESS)
				Return $O_OBJECT.Width()
			Else
				SetError($_IESTATUS_SUCCESS)
				Return $O_OBJECT.offsetWidth
			EndIf
		Case $S_PROPERTY = "isdisabled"
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.isDisabled()
		Case $S_PROPERTY = "addressbar"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.AddressBar()
		Case $S_PROPERTY = "busy"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.Busy()
		Case $S_PROPERTY = "fullscreen"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.fullScreen()
		Case $S_PROPERTY = "hwnd"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return HWnd($O_OBJECT.HWnd())
		Case $S_PROPERTY = "left"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.Left()
		Case $S_PROPERTY = "locationname"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.LocationName()
		Case $S_PROPERTY = "locationurl"
			If __IEISOBJTYPE($O_OBJECT, "browser") Then
				SetError($_IESTATUS_SUCCESS)
				Return $O_OBJECT.locationURL()
			EndIf
			If __IEISOBJTYPE($O_OBJECT, "window") Then
				SetError($_IESTATUS_SUCCESS)
				Return $O_OBJECT.location.href()
			EndIf
			If __IEISOBJTYPE($O_OBJECT, "document") Then
				SetError($_IESTATUS_SUCCESS)
				Return $O_OBJECT.parentwindow.location.href()
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.document.parentwindow.location.href()
		Case $S_PROPERTY = "menubar"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.MenuBar()
		Case $S_PROPERTY = "offline"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.OffLine()
		Case $S_PROPERTY = "readystate"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.ReadyState()
		Case $S_PROPERTY = "resizable"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.Resizable()
		Case $S_PROPERTY = "silent"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.Silent()
		Case $S_PROPERTY = "statusbar"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.StatusBar()
		Case $S_PROPERTY = "statustext"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.StatusText()
		Case $S_PROPERTY = "top"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.Top()
		Case $S_PROPERTY = "visible"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.Visible()
		Case $S_PROPERTY = "appcodename"
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.document.parentWindow.top.navigator.appCodeName()
		Case $S_PROPERTY = "appminorversion"
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.document.parentWindow.top.navigator.appMinorVersion()
		Case $S_PROPERTY = "appname"
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.document.parentWindow.top.navigator.appName()
		Case $S_PROPERTY = "appversion"
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.document.parentWindow.top.navigator.appVersion()
		Case $S_PROPERTY = "browserlanguage"
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.document.parentWindow.top.navigator.browserLanguage()
		Case $S_PROPERTY = "cookieenabled"
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.document.parentWindow.top.navigator.cookieEnabled()
		Case $S_PROPERTY = "cpuclass"
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.document.parentWindow.top.navigator.cpuClass()
		Case $S_PROPERTY = "javaenabled"
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.document.parentWindow.top.navigator.javaEnabled()
		Case $S_PROPERTY = "online"
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.document.parentWindow.top.navigator.onLine()
		Case $S_PROPERTY = "platform"
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.document.parentWindow.top.navigator.platform()
		Case $S_PROPERTY = "systemlanguage"
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.document.parentWindow.top.navigator.systemLanguage()
		Case $S_PROPERTY = "useragent"
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.document.parentWindow.top.navigator.userAgent()
		Case $S_PROPERTY = "userlanguage"
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.document.parentWindow.top.navigator.userLanguage()
		Case $S_PROPERTY = "vcard"
			Local $AVCARD[1][29]
			$AVCARD[0][0] = "Business.City"
			$AVCARD[0][1] = "Business.Country"
			$AVCARD[0][2] = "Business.Fax"
			$AVCARD[0][3] = "Business.Phone"
			$AVCARD[0][4] = "Business.State"
			$AVCARD[0][5] = "Business.StreetAddress"
			$AVCARD[0][6] = "Business.URL"
			$AVCARD[0][7] = "Business.Zipcode"
			$AVCARD[0][8] = "Cellular"
			$AVCARD[0][9] = "Company"
			$AVCARD[0][10] = "Department"
			$AVCARD[0][11] = "DisplayName"
			$AVCARD[0][12] = "Email"
			$AVCARD[0][13] = "FirstName"
			$AVCARD[0][14] = "Gender"
			$AVCARD[0][15] = "Home.City"
			$AVCARD[0][16] = "Home.Country"
			$AVCARD[0][17] = "Home.Fax"
			$AVCARD[0][18] = "Home.Phone"
			$AVCARD[0][19] = "Home.State"
			$AVCARD[0][20] = "Home.StreetAddress"
			$AVCARD[0][21] = "Home.Zipcode"
			$AVCARD[0][22] = "Homepage"
			$AVCARD[0][23] = "JobTitle"
			$AVCARD[0][24] = "LastName"
			$AVCARD[0][25] = "MiddleName"
			$AVCARD[0][26] = "Notes"
			$AVCARD[0][27] = "Office"
			$AVCARD[0][28] = "Pager"
			For $I = 0 To 28
				$AVCARD[1][$I] = Execute('$o_object.document.parentWindow.top.navigator.userProfile.getAttribute("' & $AVCARD[0][$I] & '")')
			Next
			SetError($_IESTATUS_SUCCESS)
			Return $AVCARD
		Case $S_PROPERTY = "referrer"
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.document.referrer
		Case $S_PROPERTY = "theatermode"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.TheaterMode
		Case $S_PROPERTY = "toolbar"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.ToolBar
		Case $S_PROPERTY = "contenteditable"
			If __IEISOBJTYPE($O_OBJECT, "browser") Or __IEISOBJTYPE($O_OBJECT, "document") Then
				$OTEMP = $O_OBJECT.document.body
			Else
				$OTEMP = $O_OBJECT
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $OTEMP.isContentEditable
		Case $S_PROPERTY = "innertext"
			If __IEISOBJTYPE($O_OBJECT, "documentcontainer") Or __IEISOBJTYPE($O_OBJECT, "document") Then
				$OTEMP = $O_OBJECT.document.body
			Else
				$OTEMP = $O_OBJECT
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $OTEMP.innerText
		Case $S_PROPERTY = "outertext"
			If __IEISOBJTYPE($O_OBJECT, "documentcontainer") Or __IEISOBJTYPE($O_OBJECT, "document") Then
				$OTEMP = $O_OBJECT.document.body
			Else
				$OTEMP = $O_OBJECT
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $OTEMP.outerText
		Case $S_PROPERTY = "innerhtml"
			If __IEISOBJTYPE($O_OBJECT, "documentcontainer") Or __IEISOBJTYPE($O_OBJECT, "document") Then
				$OTEMP = $O_OBJECT.document.body
			Else
				$OTEMP = $O_OBJECT
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $OTEMP.innerHTML
		Case $S_PROPERTY = "outerhtml"
			If __IEISOBJTYPE($O_OBJECT, "documentcontainer") Or __IEISOBJTYPE($O_OBJECT, "document") Then
				$OTEMP = $O_OBJECT.document.body
			Else
				$OTEMP = $O_OBJECT
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return $OTEMP.outerHTML
		Case $S_PROPERTY = "title"
			SetError($_IESTATUS_SUCCESS)
			Return $O_OBJECT.document.title
		Case $S_PROPERTY = "uniqueid"
			If __IEISOBJTYPE($O_OBJECT, "window") Then
				__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			Else
				SetError($_IESTATUS_SUCCESS)
				Return $O_OBJECT.uniqueID
			EndIf
		Case Else
			__IEERRORNOTIFY("Error", "_IEPropertyGet", "$_IEStatus_InvalidValue", "Invalid Property")
			SetError($_IESTATUS_INVALIDVALUE, 2)
			Return 0
	EndSelect
EndFunc


Func _IEPROPERTYSET(ByRef $O_OBJECT, $S_PROPERTY, $NEWVALUE)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEPropertySet", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	Local $OTEMP
	#forceref $oTemp
	$S_PROPERTY = StringLower($S_PROPERTY)
	Select
		Case $S_PROPERTY = "addressbar"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertySet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.AddressBar = $NEWVALUE
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_PROPERTY = "height"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertySet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.Height = $NEWVALUE
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_PROPERTY = "left"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertySet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.Left = $NEWVALUE
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_PROPERTY = "menubar"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertySet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.MenuBar = $NEWVALUE
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_PROPERTY = "offline"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertySet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.OffLine = $NEWVALUE
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_PROPERTY = "resizable"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertySet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.Resizable = $NEWVALUE
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_PROPERTY = "statusbar"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertySet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.StatusBar = $NEWVALUE
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_PROPERTY = "statustext"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertySet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.StatusText = $NEWVALUE
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_PROPERTY = "top"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertySet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.Top = $NEWVALUE
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_PROPERTY = "width"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertySet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			$O_OBJECT.Width = $NEWVALUE
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_PROPERTY = "theatermode"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertySet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			If $NEWVALUE Then
				$O_OBJECT.TheaterMode = True
			Else
				$O_OBJECT.TheaterMode = False
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_PROPERTY = "toolbar"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertySet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			If $NEWVALUE Then
				$O_OBJECT.ToolBar = True
			Else
				$O_OBJECT.ToolBar = False
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_PROPERTY = "contenteditable"
			If __IEISOBJTYPE($O_OBJECT, "browser") Or __IEISOBJTYPE($O_OBJECT, "document") Then
				$OTEMP = $O_OBJECT.document.body
			Else
				$OTEMP = $O_OBJECT
			EndIf
			If $NEWVALUE Then
				$OTEMP.contentEditable = "true"
			Else
				$OTEMP.contentEditable = "false"
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_PROPERTY = "innertext"
			If __IEISOBJTYPE($O_OBJECT, "documentcontainer") Or __IEISOBJTYPE($O_OBJECT, "document") Then
				$OTEMP = $O_OBJECT.document.body
			Else
				$OTEMP = $O_OBJECT
			EndIf
			$OTEMP.innerText = $NEWVALUE
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_PROPERTY = "outertext"
			If __IEISOBJTYPE($O_OBJECT, "documentcontainer") Or __IEISOBJTYPE($O_OBJECT, "document") Then
				$OTEMP = $O_OBJECT.document.body
			Else
				$OTEMP = $O_OBJECT
			EndIf
			$OTEMP.outerText = $NEWVALUE
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_PROPERTY = "innerhtml"
			If __IEISOBJTYPE($O_OBJECT, "documentcontainer") Or __IEISOBJTYPE($O_OBJECT, "document") Then
				$OTEMP = $O_OBJECT.document.body
			Else
				$OTEMP = $O_OBJECT
			EndIf
			$OTEMP.innerHTML = $NEWVALUE
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_PROPERTY = "outerhtml"
			If __IEISOBJTYPE($O_OBJECT, "documentcontainer") Or __IEISOBJTYPE($O_OBJECT, "document") Then
				$OTEMP = $O_OBJECT.document.body
			Else
				$OTEMP = $O_OBJECT
			EndIf
			$OTEMP.outerHTML = $NEWVALUE
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_PROPERTY = "title"
			$O_OBJECT.document.title = $NEWVALUE
			SetError($_IESTATUS_SUCCESS)
			Return 1
		Case $S_PROPERTY = "silent"
			If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
				__IEERRORNOTIFY("Error", "_IEPropertySet", "$_IEStatus_InvalidObjectType")
				SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
				Return 0
			EndIf
			If $NEWVALUE Then
				$O_OBJECT.silent = True
			Else
				$O_OBJECT.silent = False
			EndIf
			SetError($_IESTATUS_SUCCESS)
			Return 0
		Case Else
			__IEERRORNOTIFY("Error", "_IEPropertySet", "$_IEStatus_InvalidValue", "Invalid Property")
			SetError($_IESTATUS_INVALIDVALUE, 2)
			Return 0
	EndSelect
EndFunc


Func _IEERRORNOTIFY($F_NOTIFY = -1)
	Switch Number($F_NOTIFY)
		Case (-1)
			Return $_IEERRORNOTIFY
		Case 0
			$_IEERRORNOTIFY = False
			Return 1
		Case 1
			$_IEERRORNOTIFY = True
			Return 1
		Case Else
			__IEERRORNOTIFY("Error", "_IEErrorNotify", "$_IEStatus_InvalidValue")
			Return 0
	EndSwitch
EndFunc


Func _IEERRORHANDLERREGISTER($S_FUNCTIONNAME = "__IEInternalErrorHandler")
	$SIEUSERERRORHANDLER = $S_FUNCTIONNAME
	$OIEERRORHANDLER = ""
	$OIEERRORHANDLER = ObjEvent("AutoIt.Error", $S_FUNCTIONNAME)
	If IsObj($OIEERRORHANDLER) Then
		SetError($_IESTATUS_SUCCESS)
		Return 1
	Else
		__IEERRORNOTIFY("Error", "_IEPropertySet", "$_IEStatus_GeneralError", "Error Handler Not Registered - Check existance of error function")
		SetError($_IESTATUS_GENERALERROR, 1)
		Return 0
	EndIf
EndFunc


Func _IEERRORHANDLERDEREGISTER()
	$SIEUSERERRORHANDLER = ""
	$OIEERRORHANDLER = ""
	SetError($_IESTATUS_SUCCESS)
	Return 1
EndFunc


Func _IEQUIT(ByRef $O_OBJECT)
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "_IEQuit", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "browser") Then
		__IEERRORNOTIFY("Error", "_IEAction", "$_IEStatus_InvalidObjectType")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	SetError($_IESTATUS_SUCCESS)
	$O_OBJECT.quit()
	$O_OBJECT = 0
	Return 1
EndFunc

#endregion Utility functions
#region General

Func _IE_INTRODUCTION($S_MODULE = "basic")
	Local $S_HTML
	Switch $S_MODULE
		Case "basic"
			$S_HTML &= "<HTML>" & @CR
			$S_HTML &= "<HEAD>" & @CR
			$S_HTML &= "<TITLE>_IE_Introduction ('basic')</TITLE>" & @CR
			$S_HTML &= "<STYLE>body {font-family: Arial}</STYLE>" & @CR
			$S_HTML &= "</HEAD>" & @CR
			$S_HTML &= "<BODY>" & @CR
			$S_HTML &= "<table border=1 width=600 id='table1' cellspacing=6 cellpadding=6>" & @CR
			$S_HTML &= "<tr>" & @CR
			$S_HTML &= "<td>" & @CR
			$S_HTML &= "<h1>Welcome to IE.au3</h1>" & @CR
			$S_HTML &= "IE.au3 is a UDF (User Defined Function) library for the " & @CR
			$S_HTML &= "<a href='http://www.autoitscript.com'>AutoIt</a> scripting language." & @CR
			$S_HTML &= "<p>  " & @CR
			$S_HTML &= "IE.au3 allows you to either create or attach to an Internet Explorer browser and do " & @CR
			$S_HTML &= "just about anything you could do with it interactively with the mouse and " & @CR
			$S_HTML &= "keyboard, but do it through script." & @CR
			$S_HTML &= "<p>" & @CR
			$S_HTML &= "You can navigate to pages, click links, fill and submit forms etc. You can " & @CR
			$S_HTML &= "also do things you cannot do interactively like change or rewrite page " & @CR
			$S_HTML &= "content and JavaScripts, read, parse and save page content and monitor and act " & @CR
			$S_HTML &= "upon browser 'events'.<p>" & @CR
			$S_HTML &= "IE.au3 uses the COM interface in AutoIt to interact with the Internet Explorer " & @CR
			$S_HTML &= "object model and the DOM (Document Object Model) supported by the browser." & @CR
			$S_HTML &= "<p>" & @CR
			$S_HTML &= "Here are some links for more information and helpful tools:<p>" & @CR
			$S_HTML &= "Reference Material: " & @CR
			$S_HTML &= "<ul>" & @CR
			$S_HTML &= "<li><a href='http://msdn1.microsoft.com/'>MSDN (Microsoft Developer Network)</a></li>" & @CR
			$S_HTML &= "<li><a href='http://msdn2.microsoft.com/en-us/library/aa752084.aspx' target='_blank'>InternetExplorer Object</a></li>" & @CR
			$S_HTML &= "<li><a href='http://msdn2.microsoft.com/en-us/library/ms531073.aspx' target='_blank'>Document Object</a></li>" & @CR
			$S_HTML &= "<li><a href='http://msdn2.microsoft.com/en-us/ie/aa740473.aspx' target='_blank'>Overviews and Tutorials</a></li>" & @CR
			$S_HTML &= "<li><a href='http://msdn2.microsoft.com/en-us/library/ms533029.aspx' target='_blank'>DHTML Objects</a></li>" & @CR
			$S_HTML &= "<li><a href='http://msdn2.microsoft.com/en-us/library/ms533051.aspx' target='_blank'>DHTML Events</a></li>" & @CR
			$S_HTML &= "</ul><p>" & @CR
			$S_HTML &= "Helpful Tools: " & @CR
			$S_HTML &= "<ul>" & @CR
			$S_HTML &= "<li><a href='http://www.autoitscript.com/forum/index.php?showtopic=19368' target='_blank'>AutoIt IE Builder</a> (build IE scripts interactively)</li>" & @CR
			$S_HTML &= "<li><a href='http://www.debugbar.com/' target='_blank'>DebugBar</a> (DOM inspector, HTTP inspector, HTML validator and more - free for personal use) Recommended</li>" & @CR
			$S_HTML &= "<li><a href='http://www.microsoft.com/downloads/details.aspx?FamilyID=e59c3964-672d-4511-bb3e-2d5e1db91038&amp;displaylang=en' target='_blank'>IE Developer Toolbar</a> (comprehensive DOM analysis tool)</li>" & @CR
			$S_HTML &= "<li><a href='http://slayeroffice.com/tools/modi/v2.0/modi_help.html' target='_blank'>MODIV2</a> (view the DOM of a web page by mousing around)</li>" & @CR
			$S_HTML &= "<li><a href='http://validator.w3.org/' target='_blank'>HTML Validator</a> (verify HTML follows format rules)</li>" & @CR
			$S_HTML &= "<li><a href='http://www.fiddlertool.com/fiddler/' target='_blank'>Fiddler</a> (examine HTTP traffic)</li>" & @CR
			$S_HTML &= "</ul>" & @CR
			$S_HTML &= "</td>" & @CR
			$S_HTML &= "</tr>" & @CR
			$S_HTML &= "</table>" & @CR
			$S_HTML &= "</BODY>" & @CR
			$S_HTML &= "</HTML>"
		Case Else
			__IEERRORNOTIFY("Error", "_IE_Introduction", "$_IEStatus_InvalidValue")
			SetError($_IESTATUS_INVALIDVALUE, 1)
			Return 0
	EndSwitch
	Local $O_OBJECT = _IECREATE()
	_IEDOCWRITEHTML($O_OBJECT, $S_HTML)
	SetError($_IESTATUS_SUCCESS)
	Return $O_OBJECT
EndFunc


Func _IE_EXAMPLE($S_MODULE = "basic")
	Local $S_HTML = "", $O_OBJECT
	Switch $S_MODULE
		Case "basic"
			$S_HTML &= "<HEAD>" & @CR
			$S_HTML &= "<TITLE>_IE_Example('basic')</TITLE>" & @CR
			$S_HTML &= "<STYLE>body {font-family: Arial}</STYLE>" & @CR
			$S_HTML &= "</HEAD>" & @CR
			$S_HTML &= "<BODY>" & @CR
			$S_HTML &= "<a href='http://www.autoitscript.com'><img src='http://www.autoitscript.com/images/autoit_6_240x100.jpg' name='AutoItImage' alt='AutoIt Homepage Image'></a>" & @CR
			$S_HTML &= "<p>" & @CR
			$S_HTML &= "<div id=line1>This is a simple HTML page with text, links and images.</div>" & @CR
			$S_HTML &= "<p>" & @CR
			$S_HTML &= "<div id=line2><a href='http://www.autoitscript.com'>AutoIt</a> is a wonderful automation scripting language.</div>" & @CR
			$S_HTML &= "<p>" & @CR
			$S_HTML &= "<div id=line3>It is supported by a very active and supporting <a href='http://www.autoitscript.com/forum/'>user forum</a>.</div>" & @CR
			$S_HTML &= "<p>" & @CR
			$S_HTML &= "<div id=IEAu3Data></div>" & @CR
			$S_HTML &= "</BODY>" & @CR
			$S_HTML &= "</HTML>"
			$O_OBJECT = _IECREATE()
			_IEDOCWRITEHTML($O_OBJECT, $S_HTML)
		Case "table"
			$S_HTML &= "<HTML>" & @CR
			$S_HTML &= "<HEAD>" & @CR
			$S_HTML &= "<TITLE>_IE_Example('table')</TITLE>" & @CR
			$S_HTML &= "<STYLE>body {font-family: Arial}</STYLE>" & @CR
			$S_HTML &= "</HEAD>" & @CR
			$S_HTML &= "<BODY>" & @CR
			$S_HTML &= "$oTableOne = _IETableGetObjByName($oIE, &quot;tableOne&quot;)<br>" & @CR
			$S_HTML &= "&lt;table border=1 id='tableOne'&gt;<p>" & @CR
			$S_HTML &= "<table border=1 id='tableOne'>" & @CR
			$S_HTML &= "	<tr>" & @CR
			$S_HTML &= "		<td>AutoIt</td>" & @CR
			$S_HTML &= "		<td>is</td>" & @CR
			$S_HTML &= "		<td>really</td>" & @CR
			$S_HTML &= "		<td>great</td>" & @CR
			$S_HTML &= "		<td>with</td>" & @CR
			$S_HTML &= "		<td>IE.au3</td>" & @CR
			$S_HTML &= "	</tr>" & @CR
			$S_HTML &= "	<tr>" & @CR
			$S_HTML &= "		<td>1</td>" & @CR
			$S_HTML &= "		<td>2</td>" & @CR
			$S_HTML &= "		<td>3</td>" & @CR
			$S_HTML &= "		<td>4</td>" & @CR
			$S_HTML &= "		<td>5</td>" & @CR
			$S_HTML &= "		<td>6</td>" & @CR
			$S_HTML &= "	</tr>" & @CR
			$S_HTML &= "	<tr>" & @CR
			$S_HTML &= "		<td>the</td>" & @CR
			$S_HTML &= "		<td>quick</td>" & @CR
			$S_HTML &= "		<td>red</td>" & @CR
			$S_HTML &= "		<td>fox</td>" & @CR
			$S_HTML &= "		<td>jumped</td>" & @CR
			$S_HTML &= "		<td>over</td>" & @CR
			$S_HTML &= "	</tr>" & @CR
			$S_HTML &= "	<tr>" & @CR
			$S_HTML &= "		<td>the</td>" & @CR
			$S_HTML &= "		<td>lazy</td>" & @CR
			$S_HTML &= "		<td>brown</td>" & @CR
			$S_HTML &= "		<td>dog</td>" & @CR
			$S_HTML &= "		<td>the</td>" & @CR
			$S_HTML &= "		<td>time</td>" & @CR
			$S_HTML &= "	</tr>" & @CR
			$S_HTML &= "	<tr>" & @CR
			$S_HTML &= "		<td>has</td>" & @CR
			$S_HTML &= "		<td>come</td>" & @CR
			$S_HTML &= "		<td>for</td>" & @CR
			$S_HTML &= "		<td>all</td>" & @CR
			$S_HTML &= "		<td>good</td>" & @CR
			$S_HTML &= "		<td>men</td>" & @CR
			$S_HTML &= "	</tr>" & @CR
			$S_HTML &= "	<tr>" & @CR
			$S_HTML &= "		<td>to</td>" & @CR
			$S_HTML &= "		<td>come</td>" & @CR
			$S_HTML &= "		<td>to</td>" & @CR
			$S_HTML &= "		<td>the</td>" & @CR
			$S_HTML &= "		<td>aid</td>" & @CR
			$S_HTML &= "		<td>of</td>" & @CR
			$S_HTML &= "	</tr>" & @CR
			$S_HTML &= "</table>" & @CR
			$S_HTML &= "<p>" & @CR
			$S_HTML &= "$oTableTwo = _IETableGetObjByName($oIE, &quot;tableTwo&quot;)<br>" & @CR
			$S_HTML &= "&lt;table border=&quot;1&quot; id='tableTwo'&gt;<p>" & @CR
			$S_HTML &= "<table border=1 id='tableTwo'>" & @CR
			$S_HTML &= "	<tr>" & @CR
			$S_HTML &= "		<td colspan='4'>Table Top</td>" & @CR
			$S_HTML &= "	</tr>" & @CR
			$S_HTML &= "	<tr>" & @CR
			$S_HTML &= "		<td>One</td>" & @CR
			$S_HTML &= "		<td colspan='3'>Two</td>" & @CR
			$S_HTML &= "	</tr>" & @CR
			$S_HTML &= "	<tr>" & @CR
			$S_HTML &= "		<td>Three</td>" & @CR
			$S_HTML &= "		<td>Four</td>" & @CR
			$S_HTML &= "		<td colspan='2'>Five</td>" & @CR
			$S_HTML &= "	</tr>" & @CR
			$S_HTML &= "	<tr>" & @CR
			$S_HTML &= "		<td>Six</td>" & @CR
			$S_HTML &= "		<td colspan='3'>Seven</td>" & @CR
			$S_HTML &= "	</tr>" & @CR
			$S_HTML &= "	<tr>" & @CR
			$S_HTML &= "		<td>Eight</td>" & @CR
			$S_HTML &= "		<td>Nine</td>" & @CR
			$S_HTML &= "		<td>Ten</td>" & @CR
			$S_HTML &= "		<td>Eleven</td>" & @CR
			$S_HTML &= "	</tr>" & @CR
			$S_HTML &= "</table>" & @CR
			$S_HTML &= "</BODY>" & @CR
			$S_HTML &= "</HTML>"
			$O_OBJECT = _IECREATE()
			_IEDOCWRITEHTML($O_OBJECT, $S_HTML)
		Case "form"
			$S_HTML &= "<HTML>" & @CR
			$S_HTML &= "<HEAD>" & @CR
			$S_HTML &= "<TITLE>_IE_Example('form')</TITLE>" & @CR
			$S_HTML &= "<STYLE>body {font-family: Arial}</STYLE>" & @CR
			$S_HTML &= "</HEAD>" & @CR
			$S_HTML &= "<BODY>" & @CR
			$S_HTML &= "<form name='ExampleForm' onSubmit='javascript:alert(""ExampleFormSubmitted"");' method='post'>" & @CR
			$S_HTML &= "<table cellspacing=6 cellpadding=6 border=1>" & @CR
			$S_HTML &= "<tr>" & @CR
			$S_HTML &= "<td>ExampleForm</td>" & @CR
			$S_HTML &= "<td>&lt;form name='ExampleForm' onSubmit='javascript:alert(""ExampleFormSubmitted"");' method='post'&gt;</td>" & @CR
			$S_HTML &= "</tr>" & @CR
			$S_HTML &= "<tr>" & @CR
			$S_HTML &= "<td>Hidden Input Element<input type='hidden' name='hiddenExample' value='secret value'></td>" & @CR
			$S_HTML &= "<td>&lt;input type='hidden' name='hiddenExample' value='secret value'&gt;</td>" & @CR
			$S_HTML &= "</tr>" & @CR
			$S_HTML &= "<tr>" & @CR
			$S_HTML &= "<td>" & @CR
			$S_HTML &= "<input type='text' name='textExample' value='http://' size='20' maxlength='30'>" & @CR
			$S_HTML &= "</td>" & @CR
			$S_HTML &= "<td>&lt;input type='text' name='textExample' value='http://' size='20' maxlength='30'&gt;</td>" & @CR
			$S_HTML &= "</tr>" & @CR
			$S_HTML &= "<tr>" & @CR
			$S_HTML &= "<td>" & @CR
			$S_HTML &= "<input type='password' name='passwordExample' size='10'>" & @CR
			$S_HTML &= "</td>" & @CR
			$S_HTML &= "<td>&lt;input type='password' name='passwordExample' size='10'&gt;</td>" & @CR
			$S_HTML &= "</tr>" & @CR
			$S_HTML &= "<tr>" & @CR
			$S_HTML &= "<td>" & @CR
			$S_HTML &= "<input type='file' name='fileExample'>" & @CR
			$S_HTML &= "</td>" & @CR
			$S_HTML &= "<td>&lt;input type='file' name='fileExample'&gt;</td>" & @CR
			$S_HTML &= "</tr>" & @CR
			$S_HTML &= "<tr>" & @CR
			$S_HTML &= "<td>" & @CR
			$S_HTML &= "<input type='image' name='imageExample' alt='AutoIt Homepage' src='http://www.autoitscript.com/images/autoit_6_240x100.jpg'>" & @CR
			$S_HTML &= "</td>" & @CR
			$S_HTML &= "<td>&lt;input type='image' name='imageExample' alt='AutoIt Homepage' src='http://www.autoitscript.com/images/autoit_6_240x100.jpg'&gt;</td>" & @CR
			$S_HTML &= "</tr>" & @CR
			$S_HTML &= "<tr>" & @CR
			$S_HTML &= "<td>" & @CR
			$S_HTML &= "<textarea name='textareaExample' rows='5' cols='15'>Hello!</textarea>" & @CR
			$S_HTML &= "</td>" & @CR
			$S_HTML &= "<td>&lt;textarea name='textareaExample' rows='5' cols='15'&gt;Hello!&lt;/textarea&gt;</td>" & @CR
			$S_HTML &= "</tr>" & @CR
			$S_HTML &= "<tr>" & @CR
			$S_HTML &= "<td>" & @CR
			$S_HTML &= "<input type='checkbox' name='checkboxG1Example' value='gameBasketball'>Basketball<br>" & @CR
			$S_HTML &= "<input type='checkbox' name='checkboxG1Example' value='gameFootball'>Football<br>" & @CR
			$S_HTML &= "<input type='checkbox' name='checkboxG2Example' value='gameTennis' checked>Tennis<br>" & @CR
			$S_HTML &= "<input type='checkbox' name='checkboxG2Example' value='gameBaseball'>Baseball" & @CR
			$S_HTML &= "</td>" & @CR
			$S_HTML &= "<td>&lt;input type='checkbox' name='checkboxG1Example' value='gameBasketball'&gt;Basketball&lt;br&gt;<br>" & @CR
			$S_HTML &= "&lt;input type='checkbox' name='checkboxG1Example' value='gameFootball'&gt;Football&lt;br&gt;<br>" & @CR
			$S_HTML &= "&lt;input type='checkbox' name='checkboxG2Example' value='gameTennis' checked&gt;Tennis&lt;br&gt;<br>" & @CR
			$S_HTML &= "&lt;input type='checkbox' name='checkboxG2Example' value='gameBaseball'&gt;Baseball</td>" & @CR
			$S_HTML &= "</tr>" & @CR
			$S_HTML &= "<tr>" & @CR
			$S_HTML &= "<td>" & @CR
			$S_HTML &= "<input type='radio' name='radioExample' value='vehicleAirplane'>Airplane<br>" & @CR
			$S_HTML &= "<input type='radio' name='radioExample' value='vehicleTrain' checked>Train<br>" & @CR
			$S_HTML &= "<input type='radio' name='radioExample' value='vehicleBoat'>Boat<br>" & @CR
			$S_HTML &= "<input type='radio' name='radioExample' value='vehicleCar'>Car</td>" & @CR
			$S_HTML &= "<td>&lt;input type='radio' name='radioExample' value='vehicleAirplane'&gt;Airplane&lt;br&gt;<br>" & @CR
			$S_HTML &= "&lt;input type='radio' name='radioExample' value='vehicleTrain' checked&gt;Train&lt;br&gt;<br>" & @CR
			$S_HTML &= "&lt;input type='radio' name='radioExample' value='vehicleBoat'&gt;Boat&lt;br&gt;<br>" & @CR
			$S_HTML &= "&lt;input type='radio' name='radioExample' value='vehicleCar'&gt;Car&lt;br&gt;</td>" & @CR
			$S_HTML &= "</tr>" & @CR
			$S_HTML &= "<tr>" & @CR
			$S_HTML &= "<td>" & @CR
			$S_HTML &= "<select name='selectExample'>" & @CR
			$S_HTML &= "<option value='homepage.html'>Homepage" & @CR
			$S_HTML &= "<option value='midipage.html'>Midipage" & @CR
			$S_HTML &= "<option value='freepage.html'>Freepage" & @CR
			$S_HTML &= "</select>" & @CR
			$S_HTML &= "</td>" & @CR
			$S_HTML &= "<td>&lt;select name='selectExample'&gt;<br>" & @CR
			$S_HTML &= "&lt;option value='homepage.html'&gt;Homepage<br>" & @CR
			$S_HTML &= "&lt;option value='midipage.html'&gt;Midipage<br>" & @CR
			$S_HTML &= "&lt;option value='freepage.html'&gt;Freepage<br>" & @CR
			$S_HTML &= "&lt;/select&gt;</td>" & @CR
			$S_HTML &= "</tr>" & @CR
			$S_HTML &= "<tr>" & @CR
			$S_HTML &= "<td>" & @CR
			$S_HTML &= "<select name='multipleSelectExample' size='6' multiple>" & @CR
			$S_HTML &= "<option value='Name1'>Aaron" & @CR
			$S_HTML &= "<option value='Name2'>Bruce" & @CR
			$S_HTML &= "<option value='Name3'>Carlos" & @CR
			$S_HTML &= "<option value='Name4'>Denis" & @CR
			$S_HTML &= "<option value='Name5'>Ed" & @CR
			$S_HTML &= "<option value='Name6'>Freddy" & @CR
			$S_HTML &= "</select>" & @CR
			$S_HTML &= "</td>" & @CR
			$S_HTML &= "<td>&lt;select name='multipleSelectExample' size='6' multiple&gt;<br>" & @CR
			$S_HTML &= "&lt;option value='Name1'&gt;Aaron<br>" & @CR
			$S_HTML &= "&lt;option value='Name2'&gt;Bruce<br>" & @CR
			$S_HTML &= "&lt;option value='Name3'&gt;Carlos<br>" & @CR
			$S_HTML &= "&lt;option value='Name4'&gt;Denis<br>" & @CR
			$S_HTML &= "&lt;option value='Name5'&gt;Ed<br>" & @CR
			$S_HTML &= "&lt;option value='Name6'&gt;Freddy<br>" & @CR
			$S_HTML &= "&lt;/select&gt;</td>" & @CR
			$S_HTML &= "</tr>" & @CR
			$S_HTML &= "<tr>" & @CR
			$S_HTML &= "<td>" & @CR
			$S_HTML &= "<input name='submitExample' type='submit' value='Submit'>" & @CR
			$S_HTML &= "<input name='resetExample' type='reset' value='Reset'>" & @CR
			$S_HTML &= "</td>" & @CR
			$S_HTML &= "<td>&lt;input name='submitExample' type='submit' value='Submit'&gt;<br>" & @CR
			$S_HTML &= "&lt;input name='resetExample' type='reset' value='Reset'&gt;</td>" & @CR
			$S_HTML &= "</tr>" & @CR
			$S_HTML &= "</table>" & @CR
			$S_HTML &= "<input type='hidden' name='hiddenExample' value='secret value'>" & @CR
			$S_HTML &= "</FORM>" & @CR
			$S_HTML &= "</BODY>" & @CR
			$S_HTML &= "</HTML>"
			$O_OBJECT = _IECREATE()
			_IEDOCWRITEHTML($O_OBJECT, $S_HTML)
		Case "frameset"
			$S_HTML &= "<HTML>" & @CR
			$S_HTML &= "<HEAD>" & @CR
			$S_HTML &= "<TITLE>_IE_Example('frameset')</TITLE>" & @CR
			$S_HTML &= "</HEAD>" & @CR
			$S_HTML &= "<FRAMESET rows='25,200'>" & @CR
			$S_HTML &= "	<FRAME NAME=Top SRC=about:blank>" & @CR
			$S_HTML &= "	<FRAMESET cols='100,500'>" & @CR
			$S_HTML &= "		<FRAME NAME=Menu SRC=about:blank>" & @CR
			$S_HTML &= "		<FRAME NAME=Main SRC=about:blank>" & @CR
			$S_HTML &= "	</FRAMESET>" & @CR
			$S_HTML &= "</FRAMESET>" & @CR
			$S_HTML &= "</HTML>"
			$O_OBJECT = _IECREATE()
			_IEDOCWRITEHTML($O_OBJECT, $S_HTML)
			_IEACTION($O_OBJECT, "refresh")
			Local $OFRAMETOP = _IEFRAMEGETOBJBYNAME($O_OBJECT, "Top")
			Local $OFRAMEMENU = _IEFRAMEGETOBJBYNAME($O_OBJECT, "Menu")
			Local $OFRAMEMAIN = _IEFRAMEGETOBJBYNAME($O_OBJECT, "Main")
			_IEBODYWRITEHTML($OFRAMETOP, '$oFrameTop = _IEFrameGetObjByName($oIE, "Top")')
			_IEBODYWRITEHTML($OFRAMEMENU, '$oFrameMenu = _IEFrameGetObjByName($oIE, "Menu")')
			_IEBODYWRITEHTML($OFRAMEMAIN, '$oFrameMain = _IEFrameGetObjByName($oIE, "Main")')
		Case "iframe"
			$S_HTML &= "<HTML>" & @CR
			$S_HTML &= "<HEAD>" & @CR
			$S_HTML &= "<TITLE>_IE_Example('iframe')</TITLE>" & @CR
			$S_HTML &= "</HEAD>" & @CR
			$S_HTML &= "<BODY>" & @CR
			$S_HTML &= "<table cellspacing=6 cellpadding=6 border=1>" & @CR
			$S_HTML &= "<tr>" & @CR
			$S_HTML &= "<td><iframe name='iFrameOne' src='about:blank' title='iFrameOne'></iframe></td>" & @CR
			$S_HTML &= "<td>&lt;iframe name=&quot;iFrameOne&quot; src=&quot;about:blank&quot; title=&quot;iFrameOne&quot;&gt;</td>" & @CR
			$S_HTML &= "</tr>" & @CR
			$S_HTML &= "<tr>" & @CR
			$S_HTML &= "<td><iframe name='iFrameTwo' src='about:blank' title='iFrameTwo'></iframe></td>" & @CR
			$S_HTML &= "<td>&lt;iframe name=&quot;iFrameTwo&quot; src=&quot;about:blank&quot; title=&quot;iFrameTwo&quot;&gt;</td>" & @CR
			$S_HTML &= "</tr>" & @CR
			$S_HTML &= "</table>" & @CR
			$S_HTML &= "</BODY>" & @CR
			$S_HTML &= "</HTML>"
			$O_OBJECT = _IECREATE()
			_IEDOCWRITEHTML($O_OBJECT, $S_HTML)
			_IEACTION($O_OBJECT, "refresh")
			Local $OIFRAMEONE = _IEFRAMEGETOBJBYNAME($O_OBJECT, "iFrameOne")
			Local $OIFRAMETWO = _IEFRAMEGETOBJBYNAME($O_OBJECT, "iFrameTwo")
			_IEBODYWRITEHTML($OIFRAMEONE, '$oIFrameOne = _IEFrameGetObjByName($oIE, "iFrameOne")')
			_IEBODYWRITEHTML($OIFRAMETWO, '$oIFrameTwo = _IEFrameGetObjByName($oIE, "iFrameTwo")')
		Case Else
			__IEERRORNOTIFY("Error", "_IE_Example", "$_IEStatus_InvalidValue")
			SetError($_IESTATUS_INVALIDVALUE, 1)
			Return 0
	EndSwitch
	SetError($_IESTATUS_SUCCESS)
	Return $O_OBJECT
EndFunc


Func _IE_VERSIONINFO()
	__IEERRORNOTIFY("Information", "_IE_VersionInfo", "version " & $IEAU3VERSIONINFO[0] & $IEAU3VERSIONINFO[1] & "." & $IEAU3VERSIONINFO[2] & "-" & $IEAU3VERSIONINFO[3], "Release date: " & $IEAU3VERSIONINFO[4])
	SetError($_IESTATUS_SUCCESS)
	Return $IEAU3VERSIONINFO
EndFunc

#endregion General
#region Internal functions

Func __IELOCKSETFOREGROUNDWINDOW($NLOCKCODE)
	Local $ARET = DllCall("user32.dll", "int", "LockSetForegroundWindow", "int", $NLOCKCODE)
	If @error Then
		SetError(@error, @extended)
		Return False
	EndIf
	Return $ARET[0]
EndFunc


Func __IECONTROLGETOBJFROMHWND(ByRef $HWIN)
	DllCall("ole32.dll", "int", "CoInitialize", "ptr", 0)
	Local Const $WM_HTML_GETOBJECT = __IEREGISTERWINDOWMESSAGE("WM_HTML_GETOBJECT")
	Local Const $SMTO_ABORTIFHUNG = 2
	Local $LRESULT, $TYPUUID, $ARET, $OIE
	__IESENDMESSAGETIMEOUT($HWIN, $WM_HTML_GETOBJECT, 0, 0, $SMTO_ABORTIFHUNG, 1000, $LRESULT)
	$TYPUUID = DllStructCreate("int;short;short;byte[8]")
	DllStructSetData($TYPUUID, 1, 1651492128)
	DllStructSetData($TYPUUID, 2, 42014)
	DllStructSetData($TYPUUID, 3, 4559)
	DllStructSetData($TYPUUID, 4, 167, 1)
	DllStructSetData($TYPUUID, 4, 49, 2)
	DllStructSetData($TYPUUID, 4, 0, 3)
	DllStructSetData($TYPUUID, 4, 160, 4)
	DllStructSetData($TYPUUID, 4, 201, 5)
	DllStructSetData($TYPUUID, 4, 8, 6)
	DllStructSetData($TYPUUID, 4, 38, 7)
	DllStructSetData($TYPUUID, 4, 55, 8)
	$ARET = DllCall("oleacc.dll", "long", "ObjectFromLresult", "lresult", $LRESULT, "ptr", DllStructGetPtr($TYPUUID), "wparam", 0, "idispatch*", 0)
	If IsObj($ARET[4]) Then
		$OIE = $ARET[4] .Script()
		Return $OIE.Document.parentwindow
	Else
		SetError(1)
		Return 0
	EndIf
EndFunc


Func __IEREGISTERWINDOWMESSAGE($SMSG)
	Local $ARET = DllCall("user32.dll", "int", "RegisterWindowMessage", "str", $SMSG)
	If @error Then Return SetError(@error, @extended, 0)
	Return $ARET[0]
EndFunc


Func __IESENDMESSAGETIMEOUT($HWND, $MSG, $WPARAM, $LPARAM, $NFLAGS, $NTIMEOUT, ByRef $VOUT, $R = 0, $T1 = "int", $T2 = "int")
	Local $ARET
	$ARET = DllCall("user32.dll", "long", "SendMessageTimeout", "hwnd", $HWND, "int", $MSG, $T1, $WPARAM, $T2, $LPARAM, "int", $NFLAGS, "int", $NTIMEOUT, "int*", "")
	If @error Then
		$VOUT = 0
		Return SetError(@error, @extended, 0)
	EndIf
	$VOUT = $ARET[7]
	If $R >= 0 And $R <= 4 Then Return $ARET[$R]
	Return $ARET
EndFunc


Func __IEISOBJTYPE(ByRef $O_OBJECT, $S_TYPE)
	If Not IsObj($O_OBJECT) Then
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	Local $STATUS = __IEINTERNALERRORHANDLERREGISTER()
	If Not $STATUS Then __IEERRORNOTIFY("Warning", "internal function __IEIsObjType", "Cannot register internal error handler, cannot trap COM errors", "Use _IEErrorHandlerRegister() to register a user error handler")
	Local $F_NOTIFYSTATUS = _IEERRORNOTIFY()
	_IEERRORNOTIFY(False)
	Local $S_NAME = String(ObjName($O_OBJECT)), $OBJECTOK = False, $OTEMP
	Switch $S_TYPE
		Case "browserdom"
			$OTEMP = $O_OBJECT.document
			If __IEISOBJTYPE($O_OBJECT, "documentcontainer") Then
				$OBJECTOK = True
			ElseIf __IEISOBJTYPE($O_OBJECT, "document") Then
				$OBJECTOK = True
			ElseIf __IEISOBJTYPE($OTEMP, "document") Then
				$OBJECTOK = True
			EndIf
		Case "browser"
			If ($S_NAME = "IWebBrowser2") Or ($S_NAME = "IWebBrowser") Then $OBJECTOK = True
		Case "window"
			If $S_NAME = "DispHTMLWindow2" Then $OBJECTOK = True
		Case "documentContainer"
			If __IEISOBJTYPE($O_OBJECT, "window") Or __IEISOBJTYPE($O_OBJECT, "browser") Then $OBJECTOK = True
		Case "document"
			If $S_NAME = "DispHTMLDocument" Then $OBJECTOK = True
		Case "table"
			If $S_NAME = "DispHTMLTable" Then $OBJECTOK = True
		Case "form"
			If $S_NAME = "DispHTMLFormElement" Then $OBJECTOK = True
		Case "forminputelement"
			If ($S_NAME = "DispHTMLInputElement") Or ($S_NAME = "DispHTMLSelectElement") Or ($S_NAME = "DispHTMLTextAreaElement") Then $OBJECTOK = True
		Case "elementcollection"
			If ($S_NAME = "DispHTMLElementCollection") Then $OBJECTOK = True
		Case "formselectelement"
			If $S_NAME = "DispHTMLSelectElement" Then $OBJECTOK = True
		Case Else
			SetError($_IESTATUS_INVALIDVALUE, 2)
			Return 0
	EndSwitch
	_IEERRORNOTIFY($F_NOTIFYSTATUS)
	__IEINTERNALERRORHANDLERDEREGISTER()
	If $OBJECTOK Then
		SetError($_IESTATUS_SUCCESS)
		Return 1
	Else
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
EndFunc


Func __IEERRORNOTIFY($S_SEVERITY, $S_FUNC, $S_STATUS = "", $S_MESSAGE = "")
	If $_IEERRORNOTIFY Or $__IEAU3DEBUG Then
		Local $SSTR = "--> IE.au3 " & $IEAU3VERSIONINFO[5] & " " & $S_SEVERITY & " from function " & $S_FUNC
		If Not String($S_STATUS) = "" Then $SSTR &= ", " & $S_STATUS
		If Not String($S_MESSAGE) = "" Then $SSTR &= " (" & $S_MESSAGE & ")"
		ConsoleWrite($SSTR & @CR)
	EndIf
	Return 1
EndFunc


Func __IEINTERNALERRORHANDLERREGISTER()
	Local $SCURRENTERRORHANDLER = ObjEvent("AutoIt.Error")
	If $SCURRENTERRORHANDLER <> "" And Not IsObj($OIEERRORHANDLER) Then
		SetError($_IESTATUS_GENERALERROR)
		Return 0
	EndIf
	$OIEERRORHANDLER = ""
	$OIEERRORHANDLER = ObjEvent("AutoIt.Error", "__IEInternalErrorHandler")
	If IsObj($OIEERRORHANDLER) Then
		SetError($_IESTATUS_SUCCESS)
		Return 1
	Else
		SetError($_IESTATUS_GENERALERROR)
		Return 0
	EndIf
EndFunc


Func __IEINTERNALERRORHANDLERDEREGISTER()
	$OIEERRORHANDLER = ""
	If $SIEUSERERRORHANDLER <> "" Then
		$OIEERRORHANDLER = ObjEvent("AutoIt.Error", $SIEUSERERRORHANDLER)
	EndIf
	SetError($_IESTATUS_SUCCESS)
	Return 1
EndFunc


Func __IEINTERNALERRORHANDLER()
	$IECOMERRORSCRIPTLINE = $OIEERRORHANDLER.scriptline
	$IECOMERRORNUMBER = $OIEERRORHANDLER.number
	$IECOMERRORNUMBERHEX = Hex($OIEERRORHANDLER.number, 8)
	$IECOMERRORDESCRIPTION = StringStripWS($OIEERRORHANDLER.description, 2)
	$IECOMERRORWINDESCRIPTION = StringStripWS($OIEERRORHANDLER.WinDescription, 2)
	$IECOMERRORSOURCE = $OIEERRORHANDLER.Source
	$IECOMERRORHELPFILE = $OIEERRORHANDLER.HelpFile
	$IECOMERRORHELPCONTEXT = $OIEERRORHANDLER.HelpContext
	$IECOMERRORLASTDLLERROR = $OIEERRORHANDLER.LastDllError
	$IECOMERROROUTPUT = ""
	$IECOMERROROUTPUT &= "--> COM Error Encountered in " & @ScriptName & @CR
	$IECOMERROROUTPUT &= "----> $IEComErrorScriptline = " & $IECOMERRORSCRIPTLINE & @CR
	$IECOMERROROUTPUT &= "----> $IEComErrorNumberHex = " & $IECOMERRORNUMBERHEX & @CR
	$IECOMERROROUTPUT &= "----> $IEComErrorNumber = " & $IECOMERRORNUMBER & @CR
	$IECOMERROROUTPUT &= "----> $IEComErrorWinDescription = " & $IECOMERRORWINDESCRIPTION & @CR
	$IECOMERROROUTPUT &= "----> $IEComErrorDescription = " & $IECOMERRORDESCRIPTION & @CR
	$IECOMERROROUTPUT &= "----> $IEComErrorSource = " & $IECOMERRORSOURCE & @CR
	$IECOMERROROUTPUT &= "----> $IEComErrorHelpFile = " & $IECOMERRORHELPFILE & @CR
	$IECOMERROROUTPUT &= "----> $IEComErrorHelpContext = " & $IECOMERRORHELPCONTEXT & @CR
	$IECOMERROROUTPUT &= "----> $IEComErrorLastDllError = " & $IECOMERRORLASTDLLERROR & @CR
	If $_IEERRORNOTIFY Or $__IEAU3DEBUG Then ConsoleWrite($IECOMERROROUTPUT & @CR)
	SetError($_IESTATUS_COMERROR)
	Return
EndFunc


Func __IECOMERRORUNRECOVERABLE()
	Select
		Case ($IECOMERRORNUMBER = -2147352567) Or (String($IECOMERRORDESCRIPTION) = "Access is denied.")
			Return $_IESTATUS_ACCESSISDENIED
		Case ($IECOMERRORNUMBER = -2147417848) Or (String($IECOMERRORWINDESCRIPTION) = "The object invoked has disconnected from its clients.")
			Return $_IESTATUS_CLIENTDISCONNECTED
		Case Else
			Return $_IESTATUS_SUCCESS
	EndSelect
EndFunc

#endregion Internal functions
#region ProtoType Functions

Func __IENAVIGATE(ByRef $O_OBJECT, $S_URL, $F_WAIT = 1, $I_FLAGS = 0, $S_TARGET = "", $S_POSTDATA = "", $S_HEADERS = "")
	__IEERRORNOTIFY("Warning", "__IENavigate", "Unsupported function called. Not fully tested.")
	If Not IsObj($O_OBJECT) Then
		__IEERRORNOTIFY("Error", "__IENavigate", "$_IEStatus_InvalidDataType")
		SetError($_IESTATUS_INVALIDDATATYPE, 1)
		Return 0
	EndIf
	If Not __IEISOBJTYPE($O_OBJECT, "documentContainer") Then
		__IEERRORNOTIFY("Error", "__IENavigate", "$_IEStatus_InvalidObjectType")
		SetError($_IESTATUS_INVALIDOBJECTTYPE, 1)
		Return 0
	EndIf
	$O_OBJECT.navigate($S_URL, $I_FLAGS, $S_TARGET, $S_POSTDATA, $S_HEADERS)
	If $F_WAIT Then
		_IELOADWAIT($O_OBJECT)
		SetError(@error)
		Return $O_OBJECT
	EndIf
	SetError($_IESTATUS_SUCCESS)
	Return $O_OBJECT
EndFunc


Func __IESTRINGTOBSTR($S_STRING, $S_CHARSET = "us-ascii")
	Local Const $ADTYPEBINARY = 1, $ADTYPETEXT = 2
	Local $O_STREAM
	$O_STREAM = ObjCreate("ADODB.Stream")
	$O_STREAM.Type = $ADTYPETEXT
	$O_STREAM.CharSet = $S_CHARSET
	$O_STREAM.Open
	$O_STREAM.WriteText($S_STRING)
	$O_STREAM.Position = 0
	$O_STREAM.Type = $ADTYPEBINARY
	$O_STREAM.Position = 0
	Return $O_STREAM.Read
EndFunc


Func __IEBSTRTOSTRING($O_BSTR, $S_CHARSET = "us-ascii")
	Local Const $ADTYPEBINARY = 1, $ADTYPETEXT = 2
	Local $O_STREAM
	$O_STREAM = ObjCreate("ADODB.Stream")
	$O_STREAM.Type = $ADTYPEBINARY
	$O_STREAM.Open
	$O_STREAM.Write($O_BSTR)
	$O_STREAM.Position = 0
	$O_STREAM.Type = $ADTYPETEXT
	$O_STREAM.CharSet = $S_CHARSET
	$O_STREAM.Position = 0
	Return $O_STREAM.ReadText
EndFunc


Func __IECREATENEWIE($S_TITLE, $S_HEAD = "", $S_BODY = "")
	Local $S_HTML, $H_FILE, $S_PID, $O_OBJECT
	Local $S_TEMP = __IETEMPFILE("", "~IE~", ".htm")
	If @error Then
		SetError($_IESTATUS_GENERALERROR, 1)
		__IEERRORNOTIFY("Error", "_IECreateHTA", "", "Error creating temporary file in @TempDir or @ScriptDir")
		Return 0
	EndIf
	$S_HTML = ""
	$S_HTML &= "<HTML>" & @CR
	$S_HTML &= "<HEAD>" & @CR
	$S_HTML &= "<TITLE>" & $S_TEMP & "</TITLE>" & @CR & $S_HEAD & @CR
	$S_HTML &= "</HEAD>" & @CR
	$S_HTML &= "<BODY>" & @CR & $S_BODY & @CR
	$S_HTML &= "</BODY>" & @CR
	$S_HTML &= "</HTML>"
	$H_FILE = FileOpen($S_TEMP, 2)
	FileWrite($H_FILE, $S_HTML)
	FileClose($H_FILE)
	If @error Then
		SetError($_IESTATUS_GENERALERROR, 2)
		__IEERRORNOTIFY("Error", "_IECreateNewIE", "", "Error creating temporary file in @TempDir or @ScriptDir")
		Return 0
	EndIf
	Run(@ProgramFilesDir & "\Internet Explorer\iexplore.exe " & $S_TEMP)
	If WinWait($S_TEMP, "", 60) Then
		$S_PID = WinGetProcess($S_TEMP)
	Else
		SetError($_IESTATUS_GENERALERROR, 3)
		__IEERRORNOTIFY("Error", "_IECreateNewIE", "", "Timeout waiting for new IE window creation")
		Return 0
	EndIf
	If Not FileDelete($S_TEMP) Then
		__IEERRORNOTIFY("Warning", "_IECreateNewIE", "", "Could not delete temporary file " & FileGetLongName($S_TEMP))
	EndIf
	$O_OBJECT = _IEATTACH($S_TEMP)
	_IELOADWAIT($O_OBJECT)
	_IEPROPERTYSET($O_OBJECT, "title", $S_TITLE)
	SetError($_IESTATUS_SUCCESS, $S_PID)
	Return $O_OBJECT
EndFunc


Func __IETEMPFILE($S_DIRECTORYNAME = @TempDir, $S_FILEPREFIX = "~", $S_FILEEXTENSION = ".tmp", $I_RANDOMLENGTH = 7)
	Local $S_TEMPNAME, $I_TMP = 0
	If Not FileExists($S_DIRECTORYNAME) Then $S_DIRECTORYNAME = @TempDir
	If Not FileExists($S_DIRECTORYNAME) Then $S_DIRECTORYNAME = @ScriptDir
	If StringRight($S_DIRECTORYNAME, 1) <> "\" Then $S_DIRECTORYNAME = $S_DIRECTORYNAME & "\"
	Do
		$S_TEMPNAME = ""
		While StringLen($S_TEMPNAME) < $I_RANDOMLENGTH
			$S_TEMPNAME = $S_TEMPNAME & Chr(Random(97, 122, 1))
		WEnd
		$S_TEMPNAME = $S_DIRECTORYNAME & $S_FILEPREFIX & $S_TEMPNAME & $S_FILEEXTENSION
		$I_TMP += 1
		If $I_TMP > 200 Then
			SetError($_IESTATUS_GENERALERROR, 1)
			Return 0
		EndIf
	Until Not FileExists($S_TEMPNAME)
	SetError(0)
	Return ($S_TEMPNAME)
EndFunc

#endregion ProtoType Functions
#NoTrayIcon
AutoItSetOption("PixelCoordMode", 2)
AutoItSetOption("GUIOnEventMode", 1)
AutoItSetOption("SendCapslockMode", 1)
HotKeySet("{PGUP}", "UpDangerPos")
HotKeySet("{PGDN}", "DownDangerPos")
HotKeySet("^+a", "CloseGame")
HotKeySet("^+i", "ShowInfoAuto")
HotKeySet("^+k", "ShowHotKey")
HotKeySet("{Ins}", "ToggleAutoFeed")
HotKeySet("{PAUSE}", "ActivePauseAuto")
HotKeySet("^+{DEl}", "DelTooltip")
HotKeySet("^+{END}", "ExitAuto")
HotKeySet("^+!1", "AtiveTest1")

Func ATIVETEST1()
	CHECKONLINE()
EndFunc

SETMAINVAR()
SETSTRING()
LOADDATA()
CREATEMAINGUI()
SHOWMAINGUI()
CHECKAUTO()
If $CHECKVERSION Then CHECKVERSIONAUTO()
CHECKONLINE()
While 1
	If ISSHOWTESTINFO() Then
		STOOLTIP(SETTESTINFO())
	EndIf
	If TimerDiff($TIMEB) > (16 * $SPM * $1S) Then CHECKONLINE()
	Sleep(77)
	If PAUSEAUTO() Then
		SHOWPAUSEAUTO()
		ContinueLoop
	EndIf
	CHECKDANGERPOS()
	CHECKDELAYTIME()
	RUNNINGTASK()
	PICKUPALL()
WEnd

Func SETMAINVAR()
	Global $TIMESPLIT = " - "
	Global $1S = 1000
	Global Const $SPM = 60
	Global Const $MPH = 60
	Global Const $HPD = 24
	Global $SHOWTOOLTIP = False
	Global $SHOWHOTKEY = False
	Global $SHOWHOMEPAGE = False
	Global $SHOWINFOAUTO = False
	Global $SHOWATTENTION = False
	Global $SLIDEDMAINGUI = False
	Global $SHOWWARNINGLABLE = False
	Global $PAUSE = False
	Global $SHOWPAUSENUM = 1
	Global $RUNNING = False
	Global $RUNNINGI = 1
	Global $RUNNINGTASK = False
	Global $RUNNINGTASKI = 1
	Global $TESTINFOSTATUS = 4
	Global $FCONFIGNAME = "config.ini"
	Global $TIMEA = TimerInit()
	Global $TIMEB = TimerInit()
	Global $DELAYTIME = 2005
	Global $KEYF = "Alt+0"
	Global $KEYLISTF = "Alt+0|Alt+9|Alt+8|Alt+7|Alt+6|Alt+5|Alt+4|Alt+3|Alt+2|Alt+1|F10|F9|F8|F7|F6|F5|F4|F3|F2|F1"
	Global $PETHPCHECKPOS = 1
	Global $DANGERPOS = 34
	Global $SPAMPOS = 7
	Global $SPAMPOS = 7
	Global $PICKING = False
	Global $PICKUPALL = 1
	Global $CHECKVERSION = 1
	Global $SITWHENSTAY = 1
	Global $SITCOUNT = 1
	Global $CHECKSET1 = 0
	Global $GAMETITLE = "[TITLE:Thien Long Bat Bo; CLASS:TianLongBaBu WndClass;]"
	Global $GAMEPOS[2] = [0, 0]
	Global $GAMECARETPOS[2] = [0, 0]
	Global $GAMEHANDLE = 0
	Global $GAMESTATUS = 0
	Global $GAMEHANDLEBK = 0
	Global $PETHP = 100
	Global $HAVEPETHP = 0
	Global $PETHPCOLOR = 0
	Global $PETHPPOS[2] = [62, 72]
	Global $OIE = ObjCreate("Shell.Explorer.2")
	Global $OIEFILENAME = "view.html"
EndFunc


Func CHECKAUTO()
	Local $L = WinList("[TITLE:" & $AUTOTITLE & "; CLASS:AutoIt v3 GUI;]")
	Local $COUNTPROCESS = $PROCESSNUMBER
	If $L[0][0] > $PROCESSNUMBER Then
		MsgBox(0, $AUTONAME, $ENOUGHAUTOT)
		EXITAUTO()
	EndIf
EndFunc


Func SHOWHOTKEY()
	If $SHOWTOOLTIP And $SHOWHOTKEY Then
		DELTOOLTIP()
	Else
		DELTOOLTIP()
		$SHOWHOTKEY = True
		$SHOWTOOLTIP = True
		Local $TEXT = @TAB & "DANH SÁCH PHÍM NÓNG" & @LF
		$TEXT = $TEXT & "Insert" & @TAB & "" & @TAB & @TAB & "- Bấm Tự ăn" & @LF
		$TEXT = $TEXT & "PageUP  " & @TAB & @TAB & "- Tăng giới hạn tự ăn" & @LF
		$TEXT = $TEXT & "PageDown" & @TAB & @TAB & "- Giảm giới hạn tự ăn" & @LF
		$TEXT = $TEXT & "Pause" & @TAB & "" & @TAB & @TAB & "- Tạm Dừng Auto" & @LF
		$TEXT = $TEXT & "Ctrl+Shilf+A" & @TAB & @TAB & "- Tắt nhanh Game" & @LF
		$TEXT = $TEXT & "Ctrl+Shilf+I" & @TAB & @TAB & "- Xem thông tin Auto" & @LF
		$TEXT = $TEXT & "Ctrl+Shilf+K" & @TAB & @TAB & "- Xem phím Nóng" & @LF
		$TEXT = $TEXT & "Ctrl+Shilf+Delete" & @TAB & "- Xóa Thông Báo" & @LF
		$TEXT = $TEXT & "Ctrl+Shilf+End" & @TAB & @TAB & "- Thoát Auto" & @LF
		STOOLTIP($TEXT)
	EndIf
EndFunc


Func SHOWHOMEPAGE()
	If $SHOWTOOLTIP And $SHOWHOMEPAGE Then
		DELTOOLTIP()
	Else
		DELTOOLTIP()
		$SHOWTOOLTIP = True
		$SHOWHOMEPAGE = True
		Local $TEXT = @TAB & "ĐỊA CHỈ TRANG CHỦ & NƠI TẢI TRƯƠNG TRÌNH"
		$TEXT = $TEXT & $NEWVERSIONT & @LF & @LF
		$TEXT = $TEXT & " - LeeSaiBlog: " & @TAB & $BLOGNAME & @LF
		$TEXT = $TEXT & " - Link tải Auto: " & @TAB & $LINKDOWN
		STOOLTIP($TEXT)
	EndIf
EndFunc


Func SHOWINFOAUTO()
	If $SHOWTOOLTIP And $SHOWINFOAUTO Then
		DELTOOLTIP()
	Else
		DELTOOLTIP()
		$SHOWINFOAUTO = True
		$SHOWTOOLTIP = True
		Local $TEXT = @TAB & "THÔNG TIN" & @LF
		$TEXT = $TEXT & "- Chương Trình: " & $AUTONAME & @LF
		$TEXT = $TEXT & "- Phiên Bản: " & $AUTOVERSION & @LF
		$TEXT = $TEXT & "- Thiết kế: " & $AUTHOR & @LF
		$TEXT = $TEXT & "- Chức năng: " & $FUNCTIONS
		STOOLTIP($TEXT)
	EndIf
EndFunc


Func SHOWATTENTIONAUTO()
	If $SHOWTOOLTIP And $SHOWATTENTION Then
		DELTOOLTIP()
	Else
		DELTOOLTIP()
		$SHOWATTENTION = True
		$SHOWTOOLTIP = True
		Local $TEXT = @TAB & "HẠN CHẾ CỦA CHƯƠNG TRÌNH" & @LF
		$TEXT = $TEXT & " - Do được 1 người làm nên cần cập nhật sữa lỗi nhiều." & @LF
		$TEXT = $TEXT & " - Chương trình chưa hỗ trợ cho nhiều tài khoản 1 lúc." & @LF & @LF
		$TEXT = $TEXT & @TAB & "ƯU ĐIỂM CỦA CHƯƠNG TRÌNH" & @LF
		$TEXT = $TEXT & " - Không bao giờ có Keylog hay Virus. (^_^ )" & @LF & @LF
		$TEXT = $TEXT & @TAB & "CHỨC NĂNG TỰ CHO THÚ ĂN" & @LF
		$TEXT = $TEXT & " - Chọn giới hạn sẽ cho ăn." & @LF
		$TEXT = $TEXT & " - Nhập thời gian đợi sau mỗi lần ăn." & @LF
		$TEXT = $TEXT & " - Chọn phím tắt nơi chứa thức ăn." & @LF
		$TEXT = $TEXT & " - Khi máu Pet thấp hơn giới hạn, nó sẽ tự ăn." & @LF & @LF
		$TEXT = $TEXT & @TAB & @TAB & "HỖ TRỢ NHẶC ĐỒ" & @LF
		$TEXT = $TEXT & " - Di chuyển nhanh chuột đến nút Nhặt Hết." & @LF
		$TEXT = $TEXT & " - Sẽ không hoạt động, nếu khung Nhặt Hết bị di chuyển." & @LF & @LF
		$TEXT = $TEXT & @TAB & @TAB & "KIỂM TRA NÂNG CẤP" & @LF
		$TEXT = $TEXT & " - Tự động kiểm tra và thông báo khi có phiên bản mới." & @LF
		STOOLTIP($TEXT)
	EndIf
EndFunc


Func DELTOOLTIP()
	$SHOWTOOLTIP = False
	$SHOWHOTKEY = False
	$SHOWHOMEPAGE = False
	$SHOWINFOAUTO = False
	$SHOWATTENTION = False
	ToolTip("")
EndFunc


Func RUNNINGCHECK()
	Select
		Case $RUNNINGI = 1
			GUICtrlSetData($RUNNING_LABLE, "|")
		Case $RUNNINGI = 2
			GUICtrlSetData($RUNNING_LABLE, "/")
		Case $RUNNINGI = 3
			GUICtrlSetData($RUNNING_LABLE, "__")
		Case $RUNNINGI = 4
			GUICtrlSetData($RUNNING_LABLE, "\")
		Case $RUNNINGI = 5
			GUICtrlSetData($RUNNING_LABLE, "|")
		Case $RUNNINGI = 6
			GUICtrlSetData($RUNNING_LABLE, "\")
		Case $RUNNINGI = 7
			GUICtrlSetData($RUNNING_LABLE, "__")
		Case $RUNNINGI = 8
			GUICtrlSetData($RUNNING_LABLE, "/")
		Case $RUNNINGI = 9
			GUICtrlSetData($RUNNING_LABLE, "S")
	EndSelect
	If $RUNNINGI = 9 Then
		$RUNNINGI = 0
	EndIf
	$RUNNINGI += 1
EndFunc


Func HIDDENSHOW()
	Local $POS = WinGetPos($MAINGUI)
	If $POS[1] = 0 Then
		GUICtrlSetData($HIDDEN_BUTTON, $BUTTON_SHOWT)
		WinMove($MAINGUI, "", $MAINGUI_POS[0], $MAINGUI_POS[1] - $MAINGUI_SIZE[1] + $HIDDEN_BUTTON_SIZE[1] + $VERTICALLY, Default, Default, 2)
		$SLIDEDMAINGUI = True
	Else
		GUICtrlSetData($HIDDEN_BUTTON, $HIDDEN_BUTTONT)
		WinMove($MAINGUI, "", $MAINGUI_POS[0], $MAINGUI_POS[1], Default, Default, 2)
		$SLIDEDMAINGUI = False
	EndIf
EndFunc


Func ACTIVEPAUSEAUTO()
	$PAUSE = Not $PAUSE
	If $PAUSE Then
		SHOWWARNINGGUI()
		GUICtrlSetData($PAUSE_BUTTON, $PAUSE_BUTTONT2)
	Else
		HIDEWARNINGGUI()
		GUICtrlSetData($PAUSE_BUTTON, $PAUSE_BUTTONT1)
		GUICtrlSetData($WARNING_LABLE, "")
	EndIf
EndFunc


Func PAUSEAUTO()
	If $PAUSE Then
		Return True
	EndIf
	Return False
EndFunc


Func SHOWPAUSEAUTO()
	Select
		Case $SHOWPAUSENUM = 1
			GUICtrlSetData($WARNING_LABLE, " >    " & $PAUSEAUTOT & "    < ")
		Case $SHOWPAUSENUM = 2
			GUICtrlSetData($WARNING_LABLE, "  >   " & $PAUSEAUTOT & "   <  ")
		Case $SHOWPAUSENUM = 3
			GUICtrlSetData($WARNING_LABLE, "   >  " & $PAUSEAUTOT & "  <   ")
		Case $SHOWPAUSENUM = 4
			GUICtrlSetData($WARNING_LABLE, "    > " & $PAUSEAUTOT & " <    ")
		Case $SHOWPAUSENUM = 5
			GUICtrlSetData($WARNING_LABLE, "     >" & $PAUSEAUTOT & "<     ")
	EndSelect
	If $SHOWPAUSENUM = 5 Then
		$SHOWPAUSENUM = 0
	EndIf
	$SHOWPAUSENUM += 1
EndFunc


Func EXITAUTO()
	SAVEDATA()
	Exit
EndFunc


Func STOOLTIP($TEXT, $X = Default, $Y = Default)
	If $X = Default Then $X = $MAINGUI_POS[0] + $MAINGUI_SIZE[0] + 2
	If $Y = Default Then $Y = $MAINGUI_POS[1]
	ToolTip($TEXT, $X, $Y)
EndFunc


Func ISSHOWTESTINFO()
	Local $STATUS = GUICtrlRead($SHOWTESTINFO_CHECKBOX)
	If $STATUS = 1 Then
		$TESTINFOSTATUS = $STATUS
		Return 1
	EndIf
	If $STATUS = 4 And $TESTINFOSTATUS <> 4 Then
		$TESTINFOSTATUS = $STATUS
		ToolTip("", 0, 0)
	EndIf
	Return 0
EndFunc


Func SETSTRING()
	Global $AUTONAME = "Sai ATLBB"
	Global $AUTOCLASS = "AutoIt v3 GUI"
	Global $AUTOVERSION = "2.01"
	Global $AUTOVERSIONCODE = "201"
	Global $NEWVERSIONT = ""
	Global $FOUNDNEWVERSIONT = " (ĐÃ CÓ PHIÊN BẢN MỚI)"
	Global $AUTHOR = "Trần Minh Đức"
	Global $BLOGNAME = "http://www.LeeSai.co.cc"
	Global $BLOGNAMEFULL = "http://my.opera.com/saihukaru/blog/"
	Global $LINKDOWN = "http://my.opera.com/saihukaru/blog/auto-saiatlbb"
	Global $AUTOTITLE = $AUTONAME & " v" & $AUTOVERSION & " "
	Global Const $PROCESSNUMBER = 1
	Global $FUNCTIONS = @LF
	$FUNCTIONS &= "  + Tự cho Thú ăn" & @LF
	Global $MENU_FILET = "&Quản Lý"
	Global $MENU_FILE_GAMET1 = "&Thiên Long"
	Global $MENU_FILE_GAME_CLOSEGAMET1 = "&Tắt Nhanh Game"
	Global $MENU_FILE_BROWSERT1 = "&Truy Cập"
	Global $MENU_FILE_BROWSER_HOMEPAGET1 = "&Blog của Tác Giả"
	Global $MENU_FILE_BROWSER_PORTPAGET1 = "&Nơi tải " & $AUTONAME
	Global $MENU_FILE_BROWSER_LOGINFPTT1 = "&Nơi Reset giờ chơi"
	Global $MENU_FILE_EXITT = "&Thoát"
	Global $MENU_HELPT = "&Hỗ Trợ"
	Global $MENU_HELP_HOMEPAGET = "&Trang Chủ       bật/tắt"
	Global $MENU_HELP_HOTKEYT = "&Phím Nóng       bật/tắt"
	Global $MENU_HELP_ATTENTIONT = "&Hướng dẫn      bật/tắt"
	Global $MENU_HELP_ABOUTT = "&Thông Tin        bật/tắt"
	Global $HIDDEN_BUTTONT = "/\"
	Global $BUTTON_SHOWT = "\/"
	Global $HIDDEN_BUTTON_TIPT = "Thu gọn chương trình"
	Global $PAUSE_BUTTONT1 = "<  >"
	Global $PAUSE_BUTTONT2 = "<>"
	Global $PAUSE_BUTTON_TIPT = "Tạm ngưng hoạt động"
	Global $EXIT_BUTTONT = "X"
	Global $EXIT_BUTTON_TIPT = "Thoát chương trình"
	Global $TAB_PETT = "Thú Nuôi"
	Global $BUTTON_STARTT1 = "Tự ăn"
	Global $BUTTON_STARTT2 = "Ngưng"
	Global $BUTTON_START_TIPT = "Bắt đầu canh để cho Thú ăn"
	Global $LABLE_INUTDANGERPOST1 = "khi còn"
	Global $DANGERPOS_LABLE_TIPT = "Nếu máu của thú ít hơn chừng này thì cho ăn"
	Global $LABLE_UNDERSTARTT1 = "Thời gian đợi: "
	Global $LABLE_UNDERSTART_TIPT1 = "Thời gian đợi sau mỗi lần cho Thú ăn." & @LF & "Tình bằng mili giây: " & $DELAYTIME & "ms ~ " & Int($DELAYTIME / $1S) & "giây"
	Global $SECONDT = "ms"
	Global $LABLE_SHORTCUTSKILLT1 = "Ô chứa đồ ăn: "
	Global $LABLE_SHORTCUTSKILL_TIPT1 = "Ô này sẽ chứa thức ăn của thú"
	Global $BUTTON_SAVEPETCOLORT1 = "Sửa Lỗi"
	Global $BUTTON_SAVEPETCOLOR_TIPT = "Chỉ bấm khi nào đã gọi thú lên."
	Global $PETHP_LABLE_TIPT = "Phần trăm máu của thú nuôi hiện giờ"
	Global $OPTION_TABT1 = "Mở rộng"
	Global $PICKUPALLT = "Hỗ trợ nhặt đồ"
	Global $PICKUPALL_CHECKBOX_TIP = "Di chuyển chuột đến nút Nhặt Hết"
	Global $CHECKVERSIONT = "Kiểm tra nâng cấp"
	Global $CHECKVERSION_CHECKBOX_TIP = "Tự động kiểm tra phiên bản mới"
	Global $SHOWTESTINFO_CHECKBOXT1 = "Hiện Thông Số"
	Global $SHOWTESTINFO_CHECKBOX_TIP = "Ẩn/Hiện các thông số hoạt động của Macro để test"
	Global $ENOUGHAUTOT = $AUTONAME & " đã chạy đủ." & @LF & "Không thể mở thêm!!!"
	Global $PAUSEAUTOT = "Tạm dừng"
	Return True
EndFunc


Func CREATEMAINGUI()
	Global $FONT_COLOR = 30719
	Global $TAB_SIZE[2] = [0, 25]
	Global $HORIZONTALLY = 7
	Global $VERTICALLY = 5
	Global $MAINGUI_SIZE[2] = [160, 205]
	Global $MAINGUI_POS[2] = [0, 0]
	Global $MAINGUI = GUICreate($AUTOTITLE, $MAINGUI_SIZE[0], $MAINGUI_SIZE[1], $MAINGUI_POS[0], $MAINGUI_POS[1], $WS_BORDER, $WS_EX_TOPMOST + $WS_EX_TOOLWINDOW)
	GUISetBkColor(16777215, $MAINGUI)
	$MENUTITTLE_SIZE = 38.5
	$MENU_FILE = GUICtrlCreateMenu($MENU_FILET)
	$MENU_FILE_GAME = GUICtrlCreateMenu($MENU_FILE_GAMET1, $MENU_FILE)
	Global $MENU_FILE_GAME_CLOSEGAME = GUICtrlCreateMenuItem($MENU_FILE_GAME_CLOSEGAMET1, $MENU_FILE_GAME)
	GUICtrlSetOnEvent($MENU_FILE_GAME_CLOSEGAME, "CloseGame")
	$MENU_FILE_BROWSER = GUICtrlCreateMenu($MENU_FILE_BROWSERT1, $MENU_FILE)
	$MENU_FILE_BROWSER_HOMEPAGE = GUICtrlCreateMenuItem($MENU_FILE_BROWSER_HOMEPAGET1, $MENU_FILE_BROWSER)
	GUICtrlSetOnEvent($MENU_FILE_BROWSER_HOMEPAGE, "NavigateLeeSaiBlog")
	$MENU_FILE_BROWSER_PORTPAGE = GUICtrlCreateMenuItem($MENU_FILE_BROWSER_PORTPAGET1, $MENU_FILE_BROWSER)
	GUICtrlSetOnEvent($MENU_FILE_BROWSER_PORTPAGE, "NavigatePortAuto")
	$MENU_FILE_BROWSER_LOGINFPT = GUICtrlCreateMenuItem($MENU_FILE_BROWSER_LOGINFPTT1, $MENU_FILE_BROWSER)
	GUICtrlSetOnEvent($MENU_FILE_BROWSER_LOGINFPT, "NavigateLoginFPT")
	$MENU_FILE_EXIT = GUICtrlCreateMenuItem($MENU_FILE_EXITT, $MENU_FILE)
	GUICtrlSetOnEvent($MENU_FILE_EXIT, "ExitAuto")
	$MENU_HELP = GUICtrlCreateMenu($MENU_HELPT)
	$MENU_HELP_HOMEPAGE = GUICtrlCreateMenuItem($MENU_HELP_HOMEPAGET, $MENU_HELP)
	GUICtrlSetOnEvent($MENU_HELP_HOMEPAGE, "ShowHomePage")
	$MENU_HELP_HOTKEY = GUICtrlCreateMenuItem($MENU_HELP_HOTKEYT, $MENU_HELP)
	GUICtrlSetOnEvent($MENU_HELP_HOTKEY, "ShowHotKey")
	$MENU_HELP_ATTENTION = GUICtrlCreateMenuItem($MENU_HELP_ATTENTIONT, $MENU_HELP)
	GUICtrlSetOnEvent($MENU_HELP_ATTENTION, "ShowAttentionAuto")
	$MENU_HELP_ABOUT = GUICtrlCreateMenuItem($MENU_HELP_ABOUTT, $MENU_HELP)
	GUICtrlSetOnEvent($MENU_HELP_ABOUT, "ShowInfoAuto")
	Global $EXIT_BUTTON_SIZE[2] = [25, 22]
	Global $EXIT_BUTTON_POS[2] = [$MAINGUI_SIZE[0] - $EXIT_BUTTON_SIZE[0] - $HORIZONTALLY, $MAINGUI_SIZE[1] - $EXIT_BUTTON_SIZE[1] - $MENUTITTLE_SIZE - $VERTICALLY]
	Global $EXIT_BUTTON = GUICtrlCreateButton($EXIT_BUTTONT, $EXIT_BUTTON_POS[0], $EXIT_BUTTON_POS[1], $EXIT_BUTTON_SIZE[0], $EXIT_BUTTON_SIZE[1])
	GUICtrlSetOnEvent($EXIT_BUTTON, "ExitAuto")
	GUICtrlSetTip($EXIT_BUTTON, $EXIT_BUTTON_TIPT)
	Global $PAUSE_BUTTON_SIZE[2] = [$EXIT_BUTTON_SIZE[0], $EXIT_BUTTON_SIZE[1]]
	Global $PAUSE_BUTTON_POS[2] = [$EXIT_BUTTON_POS[0] - $PAUSE_BUTTON_SIZE[0], $EXIT_BUTTON_POS[1]]
	Global $PAUSE_BUTTON = GUICtrlCreateButton($PAUSE_BUTTONT1, $PAUSE_BUTTON_POS[0], $PAUSE_BUTTON_POS[1], $PAUSE_BUTTON_SIZE[0], $PAUSE_BUTTON_SIZE[1])
	GUICtrlSetOnEvent($PAUSE_BUTTON, "ActivePauseAuto")
	GUICtrlSetTip($PAUSE_BUTTON, $PAUSE_BUTTON_TIPT)
	Global $HIDDEN_BUTTON_SIZE[2] = [$EXIT_BUTTON_SIZE[0], $EXIT_BUTTON_SIZE[1]]
	Global $HIDDEN_BUTTON_POS[2] = [$PAUSE_BUTTON_POS[0] - $HIDDEN_BUTTON_SIZE[0], $PAUSE_BUTTON_POS[1]]
	Global $HIDDEN_BUTTON = GUICtrlCreateButton($HIDDEN_BUTTONT, $HIDDEN_BUTTON_POS[0], $HIDDEN_BUTTON_POS[1], $HIDDEN_BUTTON_SIZE[0], $HIDDEN_BUTTON_SIZE[1])
	GUICtrlSetOnEvent($HIDDEN_BUTTON, "HiddenShow")
	GUICtrlSetTip($HIDDEN_BUTTON, $HIDDEN_BUTTON_TIPT)
	Global $WARNING_LABLE_SIZE[2] = [133, 16]
	Global $WARNING_LABLE_POS[2] = [$HORIZONTALLY, $EXIT_BUTTON_POS[1] - $WARNING_LABLE_SIZE[1] - 2]
	Global $WARNING_LABLE = GUICtrlCreateLabel("", $WARNING_LABLE_POS[0], $WARNING_LABLE_POS[1], $WARNING_LABLE_SIZE[0], $WARNING_LABLE_SIZE[1])
	GUICtrlSetColor($WARNING_LABLE, $FONT_COLOR)
	GUICtrlSetFont($WARNING_LABLE, 9, 777)
	Global $RUNNING_LABLE_SIZE[2] = [9, 13.3]
	Global $RUNNING_LABLE_POS[2] = [$HORIZONTALLY, $HIDDEN_BUTTON_POS[1] + $VERTICALLY]
	Global $RUNNING_LABLE = GUICtrlCreateLabel("", $RUNNING_LABLE_POS[0], $RUNNING_LABLE_POS[1], $RUNNING_LABLE_SIZE[0], $RUNNING_LABLE_SIZE[1])
	GUICtrlSetColor($RUNNING_LABLE, $FONT_COLOR)
	Global $DANGERPOS_LABLE_SIZE[2] = [30.4, 13.3]
	Global $DANGERPOS_LABLE_POS[2] = [$HIDDEN_BUTTON_POS[0] - $DANGERPOS_LABLE_SIZE[0], $HIDDEN_BUTTON_POS[1] + $HORIZONTALLY]
	Global $DANGERPOS_LABLE = GUICtrlCreateLabel("0%", $DANGERPOS_LABLE_POS[0], $DANGERPOS_LABLE_POS[1], $DANGERPOS_LABLE_SIZE[0], $DANGERPOS_LABLE_SIZE[1])
	GUICtrlSetColor($DANGERPOS_LABLE, 30719)
	GUICtrlSetTip($DANGERPOS_LABLE, $DANGERPOS_LABLE_TIPT)
	Global $PETHP_LABLE_SIZE[2] = [20.5, 13.3]
	Global $PETHP_LABLE_POS[2] = [$DANGERPOS_LABLE_POS[0] - $PETHP_LABLE_SIZE[0], $DANGERPOS_LABLE_POS[1]]
	Global $PETHP_LABLE = GUICtrlCreateLabel("0 / ", $PETHP_LABLE_POS[0], $PETHP_LABLE_POS[1], $PETHP_LABLE_SIZE[0], $PETHP_LABLE_SIZE[1], $SS_RIGHT)
	GUICtrlSetColor($PETHP_LABLE, 30719)
	GUICtrlSetTip($PETHP_LABLE, $PETHP_LABLE_TIPT)
	$TABTITTLE_SIZE = 21.4
	Global $MAINTAB_SIZE[2] = [$MAINGUI_SIZE[0], $MAINGUI_SIZE[1] - $EXIT_BUTTON_SIZE[1] - $WARNING_LABLE_SIZE[1] - 50]
	Global $MAINTAB = GUICtrlCreateTab(0, 0, $MAINTAB_SIZE[0], $MAINTAB_SIZE[1])
	Global $TAB_PET = GUICtrlCreateTabItem($TAB_PETT)
	Global $BUTTON_START_SIZE[2] = [43, 25]
	Global $BUTTON_START_POS[2] = [$VERTICALLY, $HORIZONTALLY + $TABTITTLE_SIZE]
	Global $BUTTON_START = GUICtrlCreateButton($BUTTON_STARTT1, $BUTTON_START_POS[0], $BUTTON_START_POS[1], $BUTTON_START_SIZE[0], $BUTTON_START_SIZE[1])
	GUICtrlSetOnEvent($BUTTON_START, "ToggleAutoFeed")
	GUICtrlSetTip($BUTTON_START, $BUTTON_START_TIPT)
	Global $LABLE_INUTDANGERPOS_SIZE[2] = [52, 16]
	Global $LABLE_INUTDANGERPOS_POS[2] = [$BUTTON_START_POS[0] + $BUTTON_START_SIZE[0] + $VERTICALLY, $BUTTON_START_POS[1] + $BUTTON_START_SIZE[1] / 4]
	Global $LABLE_INUTDANGERPOS = GUICtrlCreateLabel($LABLE_INUTDANGERPOST1, $LABLE_INUTDANGERPOS_POS[0], $LABLE_INUTDANGERPOS_POS[1], $LABLE_INUTDANGERPOS_SIZE[0], $LABLE_INUTDANGERPOS_SIZE[1], $SS_RIGHT)
	GUICtrlSetFont($LABLE_INUTDANGERPOS, 9, 777)
	GUICtrlSetTip($LABLE_INUTDANGERPOS, $DANGERPOS_LABLE_TIPT)
	Global $DANGERPOS_INPUT_SIZE[2] = [18.7, 16]
	Global $DANGERPOS_INPUT_POS[2] = [$LABLE_INUTDANGERPOS_POS[0] + $LABLE_INUTDANGERPOS_SIZE[0] + $VERTICALLY, $LABLE_INUTDANGERPOS_POS[1]]
	Global $DANGERPOS_INPUT = GUICtrlCreateInput($DANGERPOS, $DANGERPOS_INPUT_POS[0], $DANGERPOS_INPUT_POS[1], $DANGERPOS_INPUT_SIZE[0], $DANGERPOS_INPUT_SIZE[1])
	GUICtrlSetOnEvent($DANGERPOS_INPUT, "SaveData")
	GUICtrlSetTip($DANGERPOS_INPUT, $DANGERPOS_LABLE_TIPT)
	Global $LABLE_PERCENTAGE_SIZE[2] = [12, 16]
	Global $LABLE_PERCENTAGE_POS[2] = [$DANGERPOS_INPUT_POS[0] + $DANGERPOS_INPUT_SIZE[0] + 2, $DANGERPOS_INPUT_POS[1]]
	Global $LABLE_PERCENTAGE = GUICtrlCreateLabel("%", $LABLE_PERCENTAGE_POS[0], $LABLE_PERCENTAGE_POS[1], $LABLE_PERCENTAGE_SIZE[0], $LABLE_PERCENTAGE_SIZE[1])
	GUICtrlSetFont($LABLE_PERCENTAGE, 11, 777)
	Global $LABLE_UNDERSTART_SIZE[2] = [$MAINGUI_SIZE[0] / 2, 16]
	Global $LABLE_UNDERSTART_POS[2] = [$BUTTON_START_POS[0], $BUTTON_START_POS[1] + $BUTTON_START_SIZE[1] + $HORIZONTALLY]
	Global $LABLE_UNDERSTART = GUICtrlCreateLabel($LABLE_UNDERSTARTT1, $LABLE_UNDERSTART_POS[0], $LABLE_UNDERSTART_POS[1], $LABLE_UNDERSTART_SIZE[0], $LABLE_UNDERSTART_SIZE[1])
	GUICtrlSetFont($LABLE_UNDERSTART, 9, 777)
	GUICtrlSetTip($LABLE_UNDERSTART, $LABLE_UNDERSTART_TIPT1)
	Global $DELAYTIME_INPUT_SIZE[2] = [34, 16]
	Global $DELAYTIME_INPUT_POS[2] = [$LABLE_UNDERSTART_POS[0] + $LABLE_UNDERSTART_SIZE[0] + $VERTICALLY, $LABLE_UNDERSTART_POS[1]]
	Global $DELAYTIME_INPUT = GUICtrlCreateInput($DELAYTIME, $DELAYTIME_INPUT_POS[0], $DELAYTIME_INPUT_POS[1], $DELAYTIME_INPUT_SIZE[0], $DELAYTIME_INPUT_SIZE[1], $SS_RIGHT)
	GUICtrlSetOnEvent($DELAYTIME_INPUT, "SaveData")
	GUICtrlSetTip($DELAYTIME_INPUT, $LABLE_UNDERSTART_TIPT1)
	Global $LABLE_SECOND_SIZE[2] = [25, 16]
	Global $LABLE_SECOND_POS[2] = [$DELAYTIME_INPUT_POS[0] + $DELAYTIME_INPUT_SIZE[0] + $VERTICALLY, $DELAYTIME_INPUT_POS[1]]
	Global $LABLE_SECOND = GUICtrlCreateLabel($SECONDT, $LABLE_SECOND_POS[0], $LABLE_SECOND_POS[1], $LABLE_SECOND_SIZE[0], $LABLE_SECOND_SIZE[1])
	Local $LABLE_SHORTCUTSKILL_SIZE[2] = [79, 16]
	Local $LABLE_SHORTCUTSKILL_POS[2] = [$LABLE_UNDERSTART_POS[0], $LABLE_UNDERSTART_POS[1] + $LABLE_UNDERSTART_SIZE[1] + $HORIZONTALLY * 2]
	Global $LABLE_SHORTCUTSKILL = GUICtrlCreateLabel($LABLE_SHORTCUTSKILLT1, $LABLE_SHORTCUTSKILL_POS[0], $LABLE_SHORTCUTSKILL_POS[1], $LABLE_SHORTCUTSKILL_SIZE[0], $LABLE_SHORTCUTSKILL_SIZE[1])
	GUICtrlSetFont($LABLE_SHORTCUTSKILL, 9, 777)
	GUICtrlSetTip($LABLE_SHORTCUTSKILL, $LABLE_SHORTCUTSKILL_TIPT1)
	Local $SHORTCUTSKILL_COMBO_SIZE[2] = [57, 16]
	Local $SHORTCUTSKILL_COMBO_POS[2] = [$LABLE_SHORTCUTSKILL_POS[0] + $LABLE_SHORTCUTSKILL_SIZE[0] + $VERTICALLY, $LABLE_SHORTCUTSKILL_POS[1] - $SHORTCUTSKILL_COMBO_SIZE[1] / 7]
	Global $SHORTCUTSKILL_COMBO = GUICtrlCreateCombo($KEYF, $SHORTCUTSKILL_COMBO_POS[0], $SHORTCUTSKILL_COMBO_POS[1], $SHORTCUTSKILL_COMBO_SIZE[0], $SHORTCUTSKILL_COMBO_SIZE[1], $CBS_DROPDOWNLIST)
	GUICtrlSetOnEvent($SHORTCUTSKILL_COMBO, "SaveData")
	GUICtrlSetData($SHORTCUTSKILL_COMBO, $KEYLISTF)
	GUICtrlSetTip($SHORTCUTSKILL_COMBO, $LABLE_SHORTCUTSKILL_TIPT1)
	Local $LABLE_RUN_SIZE[2] = [9, 13.3]
	Local $LABLE_RUN_POS[2] = [$VERTICALLY, $PETHP_LABLE_POS[1]]
	Global $LABLE_RUN = GUICtrlCreateLabel("", $LABLE_RUN_POS[0], $LABLE_RUN_POS[1], $LABLE_RUN_SIZE[0], $LABLE_RUN_SIZE[1])
	GUICtrlSetColor($LABLE_RUN, 30719)
	Global $OPTION_TAB = GUICtrlCreateTabItem($OPTION_TABT1)
	Local $GUIACTIVEX_SIZE[2] = [$MAINGUI_SIZE[0] + $HORIZONTALLY * 2, 50]
	Local $GUIACTIVEX_POS[2] = [0, 20]
	Local $GUIACTIVEX = GUICtrlCreateObj($OIE, $GUIACTIVEX_POS[0], $GUIACTIVEX_POS[1], $GUIACTIVEX_SIZE[0], $GUIACTIVEX_SIZE[1])
	Local $PICKUPALL_CHECKBOX_SIZE[2] = [13, 13]
	Local $PICKUPALL_CHECKBOX_POS[2] = [$HORIZONTALLY, $GUIACTIVEX_SIZE[1] + $TAB_SIZE[1]]
	Global $PICKUPALL_CHECKBOX = GUICtrlCreateCheckbox("", $PICKUPALL_CHECKBOX_POS[0], $PICKUPALL_CHECKBOX_POS[1], $PICKUPALL_CHECKBOX_SIZE[0], $PICKUPALL_CHECKBOX_SIZE[1])
	GUICtrlSetTip($PICKUPALL_CHECKBOX, $PICKUPALL_CHECKBOX_TIP)
	GUICtrlSetOnEvent($PICKUPALL_CHECKBOX, "CheckPickupAll")
	If $PICKUPALL Then GUICtrlSetState($PICKUPALL_CHECKBOX, $GUI_CHECKED)
	Local $PICKUPALL_LABLE_POS[2] = [$PICKUPALL_CHECKBOX_POS[0] + $PICKUPALL_CHECKBOX_SIZE[0] + $HORIZONTALLY, $PICKUPALL_CHECKBOX_POS[1]]
	Local $PICKUPALL_LABLE = GUICtrlCreateLabel($PICKUPALLT, $PICKUPALL_LABLE_POS[0], $PICKUPALL_LABLE_POS[1])
	GUICtrlSetTip($PICKUPALL_LABLE, $PICKUPALL_CHECKBOX_TIP)
	Local $CHECKVERSION_CHECKBOX_SIZE[2] = [13, 13]
	Local $CHECKVERSION_CHECKBOX_POS[2] = [$PICKUPALL_CHECKBOX_POS[0], $PICKUPALL_CHECKBOX_POS[1] + $CHECKVERSION_CHECKBOX_SIZE[1] + $VERTICALLY]
	Global $CHECKVERSION_CHECKBOX = GUICtrlCreateCheckbox("", $CHECKVERSION_CHECKBOX_POS[0], $CHECKVERSION_CHECKBOX_POS[1], $CHECKVERSION_CHECKBOX_SIZE[0], $CHECKVERSION_CHECKBOX_SIZE[1])
	GUICtrlSetTip($CHECKVERSION_CHECKBOX, $CHECKVERSION_CHECKBOX_TIP)
	GUICtrlSetOnEvent($CHECKVERSION_CHECKBOX, "CheckVersion")
	If $CHECKVERSION Then GUICtrlSetState($CHECKVERSION_CHECKBOX, $GUI_CHECKED)
	Local $CHECKVERSION_LABLE_POS[2] = [$CHECKVERSION_CHECKBOX_POS[0] + $CHECKVERSION_CHECKBOX_SIZE[0] + $HORIZONTALLY, $CHECKVERSION_CHECKBOX_POS[1]]
	Local $CHECKVERSION_LABLE = GUICtrlCreateLabel($CHECKVERSIONT, $CHECKVERSION_LABLE_POS[0], $CHECKVERSION_LABLE_POS[1])
	GUICtrlSetTip($CHECKVERSION_LABLE, $CHECKVERSION_CHECKBOX_TIP)
	Local $SHOWTESTINFO_CHECKBOX_SIZE[2] = [13, 13]
	Local $SHOWTESTINFO_CHECKBOX_POS[2] = [$MAINGUI_SIZE[0] - $SHOWTESTINFO_CHECKBOX_SIZE[0] - $HORIZONTALLY, $TAB_SIZE[1] + $GUIACTIVEX_SIZE[1]]
	Global $SHOWTESTINFO_CHECKBOX = GUICtrlCreateCheckbox("", $SHOWTESTINFO_CHECKBOX_POS[0], $SHOWTESTINFO_CHECKBOX_POS[1], $SHOWTESTINFO_CHECKBOX_SIZE[0], $SHOWTESTINFO_CHECKBOX_SIZE[1])
	GUICtrlSetTip($SHOWTESTINFO_CHECKBOX, $SHOWTESTINFO_CHECKBOX_TIP)
	GUICtrlSetState($SHOWTESTINFO_CHECKBOX, $GUI_HIDE)
EndFunc


Func SHOWMAINGUI()
	GUISetState(@SW_SHOW, $MAINGUI)
EndFunc


Func HIDEMAINGUI()
	GUISetState(@SW_HIDE, $MAINGUI)
EndFunc


Func SHOWWARNINGGUI()
	If $SLIDEDMAINGUI And Not $SHOWWARNINGLABLE Then
		WinMove($MAINGUI, "", $MAINGUI_POS[0], $MAINGUI_POS[1] - $MAINGUI_SIZE[1] + $HIDDEN_BUTTON_SIZE[1] + $WARNING_LABLE_SIZE[1] + $VERTICALLY, Default, Default, 2)
		$SHOWWARNINGLABLE = True
	EndIf
EndFunc


Func HIDEWARNINGGUI()
	If $SLIDEDMAINGUI And $SHOWWARNINGLABLE Then
		WinMove($MAINGUI, "", $MAINGUI_POS[0], $MAINGUI_POS[1] - $MAINGUI_SIZE[1] + $HIDDEN_BUTTON_SIZE[1] + $VERTICALLY, Default, Default, 2)
		$SHOWWARNINGLABLE = False
	EndIf
EndFunc


Func SETWARNINGLABLE($TEXT = "")
	Local $CHECK = GUICtrlRead($WARNING_LABLE)
	If $CHECK <> $TEXT Then GUICtrlSetData($WARNING_LABLE, $TEXT)
EndFunc


Func SETRUNNINGLABLE($TEXT = "")
	Local $CHECK = GUICtrlRead($RUNNING_LABLE)
	If $CHECK <> $TEXT Then GUICtrlSetData($RUNNING_LABLE, $TEXT)
EndFunc


Func SETPETHPLABLE($TEXT = "")
	Local $CHECK = GUICtrlRead($PETHP_LABLE)
	If $CHECK <> $TEXT Then GUICtrlSetData($PETHP_LABLE, $TEXT)
EndFunc


Func SETDANGERPOSLABLE($TEXT = "")
	Local $CHECK = GUICtrlRead($DANGERPOS_LABLE)
	If $CHECK <> $TEXT Then
		GUICtrlSetData($DANGERPOS_LABLE, $TEXT)
		$DANGERPOS = GUICtrlRead($DANGERPOS_INPUT)
		SETDANGERPOSINPUT($DANGERPOS)
	EndIf
EndFunc


Func SETDANGERPOSINPUT($TEXT = "")
	Local $CHECK = GUICtrlRead($DANGERPOS_INPUT)
	If $CHECK <> $TEXT Then
		GUICtrlSetData($DANGERPOS_INPUT, $TEXT)
	EndIf
EndFunc


Func SETBUTTONSTART($TEXT = "")
	Local $CHECK = GUICtrlRead($BUTTON_START)
	If $CHECK <> $TEXT Then GUICtrlSetData($BUTTON_START, $TEXT)
EndFunc


Func CLOSEGAME()
	Local $PID = WinGetProcess($GAMETITLE)
	ProcessClose($PID)
EndFunc


Func NAVIGATELEESAIBLOG()
	$URL = "http://my.opera.com/saihukaru/blog/"
	$BROWSER = GETDEFAULTBROWSER()
	If Not $BROWSER Then
		_IECREATE($URL, 0, 1, 0, 1)
	Else
		Run($BROWSER & " " & $URL)
	EndIf
	HIDDENSHOW()
EndFunc


Func NAVIGATEPORTAUTO()
	$URL = "http://my.opera.com/saihukaru/blog/auto-saiatlbb"
	$BROWSER = GETDEFAULTBROWSER()
	If Not $BROWSER Then
		_IECREATE($URL, 0, 1, 0, 1)
	Else
		Run($BROWSER & " " & $URL)
	EndIf
	HIDDENSHOW()
EndFunc


Func NAVIGATELOGINFPT()
	$URL = "https://psp.gate.vn/"
	$BROWSER = GETDEFAULTBROWSER()
	If Not $BROWSER Then
		_IECREATE($URL, 0, 1, 0, 1)
	Else
		Run($BROWSER & " " & $URL)
	EndIf
	HIDDENSHOW()
EndFunc


Func CHECKVERSIONAUTO()
	InetGetSize("http://i296.photobucket.com/albums/mm197/saihukaru/GifTools/SaiATLBB/" & $AUTOVERSIONCODE & ".gif")
	If @error Then $NEWVERSIONT = @LF & @LF & @TAB & @TAB & $FOUNDNEWVERSIONT
	If $NEWVERSIONT <> "" Then
		SHOWHOMEPAGE()
		Return True
	Else
		Return False
	EndIf
EndFunc


Func CHECKVERSION()
	Local $STATUS = GUICtrlRead($CHECKVERSION_CHECKBOX)
	If $STATUS = 1 Then $CHECKVERSION = 1
	If $STATUS = 4 Then $CHECKVERSION = 0
	If $CHECKVERSION Then
		If Not CHECKVERSIONAUTO() Then MsgBox(0, $AUTOTITLE, "Hiện tại không có phiên bản mới")
	EndIf
	SAVEDATA()
EndFunc


Func GETDEFAULTBROWSER()
	Local $BROWSER = RegRead("HKEY_CURRENT_USER\Software\Clients\StartMenuInternet\", "")
	If $BROWSER = "FIREFOX.EXE" Then
		Local $VERSION = RegRead("HKEY_LOCAL_MACHINE\SOFTWARE\Mozilla\Mozilla Firefox", "CurrentVersion")
		Local $BROWSER = RegRead("HKEY_LOCAL_MACHINE\SOFTWARE\Mozilla\Mozilla Firefox\" & $VERSION & "\Main", "PathToExe")
	EndIf
	Return $BROWSER
EndFunc


Func TOGGLEAUTOFEED()
	$RUNNINGTASK = Not $RUNNINGTASK
	If Not $RUNNINGTASK Then
		SETRUNNINGLABLE()
		SETBUTTONSTART($BUTTON_STARTT1)
	Else
		ProcessSetPriority(WinGetProcess($GAMETITLE), 1)
		SETBUTTONSTART($BUTTON_STARTT2)
	EndIf
EndFunc


Func RUNNINGTASK()
	If Not $RUNNINGTASK Then
		Return False
	EndIf
	RUNNINGCHECK()
	Select
		Case $RUNNINGTASKI = 1
			If GAMEISMINI() Then
				SETWARNINGLABLE("Game đang thu nhỏ")
				SETRUNNINGTASK()
				SHOWWARNINGGUI()
			Else
				HIDEWARNINGGUI()
			EndIf
		Case $RUNNINGTASKI = 2
			CHECKGAME()
			If Not $GAMEHANDLE Then
				SETWARNINGLABLE("Không thấy Game")
				SHOWWARNINGGUI()
			Else
				HIDEWARNINGGUI()
			EndIf
		Case $RUNNINGTASKI = 3
			CHECKPET()
			If Not $HAVEPETHP Then
				SETPETHPLABLE(SETPETHP(100) & "/")
				SETWARNINGLABLE("Không thấy Pet")
				SHOWWARNINGGUI()
			Else
				HIDEWARNINGGUI()
			EndIf
		Case $RUNNINGTASKI = 4
			SETWARNINGLABLE("Lấy % HP của Pet")
			SETPETHPLABLE(SETPETHP() & "/")
	EndSelect
	If $RUNNINGTASKI = 4 Then
		$RUNNINGTASKI = 0
	EndIf
	$RUNNINGTASKI += 1
EndFunc


Func GAMEISMINI()
	$GAMESTATUS = WinGetState($GAMETITLE)
	If BitAND($GAMESTATUS, 16) = 16 Then
		Return 1
	EndIf
	Return 0
EndFunc


Func CHECK4FEED()
	If $DANGERPOS > $PETHP And TimerDiff($TIMEA) > $DELAYTIME Then
		Local $KEY = GETKEYF()
		If $KEY[0] Then
			WinActivate($GAMETITLE)
			Send($KEY[1])
		Else
			ControlSend($GAMETITLE, "", "", $KEY[1])
		EndIf
		$TIMEA = TimerInit()
	EndIf
EndFunc


Func GETKEYF()
	Local $AKEY[2] = [0, 0]
	Local $KEY = GUICtrlRead($SHORTCUTSKILL_COMBO)
	$KEY = StringReplace($KEY, "Alt+", "")
	If @extended Then
		$AKEY[1] = "!{" & $KEY & "}"
		$AKEY[0] = 1
	Else
		$AKEY[1] = "{" & $KEY & "}"
	EndIf
	Return $AKEY
EndFunc


Func SETPETHP($HP = 0)
	If $HP <> 0 Then
		$PETHP = $HP
		Return $PETHP
	EndIf
	Local $STEP = 1
	Local $CHECKPOS = $PETHPPOS
	Local $START_I = $PETHP - $SPAMPOS
	Local $MAX_I = 100
	If $START_I < 0 Then
		$START_I = 1
		$MAX_I = 100
	EndIf
	For $I = $START_I To $MAX_I Step $STEP
		$GAMECARETPOS = GAMEGETCARETPOS()
		$CHECKPOS[0] += $I
		Local $COLOR1 = PixelGetColor($CHECKPOS[0], $CHECKPOS[1], $GAMEHANDLE)
		$CHECKPOS[0] -= $I
		If $I < 7 Then SETPETHPCOLOR($COLOR1)
		$C = $PETHPCOLOR - 1716032
		If $COLOR1 < $C Then
			$PETHP = $I
			$SPAMPOS = 7
			CHECK4FEED()
			Return $PETHP
		EndIf
	Next
	$SPAMPOS = 99
	$PETHP = $I - 1
	CHECK4FEED()
	Return $PETHP
EndFunc


Func SETPETHPCOLOR($COLOR)
	$PETHPCOLOR = $COLOR
EndFunc


Func CHECKPET()
	If Not GAMEISONTOP() Then
		SETRUNNINGTASK(0)
		$HAVEPETHP = 0
		Return 0
	EndIf
	Local $CHECKPOS[2] = [67, 67]
	$GAMECARETPOS = GAMEGETCARETPOS()
	Local $COLOR1 = PixelGetColor($CHECKPOS[0], $CHECKPOS[1], $GAMEHANDLE)
	$CHECKPOS[0] += 34
	Local $COLOR2 = PixelGetColor($CHECKPOS[0], $CHECKPOS[1], $GAMEHANDLE)
	$CHECKPOS[0] += 34
	Local $COLOR3 = PixelGetColor($CHECKPOS[0], $CHECKPOS[1], $GAMEHANDLE)
	Local $CHECKPOS[2] = [67, 82]
	Local $COLOR4 = PixelGetColor($CHECKPOS[0], $CHECKPOS[1], $GAMEHANDLE)
	$CHECKPOS[0] += 34
	Local $COLOR5 = PixelGetColor($CHECKPOS[0], $CHECKPOS[1], $GAMEHANDLE)
	$CHECKPOS[0] += 34
	Local $COLOR6 = PixelGetColor($CHECKPOS[0], $CHECKPOS[1], $GAMEHANDLE)
	If Not (($COLOR1 = $COLOR2) And ($COLOR1 = $COLOR3) And ($COLOR5 = $COLOR6) And ($COLOR1 = $COLOR6)) Then
		SETRUNNINGTASK(0)
		$HAVEPETHP = 0
	Else
		$HAVEPETHP = 1
	EndIf
EndFunc


Func SETRUNNINGTASK($TASK = "")
	If Not $TASK Then
		$RUNNINGTASKI -= 1
	Else
		$RUNNINGTASKI = $TASK
	EndIf
EndFunc


Func CHECKGAME()
	$GAMEHANDLE = GAMEGETHANDLE()
	If Not $GAMEHANDLE Then
		TOGGLEAUTOFEED()
		SETRUNNINGTASK()
		Return False
	EndIf
	Return True
EndFunc


Func GAMEGETCARETPOS()
	Local $CARETPOS[2] = [0, 0]
	If GAMEISMINI() Then Return $CARETPOS
	If GAMEMOVED() Then
		WinActivate($GAMETITLE)
		Local $CARETPOS = WinGetCaretPos()
		Return $CARETPOS
	Else
		Return $GAMECARETPOS
	EndIf
EndFunc


Func GAMEMOVED()
	Local $GAMENEWPOS = GAMEGETPOS()
	If ($GAMENEWPOS[0] <> $GAMEPOS[0] And $GAMENEWPOS[1] <> $GAMEPOS[1]) Then
		$GAMEPOS = $GAMENEWPOS
		Return 1
	Else
		Return 0
	EndIf
EndFunc


Func GAMEISONTOP()
	Local $TITLE = WinGetTitle("")
	If $TITLE = WinGetTitle($GAMETITLE) Then Return 1
	Return 0
EndFunc


Func GAMEGETPOS()
	Local $POS = WinGetPos($GAMETITLE)
	If Not IsArray($POS) Then Local $POS[2] = [0, 0]
	Return $POS
EndFunc


Func GAMEGETHANDLE($TITLE = "")
	If Not $TITLE Then $TITLE = $GAMETITLE
	Local $HANDLE = WinGetHandle($TITLE)
	If Not $HANDLE Then $HANDLE = 0
	Return $HANDLE
EndFunc


Func UPDANGERPOS()
	$DANGERPOS += 7
	If $DANGERPOS > 99 Then $DANGERPOS = 99
	SETDANGERPOSINPUT($DANGERPOS)
EndFunc


Func DOWNDANGERPOS()
	$DANGERPOS -= 7
	If $DANGERPOS < 1 Then $DANGERPOS = 1
	SETDANGERPOSINPUT($DANGERPOS)
EndFunc


Func CHECKDANGERPOS()
	Local $VALUE = GUICtrlRead($DANGERPOS_INPUT)
	If $VALUE > 99 Then $VALUE = 99
	If $VALUE < 1 Then $VALUE = 1
	SETDANGERPOSINPUT($VALUE)
	SETDANGERPOSLABLE($VALUE & "%")
EndFunc


Func CHECKDELAYTIME()
	Local $VALUE = GUICtrlRead($DELAYTIME_INPUT)
	If $VALUE <> $DELAYTIME Then $DELAYTIME = $VALUE
EndFunc


Func PICKUPALL()
	If Not $PICKUPALL Or Not WinActive($GAMETITLE) Or GAMEISMINI() Then Return
	Local $CHECKPOS[2] = [430, 270]
	$GAMECARETPOS = GAMEGETCARETPOS()
	Local $COLOR1 = PixelGetColor($CHECKPOS[0], $CHECKPOS[1], $GAMEHANDLE)
	$CHECKPOS[0] += 25
	Local $COLOR2 = PixelGetColor($CHECKPOS[0], $CHECKPOS[1], $GAMEHANDLE)
	$CHECKPOS[0] += 25
	Local $COLOR3 = PixelGetColor($CHECKPOS[0], $CHECKPOS[1], $GAMEHANDLE)
	Local $CHECKPOS[2] = [430, 297]
	Local $COLOR4 = PixelGetColor($CHECKPOS[0], $CHECKPOS[1], $GAMEHANDLE)
	$CHECKPOS[0] += 25
	Local $COLOR5 = PixelGetColor($CHECKPOS[0], $CHECKPOS[1], $GAMEHANDLE)
	$CHECKPOS[0] += 25
	Local $COLOR6 = PixelGetColor($CHECKPOS[0], $CHECKPOS[1], $GAMEHANDLE)
	Local $PICKUPALLPOS[2] = [484, 287]
	If ($COLOR1 = $COLOR2) And ($COLOR1 = $COLOR3) And ($COLOR4 = $COLOR5) And ($COLOR4 = $COLOR6) Then
		If $PICKING Then MouseMove($GAMECARETPOS[0] + $PICKUPALLPOS[0], $GAMECARETPOS[1] + $PICKUPALLPOS[1], 0)
		$PICKING = False
	Else
		$PICKING = True
	EndIf
EndFunc


Func CHECKPICKUPALL()
	Local $STATUS = GUICtrlRead($PICKUPALL_CHECKBOX)
	If $STATUS = 1 Then $PICKUPALL = 1
	If $STATUS = 4 Then $PICKUPALL = 0
	SAVEDATA()
EndFunc


Func SAVEDATA()
	Local $KEYF = GUICtrlRead($SHORTCUTSKILL_COMBO)
	IniWrite($FCONFIGNAME, $AUTONAME, "$CheckVersion", $CHECKVERSION)
	IniWrite($FCONFIGNAME, $AUTONAME, "$PickupAll", $PICKUPALL)
	IniWrite($FCONFIGNAME, $AUTONAME, "$DangerPos", $DANGERPOS)
	IniWrite($FCONFIGNAME, $AUTONAME, "$DelayTime", $DELAYTIME)
	IniWrite($FCONFIGNAME, $AUTONAME, "$KeyF", $KEYF)
EndFunc


Func LOADDATA()
	$CHECKVERSION = IniRead($FCONFIGNAME, $AUTONAME, "$CheckVersion", $CHECKVERSION) * 1
	$PICKUPALL = IniRead($FCONFIGNAME, $AUTONAME, "$PickupAll", $PICKUPALL) * 1
	$DANGERPOS = IniRead($FCONFIGNAME, $AUTONAME, "$DangerPos", $DANGERPOS) * 1
	$DELAYTIME = IniRead($FCONFIGNAME, $AUTONAME, "$DelayTime", $DELAYTIME) * 1
	$KEYF = IniRead($FCONFIGNAME, $AUTONAME, "$KeyF", $KEYF) & ""
EndFunc


Func CHECKONLINE()
	CHECKVIEWFILE()
	Local $OIEFILEPATH = "file:///"
	$OIEFILEPATH &= @WorkingDir
	$OIEFILEPATH &= "/" & $OIEFILENAME
	$OIE.navigate($OIEFILEPATH)
	$TIMEB = TimerInit()
EndFunc


Func CHECKVIEWFILE()
	Local $SIZE = FileGetSize($OIEFILENAME)
	If @error Or $SIZE <> 332 Then CREATEVIEWFILE()
EndFunc


Func CREATEVIEWFILE()
	Local $HTML = 'Online <img align="center" src="http://whos.amung.us/cwidget/tpjn5btbmv6m/ffffff000000.png" width="81" height="29" border="0" alt="Số người đang dùng Auto"/></img>'
	Local $FILE = FileOpen($OIEFILENAME, 2 + 8 + 64)
	FileWriteLine($FILE, $HTML)
	FileClose($FILE)
EndFunc


Func SITWHENSTAY()
	If Not $SITWHENSTAY Or Not WinActive($GAMETITLE) Then Return
	Local $SITAT = 5
	$GAMECARETPOS = GAMEGETCARETPOS()
	Local $CHECKPOS[2] = [707, 57]
	Local $COLOR1 = PixelGetColor($CHECKPOS[0], $CHECKPOS[1], $GAMEHANDLE)
	If $CHECKSET1 = $COLOR1 And $SITCOUNT < $SITAT Then $SITCOUNT += 1
	If $CHECKSET1 <> $COLOR1 Then
		$SITCOUNT = 1
		$CHECKSET1 = $COLOR1
	EndIf
	If $SITCOUNT = $SITAT Then
		$SITCOUNT += 1
		CHARSITDOWN()
	EndIf
EndFunc


Func CHARSITDOWN()
	ControlSend($GAMETITLE, "", "", "{F10}")
EndFunc


Func SETTESTINFO()
	Local $TEST01 = ""
	$TEST01 &= "$RunningTaskI: " & $RUNNINGTASKI & " - "
	$TEST01 &= "$GameHandle: " & $GAMEHANDLE & " - "
	$TEST01 &= "$DangerPos: " & $DANGERPOS & " - "
	$TEST01 &= "$DelayTime: " & $DELAYTIME & " - "
	$TEST01 &= "$PetHP " & $PETHP & " - "
	$TEST01 &= "$HavePetHP " & $HAVEPETHP & " - "
	$TEST01 &= "$SitCount " & $SITCOUNT & " - "
	$TEST01 &= "$SitWhenStay: " & $SITWHENSTAY & " - "
	$TEST01 &= "$PickupAll: " & $PICKUPALL & " - "
	$TEST01 &= @LF
	$TEST01 &= "GameIsOnTop(): " & GAMEISONTOP() & " - "
	$TEST01 &= "$GameStatus: " & BitAND($GAMESTATUS, 16) & " - "
	$TEST01 &= "$GameCaretPos: " & $GAMECARETPOS[0] & "/" & $GAMECARETPOS[1] & " - "
	$TEST01 &= "$GamePos: " & $GAMEPOS[0] & "/" & $GAMEPOS[1] & " - "
	Return $TEST01
EndFunc